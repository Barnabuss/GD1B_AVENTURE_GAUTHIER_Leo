<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Hi Land !</title>
    <script src="//cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.js">
    </script>
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>

<body>
    <script type="text/javascript">

        var keyA;
        var keyZ;
        var keyE
        var player;
        var petit;
        var PV = 3;
        var PVennemy = 2;
        var arret = false;
        var depopattack = false;
        var turn = false;
        var diagDR = false;
        var diagDL = false;
        var diagUR = false;
        var diagUL = false;
        var sortieP = false
        var sortieJ = false
        var sortieM = false
        var sortieT = false
        var feeling = false
        var text
        var timedEvent
        var chronometre
        var incident = false
        var obtentionmasque = 0
        var score= 0
        var scoreText
        var container;
        var textObject;
        var coffreouvert = false
        var graphics
        var obtentionyoyo = false
        var talkyoyo = false
        var talkyoyo2 = false
        var talkyoyo3 = false
        var talkyoyo4 = false
        var talkyoyo5 = false
        var boiteachat = false
        var piece
        var refusachat
        var eboule2
        var eboule1
        var eboule3
        var obtentionmini = false
        var coffreminiouvert = false
        var obtentionmini = false
        var coffremarteauouvert = false
        var obtentionmarteau = false
        var obtentionclef = 0
        var coffreclefouvert = false
        var entreefuite = false
        var sortiefuite = false
        

        class niveau2 extends Phaser.Scene {


            constructor() {
            
                super("niveau2")
            }

            


            preload() {
                this.load.image('menu', 'assets/menu.png');

                this.load.spritesheet('bouton', 'assets/bouton.png',
                    { frameWidth: 250, frameHeight: 98 });

                this.boutonjouer = this.physics.add.sprite(100, 100, "bouton").setInteractive();

            }


            create() {


                this.add.image(549, 309,'menu');
                var bouton = this.add.sprite(150, 100, 'bouton').setInteractive();
                bouton.on('pointerdown', function (pointer) {
                
                    this.setTint(0xff0000);
                    this.scene.scene.start("niveauplage");
                
                });
            
                bouton.on('pointerout', function (pointer) {
                
                    this.clearTint();
                
                });
            
                bouton.on('pointerup', function (pointer) {
                
                    this.clearTint();
                
                });
            

            }

            update() {
            
            
            }



            }


            class gameover extends Phaser.Scene {


                constructor() {

                    super("gameover")
                }




                preload() {
                    this.load.image('gameover', 'assets/gameover.png');

                    //this.load.spritesheet('bouton', 'assets/bouton.png',
                        //{ frameWidth: 250, frameHeight: 98 });

                    //this.boutonjouer = this.physics.add.sprite(100, 100, "bouton").setInteractive();

                }


                create() {


                    this.add.image(549, 309,'gameover');

                }

                update() {
                }

            }








            class ecrandefin extends Phaser.Scene {


                constructor() {

                    super("ecrandefin")
                }




                preload() {
                    this.load.image('ecranfin', 'assets/ecranfin.png');

                    //this.load.spritesheet('bouton', 'assets/bouton.png',
                        //{ frameWidth: 250, frameHeight: 98 });

                    //this.boutonjouer = this.physics.add.sprite(100, 100, "bouton").setInteractive();

                }


                create() {


                    this.add.image(549, 309,'ecranfin');

                }

                update() {
                }

            }














        class niveau1 extends Phaser.Scene {

            constructor() {
                super("niveau1");
            }

            init(data) { 
                this.sortieJ = sortieJ;
                this. PV = data.PV;
                this.obtentionyoyo = data.obtentionyoyo
                this.obtentionmasque = data.obtentionmasque
            }


            preload() {
                // chargement tuiles de jeu
                this.load.image("Phaser_Tileset", "assets/placeholdernew.png");

                // chargement de la carte
                this.load.tilemapTiledJSON("carte", "assets/protojungle.json");
                this.load.spritesheet('perso', 'assets/protopetit.png',
                    { frameWidth: 32, frameHeight: 48 });
                this.load.spritesheet("dossier", "assets/dossier.png", {
                    frameWidth: 32,
                    frameHeight: 32,
                });
                this.load.image("interfacefenetre", "assets/fenetre clean.png");

                this.load.image("interfacenormal", "assets/interface full.png");

                this.load.image("interfacedegats", "assets/interface degats.png");

                this.load.spritesheet("virus", "assets/mobile.png", {
                    frameWidth: 32,
                    frameHeight: 32,
                });

                this.load.spritesheet("sortiejungle", "assets/sortiejungle.png", {
                    frameWidth: 32,
                    frameHeight: 32,
                });

                this.load.spritesheet("zoneattack", "assets/zoneattack.png", {
                    frameWidth: 96,
                    frameHeight: 48,
                });

                this.load.spritesheet("zoneattackL", "assets/zoneattackL.png", {
                    frameWidth: 96,
                    frameHeight: 48,
                });

                this.load.spritesheet("zoneattackD", "assets/zoneattackD.png", {
                    frameWidth: 48,
                    frameHeight: 96,
                });

                this.load.spritesheet("zoneattackU", "assets/zoneattackU.png", {
                    frameWidth: 48,
                    frameHeight: 96,
                });

                this.load.spritesheet("marteau", "assets/marteau.png", {
                    frameWidth: 38,
                    frameHeight: 38,
                });

                this.load.spritesheet("pylone", "assets/pylone.png", {
                    frameWidth: 38,
                    frameHeight: 38,
                });

                this.load.spritesheet("boite", "assets/boite.png", {
                    frameWidth: 39,
                    frameHeight: 46,
                });

                this.load.spritesheet("boiteP", "assets/boiteP.png", {
                    frameWidth: 27,
                    frameHeight: 46,
                });

                this.load.spritesheet("marteauV", "assets/marteauV.png", {
                    frameWidth: 38,
                    frameHeight: 38,
                });

                this.load.spritesheet("marteauD", "assets/marteauD.png", {
                    frameWidth: 25,
                    frameHeight: 34,
                });

                this.load.spritesheet("marteauU", "assets/marteauU.png", {
                    frameWidth: 25,
                    frameHeight: 35,
                });

                this.load.spritesheet("marteauL", "assets/marteauL.png", {
                    frameWidth: 40,
                    frameHeight: 25,
                });

                this.load.spritesheet("marteauR", "assets/marteauR.png", {
                    frameWidth: 40,
                    frameHeight: 25,
                });



                this.load.spritesheet("attackgolem", "assets/attackgolem.png", {
                    frameWidth: 32,
                    frameHeight: 32,
                });

                this.load.image('FondUI', 'assets/fondUI.png');
                this.load.image('fullcoeur', 'assets/fullcoeur.png');
                this.load.image('deuxcoeurs', 'assets/deuxcoeurs.png');
                this.load.image('uncoeur', 'assets/uncoeur.png');



                this.load.bitmapFont(
                    'myfont',
                    'assets/typo.png',
                    'assets/typo.xml'
                );


                this.load.image('container', 'assets/boitedialogue.png');
                this.load.image('containermini', 'assets/containermini.png');

                this.load.spritesheet('coffre1', 'assets/coffreface.png',
                    { frameWidth: 64, frameHeight: 64 });

                this.load.spritesheet('golem', 'assets/spritegolem.png',
                { frameWidth: 54, frameHeight: 137 });

                this.load.spritesheet('piece', 'assets/piece.png',
                    { frameWidth: 32, frameHeight: 32 });

            }


            create() {
                
                
                // chargement de la carte du niveau
                const carteDuNiveau = this.add.tilemap("carte");
                // chargement du jeu de tuiles
                const tileset = carteDuNiveau.addTilesetImage(
                    "placeholdernew",
                    "Phaser_Tileset"
                );



                // chargement du calque "calque_backgroung"
                const backgroundLayer = carteDuNiveau.createLayer(
                    "sol",
                    tileset
                );

                // chargement du calque "calque_backgroung"
                const backgroundLayer2 = carteDuNiveau.createLayer(
                    "soleau",
                    tileset
                );

                // chargement du second calque "calque_backgroung"
                const blocsjungle = carteDuNiveau.createLayer(
                    "blocs",
                    tileset
                );

                // chargement du second calque "calque_backgroung"
                const eau = carteDuNiveau.createLayer(
                    "eau",
                    tileset
                );

                // chargement du second calque "calque_backgroung"
                const arbres = carteDuNiveau.createLayer(
                    "arbres",
                    tileset
                );

                // chargement du second calque "calque_backgroung"
                const pylones = carteDuNiveau.createLayer(
                    "pylones",
                    tileset
                );


                petit = false
                sortieJ =true


                if(sortiefuite == true){
                    this.player = this.physics.add.sprite(2250,400,  'perso');
                }
                else if (sortiefuite == false){
                    this.player = this.physics.add.sprite(720, 100, 'perso');
                }
                
                //taille de la hitbox
                this.player.setSize(32, 32);
                //decaler la hitbox
                this.player.setOffset(0, 15);
                this.anims.create({
                    key: 'left',
                    frames: this.anims.generateFrameNumbers('perso', { start: 0, end: 1 }),
                    frameRate: 10,
                    repeat: -1
                });
                this.anims.create({
                    key: 'turn',
                    frames: [{ key: 'perso', frame: 2 }],
                    frameRate: 20
                });
                this.anims.create({
                    key: 'right',
                    frames: this.anims.generateFrameNumbers('perso', { start: 3, end: 4 }),
                    frameRate: 10,
                    repeat: -1
                });

                this.anims.create({
                    key: 'up',
                    frames: this.anims.generateFrameNumbers('perso', { start: 8, end: 9 }),
                    frameRate: 10,
                    repeat: 1
                });

                this.anims.create({
                    key: 'down',
                    frames: this.anims.generateFrameNumbers('perso', { start: 5, end: 6 }),
                    frameRate: 10,
                    repeat: -1
                });

                this.anims.create({
                    key: 'virusactif',
                    frames: this.anims.generateFrameNumbers('virus', { start: 0, end: 1 }),
                    frameRate: 10,
                    repeat: -1
                });



                this.cursors = this.input.keyboard.createCursorKeys();
                this.scoreText = this.add.text(16, 16, 'score: 0', { fontSize: '32px', fill: '#000' });
                
                
                // ancrage de la caméra sur le joueur
                this.physics.world.setBounds(0, 0, 3000, 3000);
                //  ajout du champs de la caméra de taille identique à celle du monde
                this.cameras.main.setBounds(0, 0, 2300, 3350);
                this.cameras.main.startFollow(this.player);
                blocsjungle.setCollisionByProperty({ solide: true });
                eau.setCollisionByProperty({ solide: true });
                this.physics.add.collider(this.player, blocsjungle);
                this.physics.add.collider(this.player, eau);
                keyA = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.A);
                keyZ = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.Z);
                keyE = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.E);
                
                
                if(obtentionmasque == 1){
                    
                    this.earthquack = this.time.addEvent({
                        delay: 1000,
                        callback: ()=>{
                            this.cameras.main.shake(1000,0.01)
                        },
                        loop: true
                    })
                    this.chronometre = this.time.delayedCall(500000, [],null, this);

                }
                
                
                
                
                
                //placement des ennemis



                this.anims.create({
                    key: 'animgolem',
                    frames: this.anims.generateFrameNumbers('golem', { start: 0, end: 10 }),
                    frameRate: 10,
                    repeat: -1
                });
                this.anims.create({
                    key: 'eteintgolem',
                    frames: this.anims.generateFrameNumbers('golem', { start: 0, end: 0 }),
                    frameRate: 10,
                    repeat: -1
                });



                
                


                //placement des ennemis

                var startPoint = new Phaser.Math.Vector2(800, 630);
                var controlPoint1 = new Phaser.Math.Vector2(1000, 630);
                var controlPoint2 = new Phaser.Math.Vector2(1250, 630);
                var endPoint = new Phaser.Math.Vector2(1500, 630);

                var curve = new Phaser.Curves.CubicBezier(startPoint, controlPoint1, controlPoint2, endPoint);

                var graphics = this.add.graphics();



                this.followvirus1= this.add.follower(curve, 800, 630, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus1);
                this.followvirus1.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus1.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus1.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus1,this.degats,null,this);

                this.followvirus1.startFollow({
                    duration: 5000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });

                this.followvirus2= this.add.follower(curve, 1100, 2600, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus2);
                this.followvirus2.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus2.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus2.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus2,this.degats,null,this);

                this.followvirus2.startFollow({
                    duration: 5000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });


                var startPoint2 = new Phaser.Math.Vector2(1000, 630);
                var controlPoint12 = new Phaser.Math.Vector2(1000, 850);
                var controlPoint22 = new Phaser.Math.Vector2(1000, 990);
                var endPoint2 = new Phaser.Math.Vector2(1000, 1100);

                var curve2 = new Phaser.Curves.CubicBezier(startPoint2, controlPoint12, controlPoint22, endPoint2);

                var graphics = this.add.graphics();

                this.followvirus3= this.add.follower(curve2, 1200, 2600, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus3);
                this.followvirus3.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus3.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus3.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus3,this.degats,null,this);

                this.followvirus3.startFollow({
                    duration: 5000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });

                this.followvirus4= this.add.follower(curve2, 1300, 2100, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus4);
                this.followvirus4.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus4.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus4.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus4,this.degats,null,this);

                this.followvirus4.startFollow({
                    duration: 5000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });

                this.followvirus6= this.add.follower(curve2, 350, 1900, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus6);
                this.followvirus6.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus6.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus6.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus6,this.degats,null,this);

                this.followvirus6.startFollow({
                    duration: 5000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });

                this.followvirus5= this.add.follower(curve2, 650, 1000, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus5);
                this.followvirus5.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus5.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus5.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus5,this.degats,null,this);

                this.followvirus5.startFollow({
                    duration: 5000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });

                this.followvirus7= this.add.follower(curve2, 1000, 1000, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus7);
                this.followvirus7.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus7.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus7.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus7,this.degats,null,this);

                this.followvirus7.startFollow({
                    duration: 5000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });

                var startPoint3 = new Phaser.Math.Vector2(1000, 630);
                var controlPoint13 = new Phaser.Math.Vector2(1000, 700);
                var controlPoint23 = new Phaser.Math.Vector2(1000, 770);
                var endPoint3 = new Phaser.Math.Vector2(1000, 870);

                var curve3 = new Phaser.Curves.CubicBezier(startPoint3, controlPoint13, controlPoint23, endPoint3);

                var graphics = this.add.graphics();

                this.followvirus8= this.add.follower(curve3, 1175, 450, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus8);
                this.followvirus8.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus8.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus8.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus8,this.degats,null,this);

                this.followvirus8.startFollow({
                    duration: 5000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });

                this.followvirus9= this.add.follower(curve3, 1500, 450, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus9);
                this.followvirus9.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus9.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus9.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus9,this.degats,null,this);

                this.followvirus9.startFollow({
                    duration: 5000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });

                this.followvirus10= this.add.follower(curve3, 1700, 750, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus10);
                this.followvirus10.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus10.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus10.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus10,this.degats,null,this);

                this.followvirus10.startFollow({
                    duration: 5000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });

                this.followvirus11= this.add.follower(curve3, 805, 2300, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus11);
                this.followvirus11.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus11.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus11.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus11,this.degats,null,this);

                this.followvirus11.startFollow({
                    duration: 5000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });









                //placement des zones d'attaque en hors champs
                this.zoneattack = this.physics.add.sprite(100, 100, "zoneattack").setInteractive();

                this.physics.add.collider(this.zoneattack, this.followvirus1, this.attackplayer1, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus2, this.attackplayer2, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus3, this.attackplayer3, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus4, this.attackplayer4, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus5, this.attackplayer5, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus6, this.attackplayer6, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus7, this.attackplayer7, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus8, this.attackplayer8, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus9, this.attackplayer9, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus10, this.attackplayer10, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus11, this.attackplayer11, null, this);



                this.zoneattackL = this.physics.add.sprite(100, 100, "zoneattackL").setInteractive();
                

                this.physics.add.collider(this.zoneattackL, this.followvirus1, this.attackLplayer1, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus2, this.attackLplayer2, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus3, this.attackLplayer3, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus4, this.attackLplayer4, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus5, this.attackLplayer5, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus6, this.attackLplayer6, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus8, this.attackLplayer7, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus9, this.attackLplayer9, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus10, this.attackLplayer10, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus11, this.attackLplayer11, null, this);

                this.zoneattackD = this.physics.add.sprite(100, 100, "zoneattackD").setInteractive();

                this.physics.add.collider(this.zoneattackD, this.followvirus1, this.attackDplayer1, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus2, this.attackDplayer2, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus3, this.attackDplayer3, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus3, this.attackDplayer3, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus4, this.attackDplayer4, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus5, this.attackDplayer5, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus6, this.attackDplayer6, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus7, this.attackDplayer7, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus8, this.attackDplayer8, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus9, this.attackDplayer9, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus10, this.attackDplayer10, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus11, this.attackDplayer11, null, this);

                this.zoneattackU = this.physics.add.sprite(100, 100, "zoneattackU").setInteractive();

                this.physics.add.collider(this.zoneattackU, this.followvirus1, this.attackUplayer1, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus2, this.attackUplayer2, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus3, this.attackUplayer3, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus4, this.attackUplayer4, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus5, this.attackUplayer5, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus6, this.attackUplayer6, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus7, this.attackUplayer7, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus8, this.attackUplayer8, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus9, this.attackUplayer9, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus10, this.attackUplayer10, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus11, this.attackUplayer11, null, this);

                //hitbox du marteau
                this.marteauR = this.physics.add.sprite(100, 100, "marteauR").setInteractive();

                this.physics.add.collider(this.marteauR, this.boite, this.smash, null, this);

                this.marteauU = this.physics.add.sprite(100, 100, "marteauU").setInteractive();

                this.physics.add.collider(this.marteauU, this.boite, this.smashV, null, this);

                this.marteauL = this.physics.add.sprite(100, 100, "marteauL").setInteractive();

                this.physics.add.collider(this.marteauL, this.boite, this.smashV, null, this);

                this.marteauD = this.physics.add.sprite(100, 100, "marteauD").setInteractive();

                this.physics.add.collider(this.marteauD, this.boite, this.smashV, null, this);
                
                //placement des boites
                this.boite = this.physics.add.sprite(900, 400, "boite").setInteractive();
                this.boite.setImmovable();
                this.physics.add.collider(this.boite, this.player);
                this.physics.add.collider(this.boite, this.marteauR, this.smash, null, this);
                this.physics.add.collider(this.boite, this.marteauU, this.smash, null, this);
                this.physics.add.collider(this.boite, this.marteauL, this.smash, null, this);
                this.physics.add.collider(this.boite, this.marteauD, this.smash, null, this);

                //placement des pylones
                this.pylone = this.physics.add.sprite(750, 750, "pylone").setInteractive();
                this.physics.add.collider(this.pylone, this.zoneattack, this.grappin, null, this);
                this.physics.add.collider(this.pylone, this.zoneattackL, this.grappinL, null, this);
                this.physics.add.collider(this.pylone, this.zoneattackU, this.grappinU, null, this);
                this.physics.add.collider(this.pylone, this.zoneattackD, this.grappinD, null, this);

                this.pylone2 = this.physics.add.sprite(750, 875, "pylone").setInteractive();
                this.physics.add.collider(this.pylone2, this.zoneattack, this.grappin2, null, this);
                this.physics.add.collider(this.pylone2, this.zoneattackL, this.grappinL2, null, this);
                this.physics.add.collider(this.pylone2, this.zoneattackU, this.grappinU2, null, this);
                this.physics.add.collider(this.pylone2, this.zoneattackD, this.grappinD2, null, this);

                this.pylone3 = this.physics.add.sprite(450, 1380, "pylone").setInteractive();
                this.physics.add.collider(this.pylone3, this.zoneattack, this.grappin3, null, this);
                this.physics.add.collider(this.pylone3, this.zoneattackL, this.grappinL3, null, this);
                this.physics.add.collider(this.pylone3, this.zoneattackU, this.grappinU3, null, this);
                this.physics.add.collider(this.pylone3, this.zoneattackD, this.grappinD3, null, this);

                this.pylone4 = this.physics.add.sprite(350, 1550, "pylone").setInteractive();
                this.physics.add.collider(this.pylone4, this.zoneattack, this.grappin4, null, this);
                this.physics.add.collider(this.pylone4, this.zoneattackL, this.grappinL4, null, this);
                this.physics.add.collider(this.pylone4, this.zoneattackU, this.grappinU4, null, this);
                this.physics.add.collider(this.pylone4, this.zoneattackD, this.grappinD4, null, this);


                this.pylone5 = this.physics.add.sprite(1200, 2000, "pylone").setInteractive();
                this.physics.add.collider(this.pylone5, this.zoneattack, this.grappin5, null, this);
                this.physics.add.collider(this.pylone5, this.zoneattackL, this.grappinL5, null, this);
                this.physics.add.collider(this.pylone5, this.zoneattackU, this.grappinU5, null, this);
                this.physics.add.collider(this.pylone5, this.zoneattackD, this.grappinD5, null, this);

                this.pylone6 = this.physics.add.sprite(1000, 2100, "pylone").setInteractive();
                this.physics.add.collider(this.pylone6, this.zoneattack, this.grappin6, null, this);
                this.physics.add.collider(this.pylone6, this.zoneattackL, this.grappinL6, null, this);
                this.physics.add.collider(this.pylone6, this.zoneattackU, this.grappinU6, null, this);
                this.physics.add.collider(this.pylone6, this.zoneattackD, this.grappinD6, null, this);

                this.pylone7 = this.physics.add.sprite(450, 2800, "pylone").setInteractive();
                this.physics.add.collider(this.pylone7, this.zoneattack, this.grappin7, null, this);
                this.physics.add.collider(this.pylone7, this.zoneattackL, this.grappinL7, null, this);
                this.physics.add.collider(this.pylone7, this.zoneattackU, this.grappinU7, null, this);
                this.physics.add.collider(this.pylone7, this.zoneattackD, this.grappinD7, null, this);

                this.pylone8 = this.physics.add.sprite(300, 3100, "pylone").setInteractive();
                this.physics.add.collider(this.pylone8, this.zoneattack, this.grappin8, null, this);
                this.physics.add.collider(this.pylone8, this.zoneattackL, this.grappinL8, null, this);
                this.physics.add.collider(this.pylone8, this.zoneattackU, this.grappinU8, null, this);
                this.physics.add.collider(this.pylone8, this.zoneattackD, this.grappinD8, null, this);

                this.pylone9 = this.physics.add.sprite(170, 3250, "pylone").setInteractive();
                this.physics.add.collider(this.pylone9, this.zoneattack, this.grappin9, null, this);
                this.physics.add.collider(this.pylone9, this.zoneattackL, this.grappinL9, null, this);
                this.physics.add.collider(this.pylone9, this.zoneattackU, this.grappinU9, null, this);
                this.physics.add.collider(this.pylone9, this.zoneattackD, this.grappinD9, null, this);

                this.pylone10 = this.physics.add.sprite(1320, 975, "pylone").setInteractive();
                this.physics.add.collider(this.pylone10, this.zoneattack, this.grappin10, null, this);
                this.physics.add.collider(this.pylone10, this.zoneattackL, this.grappinL10, null, this);
                this.physics.add.collider(this.pylone10, this.zoneattackU, this.grappinU10, null, this);
                this.physics.add.collider(this.pylone10, this.zoneattackD, this.grappinD10, null, this)

                this.pylone11 = this.physics.add.sprite(1700, 1300, "pylone").setInteractive();
                this.physics.add.collider(this.pylone11, this.zoneattack, this.grappin11, null, this);
                this.physics.add.collider(this.pylone11, this.zoneattackL, this.grappin11, null, this);
                this.physics.add.collider(this.pylone11, this.zoneattackU, this.grappinU11, null, this);
                this.physics.add.collider(this.pylone11, this.zoneattackD, this.grappinD11, null, this)

                this.pylone12 = this.physics.add.sprite(2000, 3050, "pylone").setInteractive();
                this.physics.add.collider(this.pylone12, this.zoneattack, this.grappin12, null, this);
                this.physics.add.collider(this.pylone12, this.zoneattackL, this.grappin12, null, this);
                this.physics.add.collider(this.pylone12, this.zoneattackU, this.grappinU12, null, this);
                this.physics.add.collider(this.pylone12, this.zoneattackD, this.grappinD12, null, this)

                this.pylone13 = this.physics.add.sprite(2220, 3150, "pylone").setInteractive();
                this.physics.add.collider(this.pylone13, this.zoneattack, this.grappin13, null, this);
                this.physics.add.collider(this.pylone13, this.zoneattackL, this.grappin13, null, this);
                this.physics.add.collider(this.pylone13, this.zoneattackU, this.grappinU13, null, this);
                this.physics.add.collider(this.pylone13, this.zoneattackD, this.grappinD13, null, this)

                this.pylone14 = this.physics.add.sprite(2090, 3215, "pylone").setInteractive();
                this.physics.add.collider(this.pylone14, this.zoneattack, this.grappin14, null, this);
                this.physics.add.collider(this.pylone14, this.zoneattackL, this.grappin14, null, this);
                this.physics.add.collider(this.pylone14, this.zoneattackU, this.grappinU14, null, this);
                this.physics.add.collider(this.pylone14, this.zoneattackD, this.grappinD14, null, this)

                this.pylone15 = this.physics.add.sprite(1905, 3200, "pylone").setInteractive();
                this.physics.add.collider(this.pylone15, this.zoneattack, this.grappin15, null, this);
                this.physics.add.collider(this.pylone15, this.zoneattackL, this.grappin15, null, this);
                this.physics.add.collider(this.pylone15, this.zoneattackU, this.grappinU15, null, this);
                this.physics.add.collider(this.pylone15, this.zoneattackD, this.grappinD15, null, this)

                this.pylone16 = this.physics.add.sprite(2200, 2950, "pylone").setInteractive();
                this.physics.add.collider(this.pylone16, this.zoneattack, this.grappin16, null, this);
                this.physics.add.collider(this.pylone16, this.zoneattackL, this.grappin16, null, this);
                this.physics.add.collider(this.pylone16, this.zoneattackU, this.grappinU16, null, this);
                this.physics.add.collider(this.pylone16, this.zoneattackD, this.grappinD16, null, this)


                this.pylone17 = this.physics.add.sprite(1480,1960, "pylone").setInteractive();
                this.physics.add.collider(this.pylone17, this.zoneattack, this.grappin17, null, this);
                this.physics.add.collider(this.pylone17, this.zoneattackL, this.grappinL17, null, this);
                this.physics.add.collider(this.pylone17, this.zoneattackU, this.grappinU17, null, this);
                this.physics.add.collider(this.pylone17, this.zoneattackD, this.grappinD17, null, this);

                this.pylone18 = this.physics.add.sprite(1790,1960, "pylone").setInteractive();
                this.physics.add.collider(this.pylone18, this.zoneattack, this.grappin18, null, this);
                this.physics.add.collider(this.pylone18, this.zoneattackL, this.grappinL18, null, this);
                this.physics.add.collider(this.pylone18, this.zoneattackU, this.grappinU18, null, this);
                this.physics.add.collider(this.pylone18, this.zoneattackD, this.grappinD18, null, this);


                


                this.sortiejungle = this.physics.add.sprite(715, 50, "sortiejungle").setInteractive();
                this.sortiejungle.setImmovable();
                this.sortiejungle.setSize(100,32);
                this.physics.add.collider(this.sortiejungle, this.player, this.tpsortiejungle, null, this);

                this.sortiefuitejungle = this.physics.add.sprite(2300, 400, "sortiejungle").setInteractive();
                this.sortiefuitejungle.setImmovable();
                this.sortiefuitejungle.setSize(32,900);
                this.physics.add.collider(this.sortiefuitejungle, this.player, this.tpmontagnefuite, null, this);


                //je fais apparaitre tout les calques d'interfca, ils sont invisibles sous certaines conditions, en fonction des PV

                this.add.image(550,290, 'FondUI').setScrollFactor(0);

                
                this.fullcoeur = this.add.image(550,290, 'fullcoeur').setScrollFactor(0);
                this.fullcoeur.visible = false;
                this.deuxcoeurs = this.add.image(550,290, 'deuxcoeurs').setScrollFactor(0);
                this.deuxcoeurs.visible = false;
                this.uncoeur = this.add.image(550,290, 'uncoeur').setScrollFactor(0);
                this.uncoeur.visible = false;
                this.scoreText=this.add.text(115,100,score,{fontSize:'64px',fill:'#FFFFFF',strokeThickness: 6, stroke:'#000000'}).setScrollFactor(0);
                this.scoreText.setText(score); //met à jour l’affichage du score

                //update de l'interface a chaque debut de scene
                if(PV == 3){
                    this.fullcoeur.visible = true;
                }
                else if (PV == 2){
                    this.deuxcoeurs.visible = true;
                }
                else if (PV == 1){
                    this.uncoeur.visible = true;
                }
                
                //placement des coffres
                this.coffre1 = this.physics.add.sprite(490, 175, 'coffre1');
                this.coffre1.setScale(0.75)
                this.physics.add.collider(this.player, this.coffre1,this.collectcoin);
                this.coffre1.setImmovable();
                this.anims.create({
                    key: 'coffreouvert',
                    frames: this.anims.generateFrameNumbers('coffre1', { start: 1, end: 1 }),
                    frameRate: 10,
                    repeat: -1
                });


                this.coffre1 = this.physics.add.sprite(1400, 1100, 'coffre1');
                this.coffre1.setScale(0.75)
                this.physics.add.collider(this.player, this.coffre1,this.collectcoin);
                this.coffre1.setImmovable();

                this.coffre1 = this.physics.add.sprite(300, 1410, 'coffre1');
                this.coffre1.setScale(0.75)
                this.physics.add.collider(this.player, this.coffre1,this.collectcoin);
                this.coffre1.setImmovable();

                this.coffre1 = this.physics.add.sprite(190, 1050, 'coffre1');
                this.coffre1.setScale(0.75)
                this.physics.add.collider(this.player, this.coffre1,this.collectcoin);
                this.coffre1.setImmovable();

                this.coffre1 = this.physics.add.sprite(700, 1900, 'coffre1');
                this.coffre1.setScale(0.75)
                this.physics.add.collider(this.player, this.coffre1,this.collectcoin);
                this.coffre1.setImmovable();

                this.coffre1 = this.physics.add.sprite(150, 3080, 'coffre1');
                this.coffre1.setScale(0.75)
                this.physics.add.collider(this.player, this.coffre1,this.collectcoin);
                this.coffre1.setImmovable();

                this.coffre1 = this.physics.add.sprite(1540, 3040, 'coffre1');
                this.coffre1.setScale(0.75)
                this.physics.add.collider(this.player, this.coffre1,this.collectcoin);
                this.coffre1.setImmovable();

                this.coffremini = this.physics.add.sprite(1999, 1600, 'coffre1');
                this.coffremini.setScale(0.75)
                this.physics.add.collider(this.player, this.coffremini,this.collectmini);
                this.coffremini.setImmovable();









                this.container = this.add.sprite(550, 475, 'container').setScrollFactor(0);
                this.container.alpha = 0.8;
                this.container.visible = false;

                var message = 'Tu as obtenu 20 pieces antiques !';
                this.textObject = this.add.bitmapText(380,470, 'myfont', message, 27).setScrollFactor(0);
                this.textObject.visible = false;


                this.containermini = this.add.sprite(550, 475, 'containermini').setScrollFactor(0);
                this.containermini.alpha = 0.8;
                this.containermini.visible = false;


                //piece a collecter
                this.piece = this.physics.add.sprite(5000,5000, "piece").setInteractive();
                this.physics.add.collider(this.player,this.piece, this.collectpiece, null, this)
                this.piece.setImmovable();


            }

            chrono() {
                console.log("Fin !")
                this.scene.start("gameover")

            }



            collectcoin(player,coffre1){ 

                    setTimeout(() => {
                        coffreouvert = false;
                    }, 1000);
                coffreouvert = true
                score += 20; //augmente le score de 20
                coffre1.anims.play('coffreouvert', true)
                coffre1.setOffset(5000,5000);


            }

            collectmini(player,coffremini){ 

                setTimeout(() => {
                    coffreminiouvert = false;
                }, 7000);
                coffreminiouvert = true
                obtentionmini = true
                coffremini.anims.play('coffreouvert', true)
                coffremini.setOffset(5000,5000);


            }

            
            collectpiece(player,piece){ 
                piece.x = 5000
                piece.y = 5000

                score += 2; //augmente le score de 20

            }



            degats(player, followvirus) {
                

                if (PV == 3){
                    setTimeout(() => {
                        this.player.setOffset(0, 15);
                    }, 1000);
                    this.player.setOffset(5000,5000);
                    player.alpha = 0.5
                    this.serolReset = this.time.addEvent({
                        delay: 1000,
                        callback: ()=>{
                            player.alpha = 1;
                        },
                        loop: false
                    })
                    PV -= 1//si le virus nous touche, on perd un PV
                    console.log("aie")
                    this.deuxcoeurs.visible = true;
                    this.fullcoeur.visible = false;
                    
                } else if (PV == 2){
                    setTimeout(() => {
                        this.player.setOffset(0, 15);
                    }, 1000);
                    this.player.setOffset(5000,5000);
                    player.alpha = 0.5
                    this.serolReset = this.time.addEvent({
                        delay: 1000,
                        callback: ()=>{
                            player.alpha = 1;
                        },
                        loop: false
                    })
                    PV -= 1//si le virus nous touche, on perd un PV
                    console.log("aie2")
                    this.uncoeur.visible = true;
                    this.deuxcoeurs.visible = false;
                    
                } else if (PV == 1){
                    this.scene.start("gameover")
                
                }
            }



            attackplayer1() {
                this.followvirus1.destroy()
                this.piece.x = this.followvirus1.x
                this.piece.y = this.followvirus1.y
                PVennemy -= 1;
                
                


            }

            attackLplayer1() {
                this.piece.x = this.followvirus1.x
                this.piece.y = this.followvirus1.y
                PVennemy -= 1;
                this.followvirus1.destroy()


            }

            attackDplayer1() {
                this.piece.x = this.followvirus1.x
                this.piece.y = this.followvirus1.y
                PVennemy -= 1;
                this.followvirus1.destroy()

            }

            attackUplayer1() {
                this.piece.x = this.followvirus1.x
                this.piece.y = this.followvirus1.y
                PVennemy -= 1;
                this.followvirus1.destroy()

            }



            attackplayer2() {
                this.followvirus2.destroy()
                this.piece.x = this.followvirus2.x
                this.piece.y = this.followvirus2.y
                PVennemy -= 1;
                
                


            }

            attackLplayer2() {
                this.piece.x = this.followvirus2.x
                this.piece.y = this.followvirus2.y
                PVennemy -= 1;
                this.followvirus1.destroy()


            }

            attackDplayer2() {
                this.piece.x = this.followvirus2.x
                this.piece.y = this.followvirus2.y
                PVennemy -= 1;
                this.followvirus2.destroy()

            }

            attackUplayer2() {
                this.piece.x = this.followvirus2.x
                this.piece.y = this.followvirus2.y
                PVennemy -= 1;
                this.followvirus2.destroy()

            }

            attackplayer3() {
                this.followvirus3.destroy()
                this.piece.x = this.followvirus3.x
                this.piece.y = this.followvirus3.y
                PVennemy -= 1;
                
                


            }

            attackLplayer3() {
                this.piece.x = this.followvirus3.x
                this.piece.y = this.followvirus3.y
                PVennemy -= 1;
                this.followvirus3.destroy()


            }

            attackDplayer3() {
                this.piece.x = this.followvirus3.x
                this.piece.y = this.followvirus3.y
                PVennemy -= 1;
                this.followvirus3.destroy()

            }

            attackUplayer3() {
                this.piece.x = this.followvirus3.x
                this.piece.y = this.followvirus3.y
                PVennemy -= 1;
                this.followvirus3.destroy()

            }

            attackplayer4() {
                this.followvirus4.destroy()
                this.piece.x = this.followvirus4.x
                this.piece.y = this.followvirus4.y
                PVennemy -= 1;
                
                


            }

            attackLplayer4() {
                this.piece.x = this.followvirus4.x
                this.piece.y = this.followvirus4.y
                PVennemy -= 1;
                this.followvirus4.destroy()


            }

            attackDplayer4() {
                this.piece.x = this.followvirus4.x
                this.piece.y = this.followvirus4.y
                PVennemy -= 1;
                this.followvirus1.destroy()

            }

            attackUplayer4() {
                this.piece.x = this.followvirus4.x
                this.piece.y = this.followvirus4.y
                PVennemy -= 1;
                this.followvirus4.destroy()

            }

            attackplayer5() {
                this.followvirus5.destroy()
                this.piece.x = this.followvirus5.x
                this.piece.y = this.followvirus5.y
                PVennemy -= 1;
                
                


            }

            attackLplayer5() {
                this.piece.x = this.followvirus5.x
                this.piece.y = this.followvirus5.y
                PVennemy -= 1;
                this.followvirus5.destroy()


            }

            attackDplayer5() {
                this.piece.x = this.followvirus5.x
                this.piece.y = this.followvirus5.y
                PVennemy -= 1;
                this.followvirus1.destroy()

            }

            attackUplayer5() {
                this.piece.x = this.followvirus5.x
                this.piece.y = this.followvirus5.y
                PVennemy -= 1;
                this.followvirus5.destroy()

            }

            attackplayer6() {
                this.followvirus6.destroy()
                this.piece.x = this.followvirus6.x
                this.piece.y = this.followvirus6.y
                PVennemy -= 1;
                
                


            }

            attackLplayer6() {
                this.piece.x = this.followvirus6.x
                this.piece.y = this.followvirus6.y
                PVennemy -= 1;
                this.followvirus6.destroy()


            }

            attackDplayer6() {
                this.piece.x = this.followvirus6.x
                this.piece.y = this.followvirus6.y
                PVennemy -= 1;
                this.followvirus6.destroy()

            }

            attackUplayer6() {
                this.piece.x = this.followvirus6.x
                this.piece.y = this.followvirus6.y
                PVennemy -= 1;
                this.followvirus6.destroy()

            }

            attackplayer7() {
                this.followvirus7.destroy()
                this.piece.x = this.followvirus7.x
                this.piece.y = this.followvirus7.y
                PVennemy -= 1;
                
                


            }

            attackLplayer7() {
                this.piece.x = this.followvirus7.x
                this.piece.y = this.followvirus7.y
                PVennemy -= 1;
                this.followvirus7.destroy()


            }

            attackDplayer7() {
                this.piece.x = this.followvirus7.x
                this.piece.y = this.followvirus7.y
                PVennemy -= 1;
                this.followvirus7.destroy()

            }

            attackUplayer7() {
                this.piece.x = this.followvirus7.x
                this.piece.y = this.followvirus7.y
                PVennemy -= 1;
                this.followvirus7.destroy()

            }

            attackplayer8() {
                this.followvirus8.destroy()
                this.piece.x = this.followvirus8.x
                this.piece.y = this.followvirus8.y
                PVennemy -= 1;
                
                


            }

            attackLplayer8() {
                this.piece.x = this.followvirus8.x
                this.piece.y = this.followvirus8.y
                PVennemy -= 1;
                this.followvirus8.destroy()


            }

            attackDplayer8() {
                this.piece.x = this.followvirus8.x
                this.piece.y = this.followvirus8.y
                PVennemy -= 1;
                this.followvirus8.destroy()

            }

            attackUplayer8() {
                this.piece.x = this.followvirus8.x
                this.piece.y = this.followvirus8.y
                PVennemy -= 1;
                this.followvirus8.destroy()

            }

            attackplayer9() {
                this.followvirus9.destroy()
                this.piece.x = this.followvirus9.x
                this.piece.y = this.followvirus9.y
                PVennemy -= 1;
                
                


            }

            attackLplayer9() {
                this.piece.x = this.followvirus9.x
                this.piece.y = this.followvirus9.y
                PVennemy -= 1;
                this.followvirus1.destroy()


            }

            attackDplayer9() {
                this.piece.x = this.followvirus9.x
                this.piece.y = this.followvirus9.y
                PVennemy -= 1;
                this.followvirus9.destroy()

            }

            attackUplayer9() {
                this.piece.x = this.followvirus9.x
                this.piece.y = this.followvirus9.y
                PVennemy -= 1;
                this.followvirus9.destroy()

            }

            attackplayer10() {
                this.followvirus10.destroy()
                this.piece.x = this.followvirus10.x
                this.piece.y = this.followvirus10.y
                PVennemy -= 1;
                
                


            }

            attackLplayer10() {
                this.piece.x = this.followvirus10.x
                this.piece.y = this.followvirus10.y
                PVennemy -= 1;
                this.followvirus10.destroy()


            }

            attackDplayer10() {
                this.piece.x = this.followvirus10.x
                this.piece.y = this.followvirus10.y
                PVennemy -= 1;
                this.followvirus1.destroy()

            }

            attackUplayer10() {
                this.piece.x = this.followvirus10.x
                this.piece.y = this.followvirus10.y
                PVennemy -= 1;
                this.followvirus10.destroy()

            }

            attackplayer11() {
                this.followvirus1.destroy()
                this.piece.x = this.followvirus11.x
                this.piece.y = this.followvirus11.y
                PVennemy -= 1;
                
                


            }

            attackLplayer11() {
                this.piece.x = this.followvirus11.x
                this.piece.y = this.followvirus11.y
                PVennemy -= 1;
                this.followvirus11.destroy()


            }

            attackDplayer11() {
                this.piece.x = this.followvirus11.x
                this.piece.y = this.followvirus11.y
                PVennemy -= 1;
                this.followvirus11.destroy()

            }

            attackUplayer11() {
                this.piece.x = this.followvirus11.x
                this.piece.y = this.followvirus11.y
                PVennemy -= 1;
                this.followvirus11.destroy()

            }


























            grappin() {
                this.player.x = this.pylone.x
                this.player.y = this.pylone.y;

            }

            grappinL() {
                this.player.x = this.pylone.x
                this.player.y = this.pylone.y;

            }
            grappinD() {
                this.player.x = this.pylone.x
                this.player.y = this.pylone.y;

            }
            grappinU() {
                this.player.x = this.pylone.x
                this.player.y = this.pylone.y;

            }



            grappin2(zoneattack, pylone2) {
                this.player.x = this.pylone2.x
                this.player.y = this.pylone2.y;

            }

            grappinL2(zoneattackL, pylone2) {
                this.player.x = this.pylone2.x
                this.player.y = this.pylone2.y;

            }
            grappinD2(zoneattackD,pylone2) {
                this.player.x = this.pylone2.x
                this.player.y = this.pylone2.y;

            }
            grappinU2(zoneattackU,pylone2) {
                this.player.x = this.pylone2.x
                this.player.y = this.pylone2.y;

            }


            grappin3(zoneattack, pylone3) {
                this.player.x = this.pylone3.x
                this.player.y = this.pylone3.y;

            }

            grappinL3(zoneattackL, pylone3) {
                this.player.x = this.pylone3.x
                this.player.y = this.pylone3.y;

            }
            grappinD3(zoneattackD,pylone3) {
                this.player.x = this.pylone3.x
                this.player.y = this.pylone3.y;

            }
            grappinU3(zoneattackU,pylone3) {
                this.player.x = this.pylone3.x
                this.player.y = this.pylone3.y;

            }




            grappin4(zoneattack, pylone4) {
                this.player.x = this.pylone4.x
                this.player.y = this.pylone4.y;

            }

            grappinL4(zoneattackL, pylone4) {
                this.player.x = this.pylone4.x
                this.player.y = this.pylone4.y;

            }
            grappinD4(zoneattackD,pylone4) {
                this.player.x = this.pylone4.x
                this.player.y = this.pylone4.y;

            }
            grappinU4(zoneattackU,pylone4) {
                this.player.x = this.pylone4.x
                this.player.y = this.pylone4.y;

            }

            grappin5(zoneattack, pylone5) {
                this.player.x = this.pylone5.x
                this.player.y = this.pylone5.y;

            }

            grappinL5(zoneattackL, pylone5) {
                this.player.x = this.pylone5.x
                this.player.y = this.pylone5.y;

            }
            grappinD5(zoneattackD,pylone5) {
                this.player.x = this.pylone5.x
                this.player.y = this.pylone5.y;

            }
            grappinU5(zoneattackU,pylone5) {
                this.player.x = this.pylone5.x
                this.player.y = this.pylone5.y;

            }


            grappin6(zoneattack, pylone6) {
                this.player.x = this.pylone6.x
                this.player.y = this.pylone6.y;

            }

            grappinL6(zoneattackL, pylone6) {
                this.player.x = this.pylone6.x
                this.player.y = this.pylone6.y;

            }
            grappinD6(zoneattackD,pylone6) {
                this.player.x = this.pylone6.x
                this.player.y = this.pylone6.y;

            }
            grappinU6(zoneattackU,pylone6) {
                this.player.x = this.pylone6.x
                this.player.y = this.pylone6.y;

            }

            grappin7(zoneattack, pylone7) {
                this.player.x = this.pylone7.x
                this.player.y = this.pylone7.y;

            }

            grappinL7(zoneattackL, pylone7) {
                this.player.x = this.pylone7.x
                this.player.y = this.pylone7.y;

            }
            grappinD7(zoneattackD,pylone7) {
                this.player.x = this.pylone7.x
                this.player.y = this.pylone7.y;

            }
            grappinU7(zoneattackU,pylone7) {
                this.player.x = this.pylone7.x
                this.player.y = this.pylone7.y;

            }


            grappin8(zoneattack, pylone8) {
                this.player.x = this.pylone8.x
                this.player.y = this.pylone8.y;

            }

            grappinL8(zoneattackL, pylone8) {
                this.player.x = this.pylone8.x
                this.player.y = this.pylone8.y;

            }
            grappinD8(zoneattackD,pylone8) {
                this.player.x = this.pylone8.x
                this.player.y = this.pylone8.y;

            }
            grappinU8(zoneattackU,pylone8) {
                this.player.x = this.pylone8.x
                this.player.y = this.pylone8.y;

            }

            grappin9(zoneattack, pylone9) {
                this.player.x = this.pylone9.x
                this.player.y = this.pylone9.y;

            }

            grappinL9(zoneattackL, pylone9) {
                this.player.x = this.pylone9.x
                this.player.y = this.pylone9.y;

            }
            grappinD9(zoneattackD,pylone9) {
                this.player.x = this.pylone9.x
                this.player.y = this.pylone9.y;

            }
            grappinU9(zoneattackU,pylone9) {
                this.player.x = this.pylone9.x
                this.player.y = this.pylone9.y;

            }

            grappin10(zoneattack, pylone10) {
                this.player.x = this.pylone10.x
                this.player.y = this.pylone10.y;

            }

            grappinL10(zoneattackL, pylone10) {
                this.player.x = this.pylone10.x
                this.player.y = this.pylone10.y;

            }
            grappinD10(zoneattackD,pylone10) {
                this.player.x = this.pylone10.x
                this.player.y = this.pylone10.y;

            }
            grappinU10(zoneattackU,pylone10) {
                this.player.x = this.pylone10.x
                this.player.y = this.pylone10.y;

            }

            grappin11(zoneattack, pylone11) {
                this.player.x = this.pylone11.x
                this.player.y = this.pylone11.y;

            }

            grappinL11(zoneattackL, pylone11) {
                this.player.x = this.pylone11.x
                this.player.y = this.pylone11.y;

            }
            grappinD11(zoneattackD,pylone11) {
                this.player.x = this.pylone11.x
                this.player.y = this.pylone11.y;

            }
            grappinU11(zoneattackU,pylone11) {
                this.player.x = this.pylone11.x
                this.player.y = this.pylone11.y;

            }

            grappin12(zoneattack, pylone12) {
                this.player.x = this.pylone12.x
                this.player.y = this.pylone12.y;

            }

            grappinL12(zoneattackL, pylone12) {
                this.player.x = this.pylone12.x
                this.player.y = this.pylone12.y;

            }
            grappinD12(zoneattackD,pylone12) {
                this.player.x = this.pylone12.x
                this.player.y = this.pylone12.y;

            }
            grappinU12(zoneattackU,pylone12) {
                this.player.x = this.pylone12.x
                this.player.y = this.pylone12.y;

            }

            grappin13(zoneattack, pylone13) {
                this.player.x = this.pylone13.x
                this.player.y = this.pylone13.y;

            }

            grappinL13(zoneattackL, pylone13) {
                this.player.x = this.pylone13.x
                this.player.y = this.pylone13.y;

            }
            grappinD13(zoneattackD,pylone13) {
                this.player.x = this.pylone13.x
                this.player.y = this.pylone13.y;

            }
            grappinU13(zoneattackU,pylone13) {
                this.player.x = this.pylone13.x
                this.player.y = this.pylone13.y;

            }

            grappin14(zoneattack, pylone14) {
                this.player.x = this.pylone14.x
                this.player.y = this.pylone14.y;

            }

            grappinL14(zoneattackL, pylone14) {
                this.player.x = this.pylone14.x
                this.player.y = this.pylone14.y;

            }
            grappinD14(zoneattackD,pylone14) {
                this.player.x = this.pylone14.x
                this.player.y = this.pylone14.y;

            }
            grappinU14(zoneattackU,pylone14) {
                this.player.x = this.pylone14.x
                this.player.y = this.pylone14.y;

            }


            grappin15(zoneattack, pylone15) {
                this.player.x = this.pylone15.x
                this.player.y = this.pylone15.y;

            }

            grappinL15(zoneattackL, pylone15) {
                this.player.x = this.pylone15.x
                this.player.y = this.pylone15.y;

            }
            grappinD15(zoneattackD,pylone15) {
                this.player.x = this.pylone15.x
                this.player.y = this.pylone15.y;

            }
            grappinU15(zoneattackU,pylone15) {
                this.player.x = this.pylone15.x
                this.player.y = this.pylone15.y;

            }

            grappin16(zoneattack, pylone16) {
                this.player.x = this.pylone16.x
                this.player.y = this.pylone16.y;

            }

            grappinL16(zoneattackL, pylone16) {
                this.player.x = this.pylone16.x
                this.player.y = this.pylone16.y;

            }
            grappinD16(zoneattackD,pylone16) {
                this.player.x = this.pylone16.x
                this.player.y = this.pylone16.y;

            }
            grappinU16(zoneattackU,pylone16) {
                this.player.x = this.pylone16.x
                this.player.y = this.pylone16.y;

            }

            grappin17(zoneattack, pylone17) {
                this.player.x = this.pylone17.x
                this.player.y = this.pylone17.y;

            }

            grappinL17(zoneattackL, pylone17) {
                this.player.x = this.pylone17.x
                this.player.y = this.pylone17.y;

            }
            grappinD17(zoneattackD,pylone17) {
                this.player.x = this.pylone17.x
                this.player.y = this.pylone17.y;

            }
            grappinU17(zoneattackU,pylone17) {
                this.player.x = this.pylone17.x
                this.player.y = this.pylone17.y;

            }

            grappin18(zoneattack, pylone18) {
                this.player.x = this.pylone18.x
                this.player.y = this.pylone18.y;

            }

            grappinL18(zoneattackL, pylone18) {
                this.player.x = this.pylone18.x
                this.player.y = this.pylone18.y;

            }
            grappinD18(zoneattackD,pylone18) {
                this.player.x = this.pylone18.x
                this.player.y = this.pylone18.y;

            }
            grappinU18(zoneattackU,pylone18) {
                this.player.x = this.pylone18.x
                this.player.y = this.pylone18.y;

            }

            




            











            smash() {
                this.boite.disableBody(true,true);
                console.log("ouch")

            }

            smashV() {
                this.boite.disableBody(true,true);
                console.log("ouch")

            }

            chrono() {
                console.log("Fin !")
                this.scene.start("gameover")

            }

            tpmontagnefuite(player, sortiefuitejungle) {
                        sortiefuite = false
                        entreefuite = true
                        this.scene.start("niveaumontagne",{
                    PV : this.PV,
                    score : this.score,
                    obtentionmasque : this.obtentionmasque,
                    obtentionyoyo : this.obtentionyoyo,
                    sortiefuite : this.sortiefuite,
                    entreefuite : this.entreefuite,
                });}

            update() {


                console.log(PVennemy)


                if(coffreouvert == true){
                this.container.visible = true;
                this.textObject.visible = true;
               }
               else if (coffreouvert == false){
                this.container.visible = false;
                this.textObject.visible = false;
               }

               if(coffreminiouvert == true){
                this.containermini.visible = true;
               }
               else if (coffreminiouvert == false){
                this.containermini.visible = false;
               }




                this.scoreText.setText(score)

                

                if (arret == true) {

                    this.player.setVelocityX(0);
                    this.player.setVelocityY(0);

                }

                //fonction attaque
                if (keyZ.isDown && petit == false && this.cursors.right.isDown && this.obtentionyoyo >= 1) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    this.cursors.right.enabled = false;
                    arret = true
                    this.zoneattack.y = this.player.y
                    this.zoneattack.x = this.player.x + 70
                    setTimeout(() => {
                        this.zoneattack.y = 100
                        this.zoneattack.x = 100
                        arret = false
                        this.cursors.right.enabled = true;
                    }, 400);
                }
                else if (keyZ.isDown && petit == true && this.cursors.right.isDown && this.obtentionyoyo >= 1) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattack.y = this.player.y
                    this.zoneattack.x = this.player.x + 40
                    setTimeout(() => {
                        this.zoneattack.y = 100
                        this.zoneattack.x = 100
                        arret = false
                    }, 400);
                }

                if (keyZ.isDown && petit == false && this.cursors.left.isDown && this.obtentionyoyo >= 1) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattackL.y = this.player.y
                    this.zoneattackL.x = this.player.x - 65
                    setTimeout(() => {
                        this.zoneattackL.y = 100
                        this.zoneattackL.x = 100
                        arret = false
                    }, 400);
                }
                else if (keyZ.isDown && petit == true && this.cursors.left.isDown && this.obtentionyoyo >= 1) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattackL.y = this.player.y
                    this.zoneattackL.x = this.player.x - 30
                    setTimeout(() => {
                        this.zoneattackL.y = 100
                        this.zoneattackL.x = 100
                        arret = false
                    }, 400);
                }

                if (keyZ.isDown && petit == false && this.cursors.down.isDown && this.obtentionyoyo >= 1) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattackD.y = this.player.y + 65
                    this.zoneattackD.x = this.player.x 
                    setTimeout(() => {
                        this.zoneattackD.y = 100
                        this.zoneattackD.x = 100
                        arret = false
                    }, 400);
                }
                else if (keyZ.isDown && petit == true && this.cursors.down.isDown && this.obtentionyoyo >= 1) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattackD.y = this.player.y + 30
                    this.zoneattackD.x = this.player.x 
                    setTimeout(() => {
                        this.zoneattackD.y = 100
                        this.zoneattackD.x = 100
                        arret = false
                    }, 400);
                }

                    if (keyZ.isDown && petit == false && this.cursors.up.isDown && this.obtentionyoyo >= 1) {
                        this.cursors.right.reset();
                        this.cursors.left.reset();
                        this.cursors.up.reset();
                        this.cursors.down.reset();
                        arret = true
                        this.zoneattackU.y = this.player.y - 65
                        this.zoneattackU.x = this.player.x 
                        setTimeout(() => {
                            this.zoneattackU.y = 100
                            this.zoneattackU.x = 100
                            arret = false
                        }, 400);
                        }
                        else if (keyZ.isDown && petit == true && this.cursors.up.isDown && this.obtentionyoyo >= 1) {
                        this.cursors.right.reset();
                        this.cursors.left.reset();
                        this.cursors.up.reset();
                        this.cursors.down.reset();
                        arret = true
                        this.zoneattackU.y = this.player.y - 30
                        this.zoneattackU.x = this.player.x 
                        setTimeout(() => {
                            this.zoneattackU.y = 100
                            this.zoneattackU.x = 100
                            arret = false
                        }, 400);
                    }


                    //fonction marteau
                if (keyE.isDown && petit == false && this.cursors.right.isDown  && obtentionmarteau == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    this.cursors.right.enabled = false;
                    arret = true
                    this.marteauR.y = this.player.y + 10
                    this.marteauR.x = this.player.x + 35
                    setTimeout(() => {
                        this.marteauR.y = 100
                        this.marteauR.x = 100
                        arret = false
                        this.cursors.right.enabled = true;
                    }, 400);
                }
                else if (keyE.isDown && petit == true && this.cursors.right.isDown && obtentionmarteau == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauR.y = this.player.y + 5
                    this.marteauR.x = this.player.x + 20
                    setTimeout(() => {
                        this.marteauR.y = 100
                        this.marteauR.x = 100
                        arret = false
                    }, 400);
                }

                if (keyE.isDown && petit == false && this.cursors.left.isDown && obtentionmarteau == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauL.y = this.player.y + 10
                    this.marteauL.x = this.player.x -35
                    setTimeout(() => {
                        this.marteauL.y = 100
                        this.marteauL.x = 100
                        arret = false
                    }, 400);
                }
                else if (keyE.isDown && petit == true && this.cursors.left.isDown && obtentionmarteau == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauL.y = this.player.y + 5
                    this.marteauL.x = this.player.x - 20
                    setTimeout(() => {
                        this.marteauL.y = 100
                        this.marteauL.x = 100
                        arret = false
                    }, 400);
                }

                if (keyE.isDown && petit == false && this.cursors.down.isDown && obtentionmarteau == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauD.y = this.player.y + 40
                    this.marteauD.x = this.player.x 
                    setTimeout(() => {
                        this.marteauD.y = 100
                        this.marteauD.x = 100
                        arret = false
                    }, 400);
                }
                else if (keyE.isDown && petit == true && this.cursors.down.isDown && obtentionmarteau == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauD.y = this.player.y + 20
                    this.marteauD.x = this.player.x 
                    setTimeout(() => {
                        this.marteauD.y = 100
                        this.marteauD.x = 100
                        arret = false
                    }, 400);
                }

                if (keyE.isDown && petit == false && this.cursors.up.isDown && obtentionmarteau == true) {
                        this.cursors.right.reset();
                        this.cursors.left.reset();
                        this.cursors.up.reset();
                        this.cursors.down.reset();
                        arret = true
                        this.marteauU.y = this.player.y - 25
                        this.marteauU.x = this.player.x 
                        setTimeout(() => {
                            this.marteauU.y = 100
                            this.marteauU.x = 100
                            arret = false
                        }, 400);
                        }
                        else if (keyE.isDown && petit == true && this.cursors.up.isDown && obtentionmarteau == true) {
                        this.cursors.right.reset();
                        this.cursors.left.reset();
                        this.cursors.up.reset();
                        this.cursors.down.reset();
                        arret = true
                        this.marteauU.y = this.player.y - 15
                        this.marteauU.x = this.player.x 
                        setTimeout(() => {
                            this.marteauU.y = 100
                            this.marteauU.x = 100
                            arret = false
                        }, 400);
                }

                //fonction minimize
                if (keyA.isDown && petit == false && obtentionmini == true) {
                    this.player.setScale(0.5)
                    this.zoneattack.setScale(0.5)
                    this.zoneattackL.setScale(0.5)
                    this.zoneattackU.setScale(0.5)
                    this.zoneattackD.setScale(0.5)
                    this.marteauR.setScale(0.5)
                    this.marteauL.setScale(0.5)
                    this.marteauD.setScale(0.5)
                    this.marteauU.setScale(0.5)
                    setTimeout(() => {
                        petit = true;

                    }, 200);
                }
                else if (keyA.isDown && petit == true && obtentionmini == true) {
                    this.player.setScale(1)
                    this.zoneattack.setScale(1)
                    this.zoneattackL.setScale(1)
                    this.zoneattackD.setScale(1)
                    this.zoneattackU.setScale(1)
                    this.marteauR.setScale(1)
                    this.marteauU.setScale(1)
                    this.marteauL.setScale(1)
                    this.marteauD.setScale(1)
                    setTimeout(() => {
                        petit = false;

                    }, 200);





                }
                if (this.cursors.left.isDown) { //si la touche gauche est appuyée
                    this.player.setVelocityX(-160); //alors vitesse négative en X
                    this.player.anims.play('left', true); //et animation => gauche
                }
                else if (this.cursors.right.isDown) { //sinon si la touche droite est appuyée
                    this.player.setVelocityX(160); //alors vitesse positive en X
                    this.player.anims.play('right', true); //et animation => droite
                }
                else { // sinon
                    this.player.setVelocityX(0); //vitesse nulle
                    //this.player.anims.play('turn', true); //animation fait face caméra
                    turn = true;
                }

                if (this.cursors.up.isDown) {
                    //si touche haut appuyée ET que le perso touche le sol
                    this.player.setVelocityY(-160); //alors vitesse verticale négative
                    this.player.anims.play('up', true);

                }
                else if (this.cursors.down.isDown) {
                    //si touche haut appuyée ET que le perso touche le sol
                    this.player.setVelocityY(160); //alors vitesse verticale négative
                    this.player.anims.play('down', true);

                }
                else {
                    //si touche haut appuyée ET que le perso touche le sol
                    this.player.setVelocityY(0); //alors vitesse verticale négative
                    if (turn == true) {
                        this.player.anims.play('turn', true); //animation fait face caméra
                        //(on saute)
                    }
                }

                turn = false;

                if(PV == 0){
                    this.scene.start("gameover")
                }

                if (this.gameOver) { return; }

            }


            tpsortiejungle(player, sortiejungle) {
                this.sortieJ = true
                console.log("trueJ")
                this.scene.start("camp",{
                sortieP : this.sortieP,
                sortieJ : this.sortieJ,
                PV : this.PV,
                obtentionyoyo : this.obtentionyoyo,
                obtentionmini : this.obtentionmini
                });
            }


            collectStar(player, star) {
                console.log(star)
                Game.scene.start("niveau2")


            }


        }














        class camp extends Phaser.Scene {


        constructor() {

                super("camp")
            }

            init(data) { 
                this.sortieP = data.sortieP;
                this.sortieM = data.sortieM;
                this.sortieJ = data.sortieJ;
                this.PV = data.PV;
                this.obtentionyoyo = data.obtentionyoyo
            }


            preload() {
                // chargement tuiles de jeu
                this.load.image("Phaser_Tileset", "assets/placeholdernew.png");

                // chargement de la carte
                this.load.tilemapTiledJSON("cartecamp", "assets/Camp.json");



                this.load.spritesheet('perso', 'assets/protopetit.png',
                    { frameWidth: 32, frameHeight: 48 });

                this.load.spritesheet('marchand', 'assets/marchand.png',
                { frameWidth: 32, frameHeight: 48 });

                    this.load.spritesheet("zoneattack", "assets/zoneattack.png", {
                    frameWidth: 96,
                    frameHeight: 48,
                });

                this.load.spritesheet("zoneattackL", "assets/zoneattackL.png", {
                    frameWidth: 96,
                    frameHeight: 48,
                });

                this.load.spritesheet("entreejungle", "assets/entreejungle.png", {
                    frameWidth: 32,
                    frameHeight: 32,
                });

                this.load.spritesheet("sortieplage", "assets/sortieplage.png", {
                    frameWidth: 32,
                    frameHeight: 32,
                });

                this.load.spritesheet("entreemontagne1", "assets/entreemontagne1.png", {
                    frameWidth: 32,
                    frameHeight: 32,
                });

                this.load.spritesheet("zoneattackD", "assets/zoneattackD.png", {
                    frameWidth: 48,
                    frameHeight: 96,
                });

                this.load.spritesheet("zoneattackU", "assets/zoneattackU.png", {
                    frameWidth: 48,
                    frameHeight: 96,
                });

                this.load.spritesheet("marteau", "assets/marteau.png", {
                    frameWidth: 38,
                    frameHeight: 38,
                });

                this.load.spritesheet("pylone", "assets/pylone.png", {
                    frameWidth: 38,
                    frameHeight: 38,
                });

                this.load.spritesheet("boite", "assets/boite.png", {
                    frameWidth: 39,
                    frameHeight: 46,
                });

                this.load.spritesheet("boiteP", "assets/boiteP.png", {
                    frameWidth: 27,
                    frameHeight: 46,
                });

                this.load.spritesheet("marteauV", "assets/marteauV.png", {
                    frameWidth: 38,
                    frameHeight: 38,
                });

                this.load.spritesheet("article", "assets/article.png", {
                    frameWidth: 79,
                    frameHeight: 75,
                });

                this.load.image('FondUI', 'assets/fondUI.png');
                this.load.image('fullcoeur', 'assets/fullcoeur.png');
                this.load.image('deuxcoeurs', 'assets/deuxcoeurs.png');
                this.load.image('uncoeur', 'assets/uncoeur.png');

                this.load.bitmapFont(
                    'myfont',
                    'assets/typo.png',
                    'assets/typo.xml'
                );


                this.load.image('container', 'assets/boitedialogue.png');
                this.load.image('containeryoyo', 'assets/containeryoyo.png');
                this.load.image('containeryoyo2', 'assets/containeryoyo2.png');
                this.load.image('containeryoyo3', 'assets/containeryoyo3.png');
                this.load.image('containeryoyo4', 'assets/containeryoyo4.png');
                this.load.image('containeryoyo5', 'assets/containeryoyo5.png');
                this.load.image('containerachat', 'assets/containerachat.png');
                this.load.image('containerrefusachat', 'assets/containerachat.png');

                this.load.spritesheet('coffre1', 'assets/coffreface.png',
                    { frameWidth: 64, frameHeight: 64 });

                    this.load.spritesheet("marteauD", "assets/marteauD.png", {
                    frameWidth: 25,
                    frameHeight: 34,
                });

                this.load.spritesheet("marteauU", "assets/marteauU.png", {
                    frameWidth: 25,
                    frameHeight: 35,
                });

                this.load.spritesheet("marteauL", "assets/marteauL.png", {
                    frameWidth: 40,
                    frameHeight: 25,
                });

                this.load.spritesheet("marteauR", "assets/marteauR.png", {
                    frameWidth: 40,
                    frameHeight: 25,
                });

            }


            create() {
                talkyoyo = false
                talkyoyo2 = false
                talkyoyo3 = false
                talkyoyo4 = false
                coffreouvert = false
                // chargement de la carte du niveau
                const carteDuNiveau = this.add.tilemap("cartecamp");
                // chargement du jeu de tuiles
                const tileset = carteDuNiveau.addTilesetImage(
                    "placeholdernew",
                    "Phaser_Tileset"
                );



                // chargement du calque "calque_backgroung"
                const solcamp = carteDuNiveau.createLayer(
                    "sol",
                    tileset
                );

                // chargement du calque "calque_backgroung"
                const blocscamp = carteDuNiveau.createLayer(
                    "blocs",
                    tileset
                );

                // chargement du second calque "calque_backgroung"
                const statuescamp = carteDuNiveau.createLayer(
                    "statues",
                    tileset
                );

                petit = false
                if (sortieJ == true){
                    this.player = this.physics.add.sprite(575, 850, 'perso');
                }
                else if (sortieJ == false && sortieM == false) {
                    this.player = this.physics.add.sprite(575, 100, 'perso');
                }
                else if (sortieM == true) {
                    this.player = this.physics.add.sprite(820, 500, 'perso');
                }

                //chronometre de la fuite laissant au joueur un délai de 3 minutes pour passer a la zone suivante
                if(obtentionmasque == 1){
                    
                    this.earthquack = this.time.addEvent({
                        delay: 1000,
                        callback: ()=>{
                            this.cameras.main.shake(1000,0.01)
                        },
                        loop: true
                    })
                    this.chronometre = this.time.delayedCall(180000, this.chrono, [],null, this);

                }


                
                sortieJ = false
                sortieM = false
                //taille de la hitbox
                this.player.setSize(32, 32);
                //decaler la hitbox
                this.player.setOffset(0, 15);
                this.anims.create({
                    key: 'left',
                    frames: this.anims.generateFrameNumbers('perso', { start: 0, end: 1 }),
                    frameRate: 10,
                    repeat: -1
                });
                this.anims.create({
                    key: 'turn',
                    frames: [{ key: 'perso', frame: 2 }],
                    frameRate: 20
                });
                this.anims.create({
                    key: 'right',
                    frames: this.anims.generateFrameNumbers('perso', { start: 3, end: 4 }),
                    frameRate: 10,
                    repeat: -1
                });

                this.anims.create({
                    key: 'up',
                    frames: this.anims.generateFrameNumbers('perso', { start: 8, end: 9 }),
                    frameRate: 10,
                    repeat: 1
                });

                this.anims.create({
                    key: 'down',
                    frames: this.anims.generateFrameNumbers('perso', { start: 5, end: 6 }),
                    frameRate: 10,
                    repeat: -1
                });

                blocscamp.setCollisionByProperty({ solide: true });
                statuescamp.setCollisionByProperty({ solide: true });

                this.physics.add.collider(this.player, blocscamp);
                this.physics.add.collider(this.player, statuescamp);

                this.cursors = this.input.keyboard.createCursorKeys();

                this.zoneattack = this.physics.add.sprite(100, 100, "zoneattack").setInteractive();

                this.physics.add.collider(this.zoneattack, this.virus, this.attackplayer, null, this);

                this.zoneattackL = this.physics.add.sprite(100, 100, "zoneattackL").setInteractive();

                this.physics.add.collider(this.zoneattackL, this.virus, this.attackLplayer, null, this);

                this.zoneattackD = this.physics.add.sprite(100, 100, "zoneattackD").setInteractive();

                this.physics.add.collider(this.zoneattackD, this.virus, this.attackDplayer, null, this);

                this.zoneattackU = this.physics.add.sprite(100, 100, "zoneattackU").setInteractive();

                this.physics.add.collider(this.zoneattackU, this.virus, this.attackUplayer, null, this);

                //hitbox du marteau
                this.marteauR = this.physics.add.sprite(100, 100, "marteauR").setInteractive();
                this.marteauR.setCollideWorldBounds(true);
                this.physics.add.collider(this.marteauR, this.boite, this.smash, null, this);

                this.marteauU = this.physics.add.sprite(100, 100, "marteauU").setInteractive();
                this.marteauU.setCollideWorldBounds(true);
                this.physics.add.collider(this.marteauU, this.boite, this.smashV, null, this);

                this.marteauL = this.physics.add.sprite(100, 100, "marteauL").setInteractive();
                this.marteauL.setCollideWorldBounds(true);
                this.physics.add.collider(this.marteauL, this.boite, this.smashV, null, this);

                this.marteauD = this.physics.add.sprite(100, 100, "marteauD").setInteractive();
                this.marteauD.setCollideWorldBounds(true);
                this.physics.add.collider(this.marteauD, this.boite, this.smashV, null, this);


                this.cameras.main.setBounds(0, 0, 1056, 1056);
                this.cameras.main.startFollow(this.player, 0.1, 0.1);
                

                keyA = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.A);
                keyZ = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.Z);
                keyE = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.E);

                this.entreejungle = this.physics.add.sprite(600, 900, "entreejungle").setInteractive();
                this.entreejungle.setImmovable();
                this.entreejungle.setSize(500,32);
                this.physics.add.collider(this.entreejungle, this.player, this.tpentreejungle, null, this);

                this.entreemontagne = this.physics.add.sprite(1058, 525, "entreemontagne1").setInteractive();
                this.entreemontagne.setImmovable();
                this.entreemontagne.setSize(32,200);
                this.physics.add.collider(this.entreemontagne, this.player, this.tpentreemontagne, null, this);

                this.sortieplage = this.physics.add.sprite(575, 50, "entreemontagne1").setInteractive();
                this.sortieplage.setImmovable();
                this.sortieplage.setSize(100,32);
                this.physics.add.collider(this.sortieplage, this.player, this.tpsortieplage, null, this);

                this.marchand = this.physics.add.sprite(480, 610, 'marchand');
                this.marchand.setImmovable();
                this.physics.add.collider(this.marchand, this.player, this.talk, null, this);

                this.anims.create({
                    key: 'chill',
                    frames: this.anims.generateFrameNumbers('marchand', { start: 0, end: 1 }),
                    frameRate: 5,
                    repeat: -1
                });
                this.anims.create({
                    key: 'parle',
                    frames: this.anims.generateFrameNumbers('marchand', { start: 2, end: 3 }),
                    frameRate: 5,
                    repeat: -1
                });
                this.marchand.anims.play('chill', true);

                this.add.image(550,290, 'FondUI').setScrollFactor(0);

                this.fullcoeur = this.add.image(550,290, 'fullcoeur').setScrollFactor(0);
                this.fullcoeur.visible = false;
                this.deuxcoeurs = this.add.image(550,290, 'deuxcoeurs').setScrollFactor(0);
                this.deuxcoeurs.visible = false;
                this.uncoeur = this.add.image(550,290, 'uncoeur').setScrollFactor(0);
                this.uncoeur.visible = false;
                this.scoreText=this.add.text(115,100,score,{fontSize:'64px',fill:'#FFFFFF',strokeThickness: 6, stroke:'#000000'}).setScrollFactor(0);
                this.scoreText.setText(score); //met à jour l’affichage du score

                if(PV == 3){
                    this.fullcoeur.visible = true;
                }
                else if (PV == 2){
                    this.deuxcoeurs.visible = true;
                }
                else if (PV == 1){
                    this.uncoeur.visible = true;
                }

                


                this.container = this.add.sprite(550, 475, 'container').setScrollFactor(0);
                this.container.alpha = 0.8;
                this.container.visible = false;

                var message = 'Tu as obtenu 20 pieces antiques !';
                this.textObject = this.add.bitmapText(380,470, 'myfont', message, 27).setScrollFactor(0);
                this.textObject.visible = false;



                this.containeryoyo = this.add.sprite(550, 475, 'containeryoyo').setScrollFactor(0);
                this.containeryoyo.alpha = 0.8;
                this.containeryoyo.visible = false;

                this.containeryoyo2 = this.add.sprite(550, 475, 'containeryoyo2').setScrollFactor(0);
                this.containeryoyo2.alpha = 0.8;
                this.containeryoyo2.visible = false;

                this.containeryoyo3 = this.add.sprite(550, 475, 'containeryoyo3').setScrollFactor(0);
                this.containeryoyo3.alpha = 0.8;
                this.containeryoyo3.visible = false;

                this.containeryoyo4 = this.add.sprite(550, 475, 'containeryoyo4').setScrollFactor(0);
                this.containeryoyo4.alpha = 0.8;
                this.containeryoyo4.visible = false;

                this.containeryoyo5 = this.add.sprite(550, 475, 'containeryoyo5').setScrollFactor(0);
                this.containeryoyo5.alpha = 0.8;
                this.containeryoyo5.visible = false;

                this.containerachat = this.add.sprite(550, 475, 'containerachat').setScrollFactor(0);
                this.containerachat.alpha = 0.8;
                this.containerachat.visible = false;

                this.containerrefusachat = this.add.sprite(550, 475, 'containerrefusachat').setScrollFactor(0);
                this.containerrefusachat.alpha = 0.8;
                this.containerrefusachat.visible = false;



                if(obtentionmasque == 1){
                    
                    this.earthquack = this.time.addEvent({
                        delay: 1000,
                        callback: ()=>{
                            this.cameras.main.shake(1000,0.01)
                        },
                        loop: true
                    })
                    this.chronometre = this.time.delayedCall(500000, [],null, this);

                }


                

                this.coffre1 = this.physics.add.sprite(500, 500, 'coffre1');
                this.physics.add.collider(this.player, this.coffre1,this.collectcoin);
                this.coffre1.setImmovable();

                this.article = this.physics.add.sprite(410, 620, "article").setInteractive();
                this.physics.add.collider(this.player, this.article,this.achat);
                this.article.setImmovable();




                

                
            }



            achat(player,article){



                if(score >= 40){
                        score -= 40
                        article.disableBody(true,true);
                    setTimeout(() => {
                        boiteachat = false;
                    }, 4500);
                    boiteachat = true
                    if (PV == 2){
                        PV += 1
                        player.scene.deuxcoeurs.visible = false;
                        player.scene.fullcoeur.visible = true;
                    }
                    else if (PV == 1){
                        PV += 1
                        player.scene.deuxcoeurs.visible = true;
                        player.scene.fullcoeur.visible = false;
                        player.scene.uncoeur.visible = false;
                    }
                }
               



                
                

            }



            degats(player, virus) {
                

                if (PV == 3){
                    setTimeout(() => {
                        this.player.setOffset(0, 15);
                    }, 1000);
                    this.player.setOffset(5000,5000);
                    player.alpha = 0.5
                    this.serolReset = this.time.addEvent({
                        delay: 1000,
                        callback: ()=>{
                            player.alpha = 1;
                        },
                        loop: false
                    })
                    PV -= 1//si le virus nous touche, on perd un PV
                    console.log("aie")
                    this.deuxcoeurs.visible = true;
                    this.fullcoeur.visible = false;
                    
                } else if (PV == 2){
                    setTimeout(() => {
                        this.player.setOffset(0, 15);
                    }, 1000);
                    this.player.setOffset(5000,5000);
                    player.alpha = 0.5
                    this.serolReset = this.time.addEvent({
                        delay: 1000,
                        callback: ()=>{
                            player.alpha = 1;
                        },
                        loop: false
                    })
                    PV -= 1//si le virus nous touche, on perd un PV
                    console.log("aie2")
                    this.uncoeur.visible = true;
                    this.deuxcoeurs.visible = false;
                    
                } else if (PV == 1){
                    this.scene.start("gameover")
                
                }
            }


            collectcoin(player,coffre1){ 
                player.scene.cameras.main.shake(500,0.05)

                setTimeout(() => {
                    coffreouvert = false;
                }, 1000);
                coffreouvert = true
                score += 20; //augmente le score de 20
                coffre1.disableBody(true, true);

                
            }

            talk(player,marchand){
                if (obtentionyoyo == true){
                        setTimeout(() => {
                        talkyoyo5 = false;
                    }, 4000);
                    talkyoyo5 = true
                }





                if(obtentionyoyo == false){
                    setTimeout(() => {
                    

                    setTimeout(() => {
                        setTimeout(() => {
                            player.scene.obtentionyoyo = true; 
                            setTimeout(() => {
                    talkyoyo4 = false;
                }, 4000);
                talkyoyo4 = true
                    talkyoyo3 = false;
                }, 4000);
                talkyoyo3 = true

                    talkyoyo2 = false;
                }, 4000);
                talkyoyo2 = true

                    talkyoyo = false;
                }, 4000);
                talkyoyo = true
                }
                
                


            }

            attackplayer(zoneattack, virus) {
                    PVennemy -= 1;

                }

                attackLplayer(zoneattack, virus) {
                    PVennemy -= 1;

                }

                attackDplayer(zoneattackD, virus) {
                    PVennemy -= 1;

                }

                attackUplayer(zoneattackU, virus) {
                    PVennemy -= 1;

                }

                grappin(zoneattack, pylone) {
                    this.player.x = this.pylone.x
                    this.player.y = this.pylone.y;

                }

                grappinL(zoneattackL, pylone) {
                    this.player.x = this.pylone.x
                    this.player.y = this.pylone.y;

                }
                grappinD(zoneattackD, pylone) {
                    this.player.x = this.pylone.x
                    this.player.y = this.pylone.y;

                }
                grappinU(zoneattackU, pylone) {
                    this.player.x = this.pylone.x
                    this.player.y = this.pylone.y;

                }

                smash(marteau, boite) {
                    this.boite.disableBody(true,true);
                    console.log("ouch")

                }

                smashV(marteauV, boite) {
                    this.boite.disableBody(true,true);
                    console.log("ouch")

                }


            update() {

                
               if(coffreouvert == true){
                this.container.visible = true;
                this.textObject.visible = true;
               }
               else if (coffreouvert == false){
                this.container.visible = false;
                this.textObject.visible = false;
               }

               if(talkyoyo == true){
                this.containeryoyo.visible = true;
               }
               else if (talkyoyo == false){
                this.containeryoyo.visible = false;
               }

               if(talkyoyo2 == true){
                this.containeryoyo2.visible = true;
               }
               else if (talkyoyo2 == false){
                this.containeryoyo2.visible = false;
               }

               if(talkyoyo3 == true){
                this.containeryoyo3.visible = true;
               }
               else if (talkyoyo3 == false){
                this.containeryoyo3.visible = false;
               }

               if(talkyoyo4 == true){
                obtentionyoyo = true
                this.containeryoyo4.visible = true;
               }
               else if (talkyoyo4 == false){
                this.containeryoyo4.visible = false;
               }

               if(talkyoyo5 == true){
                this.containeryoyo5.visible = true;
               }
               else if (talkyoyo5 == false){
                this.containeryoyo5.visible = false;
               }

               if(boiteachat == true){
                this.containerachat.visible = true;
               }
               else if (boiteachat == false){
                this.containerachat.visible = false;
               }












                this.scoreText.setText(score)
                if (PVennemy == 0) {
                    this.virus.disableBody(true, true)
                }

                if (arret == true) {

                    this.player.setVelocityX(0);
                    this.player.setVelocityY(0);

                }

                

                //fonction attaque
                if (keyZ.isDown && petit == false && this.cursors.right.isDown && this.obtentionyoyo == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    this.cursors.right.enabled = false;
                    arret = true
                    this.zoneattack.y = this.player.y
                    this.zoneattack.x = this.player.x + 70
                    setTimeout(() => {
                        this.zoneattack.y = 100
                        this.zoneattack.x = 100
                        arret = false
                        this.cursors.right.enabled = true;
                    }, 400);
                }
                else if (keyZ.isDown && petit == true && this.cursors.right.isDown && this.obtentionyoyo == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattack.y = this.player.y
                    this.zoneattack.x = this.player.x + 40
                    setTimeout(() => {
                        this.zoneattack.y = 100
                        this.zoneattack.x = 100
                        arret = false
                    }, 400);
                }

                if (keyZ.isDown && petit == false && this.cursors.left.isDown && this.obtentionyoyo == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattackL.y = this.player.y
                    this.zoneattackL.x = this.player.x - 65
                    setTimeout(() => {
                        this.zoneattackL.y = 100
                        this.zoneattackL.x = 100
                        arret = false
                    }, 400);
                }
                else if (keyZ.isDown && petit == true && this.cursors.left.isDown && this.obtentionyoyo == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattackL.y = this.player.y
                    this.zoneattackL.x = this.player.x - 30
                    setTimeout(() => {
                        this.zoneattackL.y = 100
                        this.zoneattackL.x = 100
                        arret = false
                    }, 400);
                }

                if (keyZ.isDown && petit == false && this.cursors.down.isDown && this.obtentionyoyo == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattackD.y = this.player.y + 65
                    this.zoneattackD.x = this.player.x 
                    setTimeout(() => {
                        this.zoneattackD.y = 100
                        this.zoneattackD.x = 100
                        arret = false
                    }, 400);
                }
                else if (keyZ.isDown && petit == true && this.cursors.down.isDown && this.obtentionyoyo == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattackD.y = this.player.y + 30
                    this.zoneattackD.x = this.player.x 
                    setTimeout(() => {
                        this.zoneattackD.y = 100
                        this.zoneattackD.x = 100
                        arret = false
                    }, 400);
                }

                    if (keyZ.isDown && petit == false && this.cursors.up.isDown && this.obtentionyoyo == true) {
                        this.cursors.right.reset();
                        this.cursors.left.reset();
                        this.cursors.up.reset();
                        this.cursors.down.reset();
                        arret = true
                        this.zoneattackU.y = this.player.y - 65
                        this.zoneattackU.x = this.player.x 
                        setTimeout(() => {
                            this.zoneattackU.y = 100
                            this.zoneattackU.x = 100
                            arret = false
                        }, 400);
                        }
                        else if (keyZ.isDown && petit == true && this.cursors.up.isDown && this.obtentionyoyo == true) {
                        this.cursors.right.reset();
                        this.cursors.left.reset();
                        this.cursors.up.reset();
                        this.cursors.down.reset();
                        arret = true
                        this.zoneattackU.y = this.player.y - 30
                        this.zoneattackU.x = this.player.x 
                        setTimeout(() => {
                            this.zoneattackU.y = 100
                            this.zoneattackU.x = 100
                            arret = false
                        }, 400);
                    }


                       //fonction marteau
                if (keyE.isDown && petit == false && this.cursors.right.isDown && obtentionmarteau == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    this.cursors.right.enabled = false;
                    arret = true
                    this.marteauR.y = this.player.y + 10
                    this.marteauR.x = this.player.x + 35
                    setTimeout(() => {
                        this.marteauR.y = 100
                        this.marteauR.x = 100
                        arret = false
                        this.cursors.right.enabled = true;
                    }, 400);
                }
                else if (keyE.isDown && petit == true && this.cursors.right.isDown && obtentionmarteau == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauR.y = this.player.y + 5
                    this.marteauR.x = this.player.x + 20
                    setTimeout(() => {
                        this.marteauR.y = 100
                        this.marteauR.x = 100
                        arret = false
                    }, 400);
                }

                if (keyE.isDown && petit == false && this.cursors.left.isDown && obtentionmarteau == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauL.y = this.player.y + 10
                    this.marteauL.x = this.player.x -35
                    setTimeout(() => {
                        this.marteauL.y = 100
                        this.marteauL.x = 100
                        arret = false
                    }, 400);
                }
                else if (keyE.isDown && petit == true && this.cursors.left.isDown && obtentionmarteau == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauL.y = this.player.y + 5
                    this.marteauL.x = this.player.x - 20
                    setTimeout(() => {
                        this.marteauL.y = 100
                        this.marteauL.x = 100
                        arret = false
                    }, 400);
                }

                if (keyE.isDown && petit == false && this.cursors.down.isDown && obtentionmarteau == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauD.y = this.player.y + 40
                    this.marteauD.x = this.player.x 
                    setTimeout(() => {
                        this.marteauD.y = 100
                        this.marteauD.x = 100
                        arret = false
                    }, 400);
                }
                else if (keyE.isDown && petit == true && this.cursors.down.isDown && obtentionmarteau == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauD.y = this.player.y + 20
                    this.marteauD.x = this.player.x 
                    setTimeout(() => {
                        this.marteauD.y = 100
                        this.marteauD.x = 100
                        arret = false
                    }, 400);
                }

                if (keyE.isDown && petit == false && this.cursors.up.isDown && obtentionmarteau == true) {
                        this.cursors.right.reset();
                        this.cursors.left.reset();
                        this.cursors.up.reset();
                        this.cursors.down.reset();
                        arret = true
                        this.marteauU.y = this.player.y - 25
                        this.marteauU.x = this.player.x 
                        setTimeout(() => {
                            this.marteauU.y = 100
                            this.marteauU.x = 100
                            arret = false
                        }, 400);
                        }
                        else if (keyE.isDown && petit == true && this.cursors.up.isDown) {
                        this.cursors.right.reset();
                        this.cursors.left.reset();
                        this.cursors.up.reset();
                        this.cursors.down.reset();
                        arret = true
                        this.marteauU.y = this.player.y - 15
                        this.marteauU.x = this.player.x 
                        setTimeout(() => {
                            this.marteauU.y = 100
                            this.marteauU.x = 100
                            arret = false
                        }, 400);
                }

                //fonction minimize
                if (keyA.isDown && petit == false && obtentionmini == true) {
                    this.player.setScale(0.5)
                    this.zoneattack.setScale(0.5)
                    this.zoneattackL.setScale(0.5)
                    this.zoneattackU.setScale(0.5)
                    this.zoneattackD.setScale(0.5)
                    this.marteauR.setScale(0.5)
                    this.marteauL.setScale(0.5)
                    this.marteauD.setScale(0.5)
                    this.marteauU.setScale(0.5)
                    setTimeout(() => {
                        petit = true;

                    }, 200);
                }
                else if (keyA.isDown && petit == true && obtentionmini == true) {
                    this.player.setScale(1)
                    this.zoneattack.setScale(1)
                    this.zoneattackL.setScale(1)
                    this.zoneattackD.setScale(1)
                    this.zoneattackU.setScale(1)
                    this.marteauR.setScale(1)
                    this.marteauU.setScale(1)
                    this.marteauL.setScale(1)
                    this.marteauD.setScale(1)
                    setTimeout(() => {
                        petit = false;

                    }, 200);





                }
                if (this.cursors.left.isDown) { //si la touche gauche est appuyée
                    this.player.setVelocityX(-160); //alors vitesse négative en X
                    this.player.anims.play('left', true); //et animation => gauche
                }
                else if (this.cursors.right.isDown) { //sinon si la touche droite est appuyée
                    this.player.setVelocityX(160); //alors vitesse positive en X
                    this.player.anims.play('right', true); //et animation => droite
                }
                else { // sinon
                    this.player.setVelocityX(0); //vitesse nulle
                    //this.player.anims.play('turn', true); //animation fait face caméra
                    turn = true;
                }

                if (this.cursors.up.isDown) {
                    //si touche haut appuyée ET que le perso touche le sol
                    this.player.setVelocityY(-160); //alors vitesse verticale négative
                    this.player.anims.play('up', true);

                }
                else if (this.cursors.down.isDown) {
                    //si touche haut appuyée ET que le perso touche le sol
                    this.player.setVelocityY(160); //alors vitesse verticale négative
                    this.player.anims.play('down', true);

                }
                else {
                    //si touche haut appuyée ET que le perso touche le sol
                    this.player.setVelocityY(0); //alors vitesse verticale négative
                    if (turn == true) {
                        this.player.anims.play('turn', true); //animation fait face caméra
                        //(on saute)
                    }
                }

                turn = false;

                if (this.gameOver) { return; }

            }

            tpentreejungle(player, entreejungle) {
                    this.sortieJ = true
                    this.scene.start("niveau1",{
                        sortieJ : this.sortieJ,
                        PV : this.PV,
                        obtentionyoyo : this.obtentionyoyo,
                        obtentionmasque : this.obtentionmasque,
                    });
                }

            tpentreemontagne(player, entreemontagne) {
            this.scene.start("niveaumontagne",{
                PV : this.PV,
                obtentionyoyo : this.obtentionyoyo,
                obtentionmasque : this.obtentionmasque
            });
            }

            tpsortieplage(player, sortieplage) {
                this.sortieP = true
                console.log("true")
                this.scene.start("niveauplage",{
                sortieP : this.sortieP,
                obtentionyoyo : this.obtentionyoyo,
                obtentionmasque : this.obtentionmasque
            });
            }
            chrono() {
                console.log("Fin !")
                this.scene.start("gameover")

            }



        }
        









        class niveauplage extends Phaser.Scene {


            constructor() {

                super("niveauplage")
            }

            init(data) { 
                this.sortieP = data.sortieP;
                this.PV = data.PV;
                this.obtentionmasque = data.obtentionmasque;
                this.obtentionyoyo = data.obtentionyoyo;
            }


            preload() {

                 
                // chargement tuiles de jeu
                this.load.image("Phaser_Tileset", "assets/placeholdernew.png");

                // chargement de la carte
                this.load.tilemapTiledJSON("carteplage", "assets/plage.json");

                

                this.load.spritesheet('perso', 'assets/protopetit.png',
                    { frameWidth: 32, frameHeight: 48 });

                    this.load.spritesheet("zoneattack", "assets/zoneattack.png", {
                    frameWidth: 96,
                    frameHeight: 48,
                });

                this.load.spritesheet("zoneattackL", "assets/zoneattackL.png", {
                    frameWidth: 96,
                    frameHeight: 48,
                });

                this.load.spritesheet("entreeplage", "assets/entreeplage.png", {
                    frameWidth: 32,
                    frameHeight: 32,
                });

                this.load.spritesheet("zoneattackD", "assets/zoneattackD.png", {
                    frameWidth: 48,
                    frameHeight: 96,
                });

                this.load.spritesheet("zoneattackU", "assets/zoneattackU.png", {
                    frameWidth: 48,
                    frameHeight: 96,
                });

                this.load.spritesheet("marteau", "assets/marteau.png", {
                    frameWidth: 38,
                    frameHeight: 38,
                });

                this.load.spritesheet("pylone", "assets/pylone.png", {
                    frameWidth: 38,
                    frameHeight: 38,
                });

                this.load.spritesheet("boite", "assets/boite.png", {
                    frameWidth: 39,
                    frameHeight: 46,
                });

                this.load.spritesheet("boiteP", "assets/boiteP.png", {
                    frameWidth: 27,
                    frameHeight: 46,
                });

                this.load.spritesheet("marteauV", "assets/marteauV.png", {
                    frameWidth: 38,
                    frameHeight: 38,
                });

                this.load.spritesheet("marteauD", "assets/marteauD.png", {
                    frameWidth: 25,
                    frameHeight: 34,
                });

                this.load.spritesheet("marteauU", "assets/marteauU.png", {
                    frameWidth: 25,
                    frameHeight: 35,
                });

                this.load.spritesheet("marteauL", "assets/marteauL.png", {
                    frameWidth: 40,
                    frameHeight: 25,
                });

                this.load.spritesheet("marteauR", "assets/marteauR.png", {
                    frameWidth: 40,
                    frameHeight: 25,
                });


                this.load.spritesheet('marchand', 'assets/marchand.png',
                { frameWidth: 32, frameHeight: 48 });

                this.load.spritesheet("virus", "assets/mobile.png", {
                    frameWidth: 32,
                    frameHeight: 32,
                });

                this.load.spritesheet('coffre1', 'assets/coffreface.png',
                    { frameWidth: 64, frameHeight: 64 });

                
                this.load.image('FondUI', 'assets/fondUI.png');
                this.load.image('fullcoeur', 'assets/fullcoeur.png');
                this.load.image('deuxcoeurs', 'assets/deuxcoeurs.png');
                this.load.image('uncoeur', 'assets/uncoeur.png');

                this.load.bitmapFont(
                    'myfont',
                    'assets/typo.png',
                    'assets/typo.xml'
                );


                this.load.image('container', 'assets/boitedialogue.png');

            }


            create() {
                // chargement de la carte du niveau
                const carteDuNiveau = this.add.tilemap("carteplage");
                // chargement du jeu de tuiles
                const tileset = carteDuNiveau.addTilesetImage(
                    "placeholdernew",
                    "Phaser_Tileset"
                );



                // chargement du calque "calque_backgroung"
                const backgroundLayer = carteDuNiveau.createLayer(
                    "sol",
                    tileset
                );

                // chargement du calque "calque_backgroung"
                const sousblocs = carteDuNiveau.createLayer(
                    "sousblocs",
                    tileset
                );

                // chargement du second calque "calque_backgroung"
                
                const blocsplage = carteDuNiveau.createLayer(
                    "blocs",
                    tileset
                );

                // chargement du second calque "calque_backgroung"
                const arbresplage = carteDuNiveau.createLayer(
                    "arbres",
                    tileset
                );
                
                


               
                

                petit = false
                
                if (sortieP == true){
                    this.player = this.physics.add.sprite(1465, 1200, 'perso');
                }
                else if (sortieP == false) {
                    this.player = this.physics.add.sprite(200, 250, 'perso');
                }
                //taille de la hitbox
                this.player.setSize(32, 32);
                //decaler la hitbox
                this.player.setOffset(0, 15);

                if(obtentionmasque == 1){

                    // chargement du calque "calque_backgroung"
                    const avion = carteDuNiveau.createLayer(
                        "avion",
                        tileset
                    );
                    avion.setCollisionByProperty({ avion: true });

                    this.marchand = this.physics.add.sprite(200,200, 'marchand');
                    this.marchand.setImmovable();
                    this.physics.add.collider(this.player,this.marchand, this.findujeu,null,this);
                    this.anims.create({
                    key: 'chill',
                    frames: this.anims.generateFrameNumbers('marchand', { start: 0, end: 1 }),
                    frameRate: 5,
                    repeat: -1
                });
                this.anims.create({
                    key: 'parle',
                    frames: this.anims.generateFrameNumbers('marchand', { start: 2, end: 3 }),
                    frameRate: 5,
                    repeat: -1
                });
                this.marchand.anims.play('chill', true);
                }
                else if (obtentionmasque == 0){
                    // chargement du calque "calque_backgroung"
                    const avionecraser = carteDuNiveau.createLayer(
                        "avionecraser",
                        tileset
                    );
                    avionecraser.setCollisionByProperty({ solide: true });

                }

                this.anims.create({
                    key: 'left',
                    frames: this.anims.generateFrameNumbers('perso', { start: 0, end: 1 }),
                    frameRate: 10,
                    repeat: -1
                });
                this.anims.create({
                    key: 'turn',
                    frames: [{ key: 'perso', frame: 2 }],
                    frameRate: 20
                });
                this.anims.create({
                    key: 'right',
                    frames: this.anims.generateFrameNumbers('perso', { start: 3, end: 4 }),
                    frameRate: 10,
                    repeat: -1
                });

                this.anims.create({
                    key: 'up',
                    frames: this.anims.generateFrameNumbers('perso', { start: 8, end: 9 }),
                    frameRate: 10,
                    repeat: 1
                });

                this.anims.create({
                    key: 'down',
                    frames: this.anims.generateFrameNumbers('perso', { start: 5, end: 6 }),
                    frameRate: 10,
                    repeat: -1
                });

                blocsplage.setCollisionByProperty({ solide: true });
                arbresplage.setCollisionByProperty({ solide: true });
                sousblocs.setCollisionByProperty({ solide: true });

                

                //chronometre de la fuite laissant au joueur un délai de 3 minutes pour passer a la zone suivante
                if(obtentionmasque == 1){
                    
                    this.earthquack = this.time.addEvent({
                        delay: 1000,
                        callback: ()=>{
                            this.cameras.main.shake(1000,0.01)
                        },
                        loop: true
                    })

                }
               

                this.physics.add.collider(this.player, blocsplage);
                this.physics.add.collider(this.player, sousblocs);
                this.physics.add.collider(this.player, arbresplage);

                this.cursors = this.input.keyboard.createCursorKeys();

                this.zoneattack = this.physics.add.sprite(100, 100, "zoneattack").setInteractive();

                this.physics.add.collider(this.zoneattack, this.virus, this.attackplayer, null, this);

                this.zoneattackL = this.physics.add.sprite(100, 100, "zoneattackL").setInteractive();

                this.physics.add.collider(this.zoneattackL, this.virus, this.attackLplayer, null, this);

                this.zoneattackD = this.physics.add.sprite(100, 100, "zoneattackD").setInteractive();


                this.physics.add.collider(this.zoneattackD, this.virus, this.attackDplayer, null, this);

                this.zoneattackU = this.physics.add.sprite(100, 100, "zoneattackU").setInteractive();

                this.physics.add.collider(this.zoneattackU, this.virus, this.attackUplayer, null, this);

                //hitbox du marteau
                this.marteauR = this.physics.add.sprite(100, 100, "marteauR").setInteractive();

                this.physics.add.collider(this.marteauR, this.boite, this.smash, null, this);

                this.marteauU = this.physics.add.sprite(100, 100, "marteauU").setInteractive();

                this.physics.add.collider(this.marteauU, this.boite, this.smashV, null, this);

                this.marteauL = this.physics.add.sprite(100, 100, "marteauL").setInteractive();

                this.physics.add.collider(this.marteauL, this.boite, this.smashV, null, this);

                this.marteauD = this.physics.add.sprite(100, 100, "marteauD").setInteractive();

                this.physics.add.collider(this.marteauD, this.boite, this.smashV, null, this);

                this.cameras.main.setBounds(0, 0, 2016, 1248);
                this.cameras.main.startFollow(this.player);

                this.entreeplage = this.physics.add.sprite(1700, 1240, "entreeplage").setInteractive();
                this.entreeplage.setImmovable();
                this.entreeplage.setSize(1000, 32);
                this.physics.add.collider(this.entreeplage, this.player, this.tpentreevillage, null, this);


                keyA = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.A);
                keyZ = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.Z);
                keyE = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.E);

                this.add.image(550,290, 'FondUI').setScrollFactor(0);

                
                this.fullcoeur = this.add.image(550,290, 'fullcoeur').setScrollFactor(0);
                this.fullcoeur.visible = false;
                this.deuxcoeurs = this.add.image(550,290, 'deuxcoeurs').setScrollFactor(0);
                this.deuxcoeurs.visible = false;
                this.uncoeur = this.add.image(550,290, 'uncoeur').setScrollFactor(0);
                this.uncoeur.visible = false;
                this.scoreText=this.add.text(115,100,score,{fontSize:'64px',fill:'#FFFFFF',strokeThickness: 6, stroke:'#000000'}).setScrollFactor(0);
                this.scoreText.setText(score); //met à jour l’affichage du score

                if(PV == 3){
                    this.fullcoeur.visible = true;
                }
                else if (PV == 2){
                    this.deuxcoeurs.visible = true;
                }
                else if (PV == 1){
                    this.uncoeur.visible = true;
                }

                //placement des coffres
                this.coffre1 = this.physics.add.sprite(100,650, 'coffre1');
                this.coffre1.setScale(0.75)
                this.physics.add.collider(this.player, this.coffre1,this.collectcoin);
                this.coffre1.setImmovable();
                this.anims.create({
                    key: 'coffreouvert',
                    frames: this.anims.generateFrameNumbers('coffre1', { start: 1, end: 1 }),
                    frameRate: 10,
                    repeat: -1
                });

                this.coffre1 = this.physics.add.sprite(980,475, 'coffre1');
                this.coffre1.setScale(0.75)
                this.physics.add.collider(this.player, this.coffre1,this.collectcoin);
                this.coffre1.setImmovable();

                this.coffre1 = this.physics.add.sprite(1750,450, 'coffre1');
                this.coffre1.setScale(0.75)
                this.physics.add.collider(this.player, this.coffre1,this.collectcoin);
                this.coffre1.setImmovable();

                this.container = this.add.sprite(550, 475, 'container').setScrollFactor(0);
                this.container.alpha = 0.8;
                this.container.visible = false;

                var message = 'Tu as obtenu 20 pieces antiques !';
                this.textObject = this.add.bitmapText(380,470, 'myfont', message, 27).setScrollFactor(0);
                this.textObject.visible = false;

                this.pylone = this.physics.add.sprite(1690, 430, "pylone").setInteractive();
                this.physics.add.collider(this.pylone, this.zoneattack, this.grappin, null, this);
                this.physics.add.collider(this.pylone, this.zoneattackL, this.grappinL, null, this);
                this.physics.add.collider(this.pylone, this.zoneattackU, this.grappinU, null, this);
                this.physics.add.collider(this.pylone, this.zoneattackD, this.grappinD, null, this);

                this.pylone = this.physics.add.sprite(1575, 460, "pylone").setInteractive();
                this.physics.add.collider(this.pylone, this.zoneattack, this.grappin, null, this);
                this.physics.add.collider(this.pylone, this.zoneattackL, this.grappinL, null, this);
                this.physics.add.collider(this.pylone, this.zoneattackU, this.grappinU, null, this);
                this.physics.add.collider(this.pylone, this.zoneattackD, this.grappinD, null, this);

                this.anims.create({
                    key: 'virusactif',
                    frames: this.anims.generateFrameNumbers('virus', { start: 0, end: 1 }),
                    frameRate: 10,
                    repeat: -1
                });

                var startPoint = new Phaser.Math.Vector2(820, 200);
                var controlPoint1 = new Phaser.Math.Vector2(880, 200);
                var controlPoint2 = new Phaser.Math.Vector2(950, 200);
                var endPoint = new Phaser.Math.Vector2(1000, 200);

                var curve = new Phaser.Curves.CubicBezier(startPoint, controlPoint1, controlPoint2, endPoint);

                var graphics = this.add.graphics();



                this.followvirus= this.add.follower(curve, 820, 300, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus);
                this.followvirus.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus,this.degats,null,this);

                this.followvirus.startFollow({
                    duration: 5000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });


                
            }


            findujeu() {
                this.scene.start("ecrandefin")

                }

                grappin(zoneattack, pylone,pylone2) {
                this.player.x = this.pylone.x
                this.player.y = this.pylone.y;

                }

                grappinL(zoneattackL, pylone,pylone2) {
                    this.player.x = this.pylone.x
                    this.player.y = this.pylone.y;

                }
                grappinD(zoneattackD, pylone,pylone2) {
                    this.player.x = this.pylone.x
                    this.player.y = this.pylone.y;

                }
                grappinU(zoneattackU, pylone,pylone2) {
                    this.player.x = this.pylone.x
                    this.player.y = this.pylone.y;

                }
                
                    

            degats(player, virus) {
                

                if (PV == 3){
                    setTimeout(() => {
                        this.player.setOffset(0, 15);
                    }, 1000);
                    this.player.setOffset(5000,5000);
                    player.alpha = 0.5
                    this.serolReset = this.time.addEvent({
                        delay: 1000,
                        callback: ()=>{
                            player.alpha = 1;
                        },
                        loop: false
                    })
                    PV -= 1//si le virus nous touche, on perd un PV
                    console.log("aie")
                    this.deuxcoeurs.visible = true;
                    this.fullcoeur.visible = false;
                    
                } else if (PV == 2){
                    setTimeout(() => {
                        this.player.setOffset(0, 15);
                    }, 1000);
                    this.player.setOffset(5000,5000);
                    player.alpha = 0.5
                    this.serolReset = this.time.addEvent({
                        delay: 1000,
                        callback: ()=>{
                            player.alpha = 1;
                        },
                        loop: false
                    })
                    PV -= 1//si le virus nous touche, on perd un PV
                    console.log("aie2")
                    this.uncoeur.visible = true;
                    this.deuxcoeurs.visible = false;
                    
                } else if (PV == 1){
                    this.scene.start("gameover")
                
                }
            }


                    collectcoin(player,coffre1){ 

                        setTimeout(() => {
                            coffreouvert = false;
                        }, 1000);
                        coffreouvert = true
                        score += 20; //augmente le score de 20
                        coffre1.anims.play('coffreouvert', true)
                        coffre1.setOffset(5000,5000);


                        }





                attackplayer(zoneattack, virus) {
                    PVennemy -= 1;

                }

                attackLplayer(zoneattack, virus) {
                    PVennemy -= 1;

                }

                attackDplayer(zoneattackD, virus) {
                    PVennemy -= 1;

                }

                attackUplayer(zoneattackU, virus) {
                    PVennemy -= 1;

                }

                grappin(zoneattack, pylone) {
                    this.player.x = this.pylone.x
                    this.player.y = this.pylone.y;

                }

                grappinL(zoneattackL, pylone) {
                    this.player.x = this.pylone.x
                    this.player.y = this.pylone.y;

                }
                grappinD(zoneattackD, pylone) {
                    this.player.x = this.pylone.x
                    this.player.y = this.pylone.y;

                }
                grappinU(zoneattackU, pylone) {
                    this.player.x = this.pylone.x
                    this.player.y = this.pylone.y;

                }

                smash(marteau, boite) {
                    this.boite.disableBody(true,true);
                    console.log("ouch")

                }

                smashV(marteauV, boite) {
                    this.boite.disableBody(true,true);
                    console.log("ouch")

                }

            update() {

                if(coffreouvert == true){
                this.container.visible = true;
                this.textObject.visible = true;
               }
               else if (coffreouvert == false){
                this.container.visible = false;
                this.textObject.visible = false;
               }

                this.scoreText.setText(score)


                if (PVennemy == 0) {
                    this.virus.disableBody(true, true)
                }

                if (arret == true) {

                    this.player.setVelocityX(0);
                    this.player.setVelocityY(0);

                }

                //fonction attaque
                if (keyZ.isDown && petit == false && this.cursors.right.isDown && this.obtentionyoyo >= 1) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    this.cursors.right.enabled = false;
                    arret = true
                    this.zoneattack.y = this.player.y
                    this.zoneattack.x = this.player.x + 70
                    setTimeout(() => {
                        this.zoneattack.y = 100
                        this.zoneattack.x = 100
                        arret = false
                        this.cursors.right.enabled = true;
                    }, 400);
                }
                else if (keyZ.isDown && petit == true && this.cursors.right.isDown && this.obtentionyoyo >= 1) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattack.y = this.player.y
                    this.zoneattack.x = this.player.x + 40
                    setTimeout(() => {
                        this.zoneattack.y = 100
                        this.zoneattack.x = 100
                        arret = false
                    }, 400);
                }

                if (keyZ.isDown && petit == false && this.cursors.left.isDown && this.obtentionyoyo >= 1) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattackL.y = this.player.y
                    this.zoneattackL.x = this.player.x - 65
                    setTimeout(() => {
                        this.zoneattackL.y = 100
                        this.zoneattackL.x = 100
                        arret = false
                    }, 400);
                }
                else if (keyZ.isDown && petit == true && this.cursors.left.isDown && this.obtentionyoyo >= 1) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattackL.y = this.player.y
                    this.zoneattackL.x = this.player.x - 30
                    setTimeout(() => {
                        this.zoneattackL.y = 100
                        this.zoneattackL.x = 100
                        arret = false
                    }, 400);
                }

                if (keyZ.isDown && petit == false && this.cursors.down.isDown && this.obtentionyoyo >= 1) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattackD.y = this.player.y + 65
                    this.zoneattackD.x = this.player.x 
                    setTimeout(() => {
                        this.zoneattackD.y = 100
                        this.zoneattackD.x = 100
                        arret = false
                    }, 400);
                }
                else if (keyZ.isDown && petit == true && this.cursors.down.isDown && this.obtentionyoyo >= 1) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattackD.y = this.player.y + 30
                    this.zoneattackD.x = this.player.x 
                    setTimeout(() => {
                        this.zoneattackD.y = 100
                        this.zoneattackD.x = 100
                        arret = false
                    }, 400);
                }

                    if (keyZ.isDown && petit == false && this.cursors.up.isDown && this.obtentionyoyo >= 1) {
                        this.cursors.right.reset();
                        this.cursors.left.reset();
                        this.cursors.up.reset();
                        this.cursors.down.reset();
                        arret = true
                        this.zoneattackU.y = this.player.y - 65
                        this.zoneattackU.x = this.player.x 
                        setTimeout(() => {
                            this.zoneattackU.y = 100
                            this.zoneattackU.x = 100
                            arret = false
                        }, 400);
                        }
                        else if (keyZ.isDown && petit == true && this.cursors.up.isDown && this.obtentionyoyo >= 1) {
                        this.cursors.right.reset();
                        this.cursors.left.reset();
                        this.cursors.up.reset();
                        this.cursors.down.reset();
                        arret = true
                        this.zoneattackU.y = this.player.y - 30
                        this.zoneattackU.x = this.player.x 
                        setTimeout(() => {
                            this.zoneattackU.y = 100
                            this.zoneattackU.x = 100
                            arret = false
                        }, 400);
                    }


                       //fonction marteau
                if (keyE.isDown && petit == false && this.cursors.right.isDown && obtentionmarteau == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    this.cursors.right.enabled = false;
                    arret = true
                    this.marteauR.y = this.player.y + 10
                    this.marteauR.x = this.player.x + 35
                    setTimeout(() => {
                        this.marteauR.y = 100
                        this.marteauR.x = 100
                        arret = false
                        this.cursors.right.enabled = true;
                    }, 400);
                }
                else if (keyE.isDown && petit == true && this.cursors.right.isDown && obtentionmarteau == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauR.y = this.player.y + 5
                    this.marteauR.x = this.player.x + 20
                    setTimeout(() => {
                        this.marteauR.y = 100
                        this.marteauR.x = 100
                        arret = false
                    }, 400);
                }

                if (keyE.isDown && petit == false && this.cursors.left.isDown && obtentionmarteau == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauL.y = this.player.y + 10
                    this.marteauL.x = this.player.x -35
                    setTimeout(() => {
                        this.marteauL.y = 100
                        this.marteauL.x = 100
                        arret = false
                    }, 400);
                }
                else if (keyE.isDown && petit == true && this.cursors.left.isDown && obtentionmarteau == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauL.y = this.player.y + 5
                    this.marteauL.x = this.player.x - 20
                    setTimeout(() => {
                        this.marteauL.y = 100
                        this.marteauL.x = 100
                        arret = false
                    }, 400);
                }

                if (keyE.isDown && petit == false && this.cursors.down.isDown && obtentionmarteau == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauD.y = this.player.y + 40
                    this.marteauD.x = this.player.x 
                    setTimeout(() => {
                        this.marteauD.y = 100
                        this.marteauD.x = 100
                        arret = false
                    }, 400);
                }
                else if (keyE.isDown && petit == true && this.cursors.down.isDown && obtentionmarteau == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauD.y = this.player.y + 20
                    this.marteauD.x = this.player.x 
                    setTimeout(() => {
                        this.marteauD.y = 100
                        this.marteauD.x = 100
                        arret = false
                    }, 400);
                }

                if (keyE.isDown && petit == false && this.cursors.up.isDown && obtentionmarteau == true) {
                        this.cursors.right.reset();
                        this.cursors.left.reset();
                        this.cursors.up.reset();
                        this.cursors.down.reset();
                        arret = true
                        this.marteauU.y = this.player.y - 25
                        this.marteauU.x = this.player.x 
                        setTimeout(() => {
                            this.marteauU.y = 100
                            this.marteauU.x = 100
                            arret = false
                        }, 400);
                        }
                        else if (keyE.isDown && petit == true && this.cursors.up.isDown && obtentionmarteau == true) {
                        this.cursors.right.reset();
                        this.cursors.left.reset();
                        this.cursors.up.reset();
                        this.cursors.down.reset();
                        arret = true
                        this.marteauU.y = this.player.y - 15
                        this.marteauU.x = this.player.x 
                        setTimeout(() => {
                            this.marteauU.y = 100
                            this.marteauU.x = 100
                            arret = false
                        }, 400);
                }

                //fonction minimize
                if (keyA.isDown && petit == false && obtentionmini == true) {
                    this.player.setScale(0.5)
                    this.zoneattack.setScale(0.5)
                    this.zoneattackL.setScale(0.5)
                    this.zoneattackU.setScale(0.5)
                    this.zoneattackD.setScale(0.5)
                    this.marteauR.setScale(0.5)
                    this.marteauL.setScale(0.5)
                    this.marteauD.setScale(0.5)
                    this.marteauU.setScale(0.5)
                    setTimeout(() => {
                        petit = true;

                    }, 200);
                }
                else if (keyA.isDown && petit == true && obtentionmini == true) {
                    this.player.setScale(1)
                    this.zoneattack.setScale(1)
                    this.zoneattackL.setScale(1)
                    this.zoneattackD.setScale(1)
                    this.zoneattackU.setScale(1)
                    this.marteauR.setScale(1)
                    this.marteauU.setScale(1)
                    this.marteauL.setScale(1)
                    this.marteauD.setScale(1)
                    setTimeout(() => {
                        petit = false;

                    }, 200);





                }
                if (this.cursors.left.isDown) { //si la touche gauche est appuyée
                    this.player.setVelocityX(-160); //alors vitesse négative en X
                    this.player.anims.play('left', true); //et animation => gauche
                }
                else if (this.cursors.right.isDown) { //sinon si la touche droite est appuyée
                    this.player.setVelocityX(160); //alors vitesse positive en X
                    this.player.anims.play('right', true); //et animation => droite
                }
                else { // sinon
                    this.player.setVelocityX(0); //vitesse nulle
                    //this.player.anims.play('turn', true); //animation fait face caméra
                    turn = true;
                }

                if (this.cursors.up.isDown) {
                    //si touche haut appuyée ET que le perso touche le sol
                    this.player.setVelocityY(-160); //alors vitesse verticale négative
                    this.player.anims.play('up', true);

                }
                else if (this.cursors.down.isDown) {
                    //si touche haut appuyée ET que le perso touche le sol
                    this.player.setVelocityY(160); //alors vitesse verticale négative
                    this.player.anims.play('down', true);

                }
                else {
                    //si touche haut appuyée ET que le perso touche le sol
                    this.player.setVelocityY(0); //alors vitesse verticale négative
                    if (turn == true) {
                        this.player.anims.play('turn', true); //animation fait face caméra
                        //(on saute)
                    }
                }

                turn = false;

                if (this.gameOver) { return; }

            }

            tpentreevillage(player, entreeplage) {
                    sortieP = true
                    this.scene.start("camp",{
                        sortieP : this.sortieP,
                        PV : this.PV,
                        obtentionmasque : this.obtentionmasque,
                        obtentionyoyo : this.obtentionyoyo,

                    });
                    }


        }















        class niveaumontagne extends Phaser.Scene {


            constructor() {

                super("niveaumontagne")
            }

            init(data) { 
                this.sortieM = data.sortieM;
                this.sortieT = data.sortieT;
                this.chronometre = data.chronometre;
                this.incident = data.incident;
                this.obtentionmasque = data.obtentionmasque;
                this. PV = data.PV;
                this.obtentionyoyo = data.obtentionyoyo
                this.entreefuite = data.entreefuite
                this.sortiefuite = data.sortiefuite
            }


            preload() {
                // chargement tuiles de jeu
                this.load.image("Phaser_Tileset", "assets/placeholdernew.png");

                // chargement de la carte
                this.load.tilemapTiledJSON("cartemontagne", "assets/montagne.json");

                

                this.load.spritesheet('perso', 'assets/protopetit.png',
                    { frameWidth: 32, frameHeight: 48 });

                    this.load.spritesheet("zoneattack", "assets/zoneattack.png", {
                    frameWidth: 96,
                    frameHeight: 48,
                });

                this.load.spritesheet("zoneattackL", "assets/zoneattackL.png", {
                    frameWidth: 96,
                    frameHeight: 48,
                });

                this.load.spritesheet("entreetemple", "assets/entreetemple.png", {
                    frameWidth: 32,
                    frameHeight: 32,
                });

                this.load.spritesheet("zoneattackD", "assets/zoneattackD.png", {
                    frameWidth: 48,
                    frameHeight: 96,
                });

                this.load.spritesheet("zoneattackU", "assets/zoneattackU.png", {
                    frameWidth: 48,
                    frameHeight: 96,
                });

                this.load.spritesheet("marteau", "assets/marteau.png", {
                    frameWidth: 38,
                    frameHeight: 38,
                });

                this.load.spritesheet("pylone", "assets/pylone.png", {
                    frameWidth: 38,
                    frameHeight: 38,
                });

                this.load.spritesheet("boite", "assets/boite.png", {
                    frameWidth: 39,
                    frameHeight: 46,
                });

                this.load.spritesheet("boiteP", "assets/boiteP.png", {
                    frameWidth: 27,
                    frameHeight: 46,
                });

                this.load.spritesheet("marteauV", "assets/marteauV.png", {
                    frameWidth: 38,
                    frameHeight: 38,
                });

                this.load.spritesheet("marteauD", "assets/marteauD.png", {
                    frameWidth: 25,
                    frameHeight: 34,
                });

                this.load.spritesheet("marteauU", "assets/marteauU.png", {
                    frameWidth: 25,
                    frameHeight: 35,
                });

                this.load.spritesheet("marteauL", "assets/marteauL.png", {
                    frameWidth: 40,
                    frameHeight: 25,
                });

                this.load.spritesheet("marteauR", "assets/marteauR.png", {
                    frameWidth: 40,
                    frameHeight: 25,
                });



                this.load.spritesheet("sortiemontagne", "assets/sortiemontagne.png", {
                    frameWidth: 96,
                    frameHeight: 48,
                });

                this.load.image('FondUI', 'assets/fondUI.png');
                this.load.image('fullcoeur', 'assets/fullcoeur.png');
                this.load.image('deuxcoeurs', 'assets/deuxcoeurs.png');
                this.load.image('uncoeur', 'assets/uncoeur.png');
                this.load.image('clefui', 'assets/UIclef.png');

                this.load.spritesheet("virus", "assets/mobile.png", {
                    frameWidth: 32,
                    frameHeight: 32,
                });

                this.load.bitmapFont(
                    'myfont',
                    'assets/typo.png',
                    'assets/typo.xml'
                );


                this.load.image('container', 'assets/boitedialogue.png');
                this.load.image('containermarteau', 'assets/containermarteau.png');
                this.load.image('containerclef', 'assets/containerclef.png');
                this.load.image('containermini', 'assets/containermini.png');

                this.load.spritesheet('coffre1', 'assets/coffreface.png',
                    { frameWidth: 64, frameHeight: 64 });

                this.load.spritesheet('golem', 'assets/spritegolem.png',
                { frameWidth: 54, frameHeight: 137 });

                this.load.spritesheet('piece', 'assets/piece.png',
                    { frameWidth: 32, frameHeight: 32 });

                    this.load.spritesheet("attackgolem", "assets/attackgolem.png", {
                    frameWidth: 32,
                    frameHeight: 32,
                });

                this.load.spritesheet('coffre1', 'assets/coffreface.png',
                    { frameWidth: 64, frameHeight: 64 });

                this.load.spritesheet('porte', 'assets/porte.png',
                { frameWidth: 32, frameHeight: 48 });

                this.load.image('container', 'assets/boitedialogue.png');

            }


            create() {
            
               // chargement de la carte du niveau
               const carteDuNiveau = this.add.tilemap("cartemontagne");
                // chargement du jeu de tuiles
                const tileset = carteDuNiveau.addTilesetImage(
                    "placeholdernew",
                    "Phaser_Tileset"
                );

                

                // chargement du calque "calque_backgroung"
                const backgroundLayer = carteDuNiveau.createLayer(
                    "sol",
                    tileset
                );

                // chargement du calque "calque_backgroung"
                const trous = carteDuNiveau.createLayer(
                    "trou",
                    tileset
                );



                // chargement du second calque "calque_backgroung"
                const blocsmontagne = carteDuNiveau.createLayer(
                    "blocs",
                    tileset
                );

               

                const statues = carteDuNiveau.createLayer(
                    "statues",
                    tileset
                );

                petit = false
                if (sortieT == true){
                    this.player = this.physics.add.sprite(3890, 700, 'perso');
                }
                else if (sortieT == false && entreefuite == false) {
                    this.player = this.physics.add.sprite(140,1050, 'perso');
                    
                }
                else if(entreefuite == true){
                    this.player = this.physics.add.sprite(60,2350, 'perso');
                }
                sortieM = true
                entreefuite == false
                //taille de la hitbox
                this.player.setSize(32, 32);
                //decaler la hitbox
                this.player.setOffset(0, 15);
                this.anims.create({
                    key: 'left',
                    frames: this.anims.generateFrameNumbers('perso', { start: 0, end: 1 }),
                    frameRate: 10,
                    repeat: -1
                });
                this.anims.create({
                    key: 'turn',
                    frames: [{ key: 'perso', frame: 2 }],
                    frameRate: 20
                });
                this.anims.create({
                    key: 'right',
                    frames: this.anims.generateFrameNumbers('perso', { start: 3, end: 4 }),
                    frameRate: 10,
                    repeat: -1
                });

                this.anims.create({
                    key: 'up',
                    frames: this.anims.generateFrameNumbers('perso', { start: 8, end: 9 }),
                    frameRate: 10,
                    repeat: 1
                });

                this.anims.create({
                    key: 'down',
                    frames: this.anims.generateFrameNumbers('perso', { start: 5, end: 6 }),
                    frameRate: 10,
                    repeat: -1
                });

                this.anims.create({
                    key: 'virusactif',
                    frames: this.anims.generateFrameNumbers('virus', { start: 0, end: 1 }),
                    frameRate: 10,
                    repeat: -1
                });


                



                blocsmontagne.setCollisionByProperty({ solide: true });
                statues.setCollisionByProperty({ solide: true });

                trous.setCollisionByProperty({ solide: true });

                this.physics.add.collider(this.player, blocsmontagne);
                this.physics.add.collider(this.player, statues);

                this.physics.add.collider(this.player, trous);

                this.cursors = this.input.keyboard.createCursorKeys();

                this.zoneattack = this.physics.add.sprite(100, 100, "zoneattack").setInteractive();
                this.physics.add.collider(this.zoneattack, this.virus, this.attackplayer, null, this);

                this.zoneattackL = this.physics.add.sprite(100, 100, "zoneattackL").setInteractive();
                this.physics.add.collider(this.zoneattackL, this.virus, this.attackLplayer, null, this);

                this.zoneattackD = this.physics.add.sprite(100, 100, "zoneattackD").setInteractive();
                this.physics.add.collider(this.zoneattackD, this.virus, this.attackDplayer, null, this);

                this.zoneattackU = this.physics.add.sprite(100, 100, "zoneattackU").setInteractive();
                this.physics.add.collider(this.zoneattackU, this.virus, this.attackUplayer, null, this);

                //hitbox du marteau
                this.marteauR = this.physics.add.sprite(100, 100, "marteauR").setInteractive();

                this.physics.add.collider(this.marteauR, this.boite1, this.smash1, null, this);
                this.physics.add.collider(this.marteauR, this.boite2, this.smash2, null, this);
                this.physics.add.collider(this.marteauR, this.boite3, this.smash3, null, this);
                this.physics.add.collider(this.marteauR, this.boite4, this.smash4, null, this);
                this.physics.add.collider(this.marteauR, this.boite5, this.smash5, null, this);
                this.physics.add.collider(this.marteauR, this.boite6, this.smash6, null, this);
                this.physics.add.collider(this.marteauR, this.boite7, this.smash7, null, this);
                this.physics.add.collider(this.marteauR, this.boite8, this.smash8, null, this);
                this.physics.add.collider(this.marteauR, this.boite9, this.smash9, null, this);
                this.physics.add.collider(this.marteauR, this.boite10, this.smash10, null, this);
                this.physics.add.collider(this.marteauR, this.boite11, this.smash11, null, this);
                this.physics.add.collider(this.marteauR, this.boite12, this.smash12, null, this);

                this.marteauU = this.physics.add.sprite(100, 100, "marteauU").setInteractive();
            
                this.physics.add.collider(this.marteauU, this.boite1, this.smash1, null, this);
                this.physics.add.collider(this.marteauU, this.boite2, this.smash2, null, this);
                this.physics.add.collider(this.marteauU, this.boite3, this.smash3, null, this);
                this.physics.add.collider(this.marteauU, this.boite4, this.smash4, null, this);
                this.physics.add.collider(this.marteauU, this.boite5, this.smash5, null, this);
                this.physics.add.collider(this.marteauU, this.boite6, this.smash6, null, this);
                this.physics.add.collider(this.marteauU, this.boite7, this.smash7, null, this);
                this.physics.add.collider(this.marteauU, this.boite8, this.smash8, null, this);
                this.physics.add.collider(this.marteauU, this.boite9, this.smash9, null, this);
                this.physics.add.collider(this.marteauU, this.boite10, this.smash10, null, this);
                this.physics.add.collider(this.marteauU, this.boite11, this.smash11, null, this);
                this.physics.add.collider(this.marteauU, this.boite12, this.smash12, null, this);

                this.marteauL = this.physics.add.sprite(100, 100, "marteauL").setInteractive();

                this.physics.add.collider(this.marteauL, this.boite1, this.smash1, null, this);
                this.physics.add.collider(this.marteauL, this.boite2, this.smash2, null, this);
                this.physics.add.collider(this.marteauL, this.boite3, this.smash3, null, this);
                this.physics.add.collider(this.marteauL, this.boite4, this.smash4, null, this);
                this.physics.add.collider(this.marteauL, this.boite5, this.smash5, null, this);
                this.physics.add.collider(this.marteauL, this.boite6, this.smash6, null, this);
                this.physics.add.collider(this.marteauL, this.boite7, this.smash7, null, this);
                this.physics.add.collider(this.marteauL, this.boite8, this.smash8, null, this);
                this.physics.add.collider(this.marteauL, this.boite9, this.smash9, null, this);
                this.physics.add.collider(this.marteauL, this.boite10, this.smash10, null, this);
                this.physics.add.collider(this.marteauL, this.boite11, this.smash11, null, this);
                this.physics.add.collider(this.marteauL, this.boite12, this.smash12, null, this);

                this.marteauD = this.physics.add.sprite(100, 100, "marteauD").setInteractive();

                this.physics.add.collider(this.marteauD, this.boite1, this.smash1, null, this);
                this.physics.add.collider(this.marteauD, this.boite2, this.smash2, null, this);
                this.physics.add.collider(this.marteauD, this.boite3, this.smash3, null, this);
                this.physics.add.collider(this.marteauD, this.boite4, this.smash4, null, this);
                this.physics.add.collider(this.marteauD, this.boite5, this.smash5, null, this);
                this.physics.add.collider(this.marteauD, this.boite6, this.smash6, null, this);
                this.physics.add.collider(this.marteauD, this.boite7, this.smash7, null, this);
                this.physics.add.collider(this.marteauD, this.boite8, this.smash8, null, this);
                this.physics.add.collider(this.marteauD, this.boite9, this.smash9, null, this);
                this.physics.add.collider(this.marteauD, this.boite10, this.smash10, null, this);
                this.physics.add.collider(this.marteauD, this.boite11, this.smash11, null, this);
                this.physics.add.collider(this.marteauD, this.boite12, this.smash12, null, this);

                this.cameras.main.setBounds(0, 0, 4704, 2576);
                this.cameras.main.startFollow(this.player);

                

                this.sortiemontagne = this.physics.add.sprite(50, 1050, "sortiemontagne").setInteractive();
                this.sortiemontagne.setImmovable();
                this.sortiemontagne.setSize(48, 48);
                this.physics.add.collider(this.sortiemontagne, this.player, this.tpcampM, null, this);

                this.sortiefuitemontagne = this.physics.add.sprite(10, 2350, "sortiemontagne").setInteractive();
                this.sortiefuitemontagne.setImmovable();
                this.sortiefuitemontagne.setSize(10, 48);
                this.physics.add.collider(this.sortiefuitemontagne, this.player, this.tpjunglefuite, null, this);

                this.obtentionyoyo = true
                this.obtentionmasque = 1

                keyA = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.A);
                keyZ = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.Z);
                keyE = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.E);

                if(obtentionmasque == 1){
                    
                    this.earthquack = this.time.addEvent({
                        delay: 1000,
                        callback: ()=>{
                            this.cameras.main.shake(1000,0.01)
                        },
                        loop: true
                    })
                    this.chronometre = this.time.delayedCall(500000, [],null, this);
                    console.log("masque !");
                    const statuesevent = carteDuNiveau.createLayer(
                        "statuesevent",
                        tileset
                    );

                    statuesevent.setCollisionByProperty({ solide: true });
                    this.physics.add.collider(this.player, statuesevent);
                }

                this.add.image(550,290, 'FondUI').setScrollFactor(0);

                
                this.fullcoeur = this.add.image(550,290, 'fullcoeur').setScrollFactor(0);
                this.fullcoeur.visible = false;
                this.deuxcoeurs = this.add.image(550,290, 'deuxcoeurs').setScrollFactor(0);
                this.deuxcoeurs.visible = false;
                this.uncoeur = this.add.image(550,290, 'uncoeur').setScrollFactor(0);
                this.uncoeur.visible = false;
                this.clefui = this.add.image(550,290, 'clefui').setScrollFactor(0);
                this.clefui.visible = false;
                this.scoreText=this.add.text(115,100,score,{fontSize:'64px',fill:'#FFFFFF',strokeThickness: 6, stroke:'#000000'}).setScrollFactor(0);
                this.scoreText.setText(score); //met à jour l’affichage du score

                if(PV == 3){
                    this.fullcoeur.visible = true;
                }
                else if (PV == 2){
                    this.deuxcoeurs.visible = true;
                }
                else if (PV == 1){
                    this.uncoeur.visible = true;
                }

                this.container = this.add.sprite(550, 475, 'container').setScrollFactor(0);
                this.container.alpha = 0.8;
                this.container.visible = false;

                this.containerclef = this.add.sprite(550, 475, 'containerclef').setScrollFactor(0);
                this.containerclef.alpha = 0.8;
                this.containerclef.visible = false;

                var message = 'Tu as obtenu 20 pieces antiques !';
                this.textObject = this.add.bitmapText(380,470, 'myfont', message, 27).setScrollFactor(0);
                this.textObject.visible = false;


                this.containermarteau = this.add.sprite(550, 475, 'containermarteau').setScrollFactor(0);
                this.containermarteau.alpha = 0.8;
                this.containermarteau.visible = false;


                //piece a collecter
                this.piece = this.physics.add.sprite(5000,5000, "piece").setInteractive();
                this.physics.add.collider(this.player,this.piece, this.collectpiece, null, this)



                //placement des boites
                this.boite1 = this.physics.add.sprite(100,2360, "boite").setInteractive();
                this.boite1.setImmovable();
                this.physics.add.collider(this.boite1, this.player);
                this.physics.add.collider(this.boite1, this.marteauR, this.smash1, null, this);
                this.physics.add.collider(this.boite1, this.marteauU, this.smash1, null, this);
                this.physics.add.collider(this.boite1, this.marteauL, this.smash1, null, this);
                this.physics.add.collider(this.boite1, this.marteauD, this.smash1, null, this);

                this.boite2 = this.physics.add.sprite(100,2320, "boite").setInteractive();
                this.boite2.setImmovable();
                this.physics.add.collider(this.boite2, this.player);
                this.physics.add.collider(this.boite2, this.marteauR, this.smash2, null, this);
                this.physics.add.collider(this.boite2, this.marteauU, this.smash2, null, this);
                this.physics.add.collider(this.boite2, this.marteauL, this.smash2, null, this);
                this.physics.add.collider(this.boite2, this.marteauD, this.smash2, null, this);

                this.boite3 = this.physics.add.sprite(150,2320, "boite").setInteractive();
                this.boite3.setImmovable();
                this.physics.add.collider(this.boite3, this.player);
                this.physics.add.collider(this.boite3, this.marteauR, this.smash3, null, this);
                this.physics.add.collider(this.boite3, this.marteauU, this.smash3, null, this);
                this.physics.add.collider(this.boite3, this.marteauL, this.smash3, null, this);
                this.physics.add.collider(this.boite3, this.marteauD, this.smash3, null, this);

                this.boite4 = this.physics.add.sprite(150,2360, "boite").setInteractive();
                this.boite4.setImmovable();
                this.physics.add.collider(this.boite4, this.player);
                this.physics.add.collider(this.boite4, this.marteauR, this.smash4, null, this);
                this.physics.add.collider(this.boite4, this.marteauU, this.smash4, null, this);
                this.physics.add.collider(this.boite4, this.marteauL, this.smash4, null, this);
                this.physics.add.collider(this.boite4, this.marteauD, this.smash4, null, this);

                this.boite5 = this.physics.add.sprite(2020,1710, "boite").setInteractive();
                this.boite5.setImmovable();
                this.physics.add.collider(this.boite5, this.player);
                this.physics.add.collider(this.boite5, this.marteauR, this.smash5, null, this);
                this.physics.add.collider(this.boite5, this.marteauU, this.smash5, null, this);
                this.physics.add.collider(this.boite5, this.marteauL, this.smash5, null, this);
                this.physics.add.collider(this.boite5, this.marteauD, this.smash5, null, this);

                this.boite6 = this.physics.add.sprite(2020,1760, "boite").setInteractive();
                this.boite6.setImmovable();
                this.physics.add.collider(this.boite6, this.player);
                this.physics.add.collider(this.boite6, this.marteauR, this.smash6, null, this);
                this.physics.add.collider(this.boite6, this.marteauU, this.smash6, null, this);
                this.physics.add.collider(this.boite6, this.marteauL, this.smash6, null, this);
                this.physics.add.collider(this.boite6, this.marteauD, this.smash6, null, this);

                this.boite13 = this.physics.add.sprite(2280,1680, "boite").setInteractive();
                this.boite13.setImmovable();
                this.physics.add.collider(this.boite13, this.player);
                this.physics.add.collider(this.boite13, this.marteauR, this.smash13, null, this);
                this.physics.add.collider(this.boite13, this.marteauU, this.smash13, null, this);
                this.physics.add.collider(this.boite13, this.marteauL, this.smash13, null, this);
                this.physics.add.collider(this.boite13, this.marteauD, this.smash13, null, this);

                this.boite7 = this.physics.add.sprite(2340,1680, "boite").setInteractive();
                this.boite7.setImmovable();
                this.physics.add.collider(this.boite7, this.player);
                this.physics.add.collider(this.boite7, this.marteauR, this.smash7, null, this);
                this.physics.add.collider(this.boite7, this.marteauU, this.smash7, null, this);
                this.physics.add.collider(this.boite7, this.marteauL, this.smash7, null, this);
                this.physics.add.collider(this.boite7, this.marteauD, this.smash7, null, this);

                this.boite8 = this.physics.add.sprite(2490,940, "boite").setInteractive();
                this.boite8.setImmovable();
                this.physics.add.collider(this.boite8, this.player);
                this.physics.add.collider(this.boite8, this.marteauR, this.smash8, null, this);
                this.physics.add.collider(this.boite8, this.marteauU, this.smash8, null, this);
                this.physics.add.collider(this.boite8, this.marteauL, this.smash8, null, this);
                this.physics.add.collider(this.boite8, this.marteauD, this.smash8, null, this);

                this.boite9 = this.physics.add.sprite(2535,940, "boite").setInteractive();
                this.boite9.setImmovable();
                this.physics.add.collider(this.boite9, this.player);
                this.physics.add.collider(this.boite9, this.marteauR, this.smash9, null, this);
                this.physics.add.collider(this.boite9, this.marteauU, this.smash9, null, this);
                this.physics.add.collider(this.boite9, this.marteauL, this.smash9, null, this);
                this.physics.add.collider(this.boite9, this.marteauD, this.smash9, null, this);

                this.boite10 = this.physics.add.sprite(2585,940, "boite").setInteractive();
                this.boite10.setImmovable();
                this.physics.add.collider(this.boite10, this.player);
                this.physics.add.collider(this.boite10, this.marteauR, this.smash10, null, this);
                this.physics.add.collider(this.boite10, this.marteauU, this.smash10, null, this);
                this.physics.add.collider(this.boite10, this.marteauL, this.smash10, null, this);
                this.physics.add.collider(this.boite10, this.marteauD, this.smash10, null, this);

                this.boite11 = this.physics.add.sprite(2510,200, "boite").setInteractive();
                this.boite11.setImmovable();
                this.physics.add.collider(this.boite11, this.player);
                this.physics.add.collider(this.boite11, this.marteauR, this.smash11, null, this);
                this.physics.add.collider(this.boite11, this.marteauU, this.smash11, null, this);
                this.physics.add.collider(this.boite11, this.marteauL, this.smash11, null, this);
                this.physics.add.collider(this.boite11, this.marteauD, this.smash11, null, this);

                this.boite12 = this.physics.add.sprite(2565,200, "boite").setInteractive();
                this.boite12.setImmovable();
                this.physics.add.collider(this.boite12, this.player);
                this.physics.add.collider(this.boite12, this.marteauR, this.smash12, null, this);
                this.physics.add.collider(this.boite12, this.marteauU, this.smash12, null, this);
                this.physics.add.collider(this.boite12, this.marteauL, this.smash12, null, this);
                this.physics.add.collider(this.boite12, this.marteauD, this.smash12, null, this);

                


                //placement des pylones
                this.pylone1 = this.physics.add.sprite(1080,400, "pylone").setInteractive();
                this.physics.add.collider(this.pylone1, this.zoneattack, this.grappin1, null, this);
                this.physics.add.collider(this.pylone1, this.zoneattackL, this.grappinL1, null, this);
                this.physics.add.collider(this.pylone1, this.zoneattackU, this.grappinU1, null, this);
                this.physics.add.collider(this.pylone1, this.zoneattackD, this.grappinD1, null, this);

                this.pylone2 = this.physics.add.sprite(960,300, "pylone").setInteractive();
                this.physics.add.collider(this.pylone2, this.zoneattack, this.grappin2, null, this);
                this.physics.add.collider(this.pylone2, this.zoneattackL, this.grappinL2, null, this);
                this.physics.add.collider(this.pylone2, this.zoneattackU, this.grappinU2, null, this);
                this.physics.add.collider(this.pylone2, this.zoneattackD, this.grappinD2, null, this);

                this.pylone3 = this.physics.add.sprite(1200,230, "pylone").setInteractive();
                this.physics.add.collider(this.pylone3, this.zoneattack, this.grappin3, null, this);
                this.physics.add.collider(this.pylone3, this.zoneattackL, this.grappinL3, null, this);
                this.physics.add.collider(this.pylone3, this.zoneattackU, this.grappinU3, null, this);
                this.physics.add.collider(this.pylone3, this.zoneattackD, this.grappinD3, null, this);

                this.pylone4 = this.physics.add.sprite(1100,1700, "pylone").setInteractive();
                this.physics.add.collider(this.pylone4, this.zoneattack, this.grappin4, null, this);
                this.physics.add.collider(this.pylone4, this.zoneattackL, this.grappinL4, null, this);
                this.physics.add.collider(this.pylone4, this.zoneattackU, this.grappinU4, null, this);
                this.physics.add.collider(this.pylone4, this.zoneattackD, this.grappinD4, null, this);

                this.pylone5 = this.physics.add.sprite(1100,1400, "pylone").setInteractive();
                this.physics.add.collider(this.pylone5, this.zoneattack, this.grappin5, null, this);
                this.physics.add.collider(this.pylone5, this.zoneattackL, this.grappinL5, null, this);
                this.physics.add.collider(this.pylone5, this.zoneattackU, this.grappinU5, null, this);
                this.physics.add.collider(this.pylone5, this.zoneattackD, this.grappinD5, null, this);

                this.pylone6 = this.physics.add.sprite(850,1300, "pylone").setInteractive();
                this.physics.add.collider(this.pylone6, this.zoneattack, this.grappin6, null, this);
                this.physics.add.collider(this.pylone6, this.zoneattackL, this.grappinL6, null, this);
                this.physics.add.collider(this.pylone6, this.zoneattackU, this.grappinU6, null, this);
                this.physics.add.collider(this.pylone6, this.zoneattackD, this.grappinD6, null, this);

                this.pylone7 = this.physics.add.sprite(500,1775, "pylone").setInteractive();
                this.physics.add.collider(this.pylone7, this.zoneattack, this.grappin7, null, this);
                this.physics.add.collider(this.pylone7, this.zoneattackL, this.grappinL7, null, this);
                this.physics.add.collider(this.pylone7, this.zoneattackU, this.grappinU7, null, this);
                this.physics.add.collider(this.pylone7, this.zoneattackD, this.grappinD7, null, this);

                this.pylone8 = this.physics.add.sprite(610,1775, "pylone").setInteractive();
                this.physics.add.collider(this.pylone8, this.zoneattack, this.grappin8, null, this);
                this.physics.add.collider(this.pylone8, this.zoneattackL, this.grappinL8, null, this);
                this.physics.add.collider(this.pylone8, this.zoneattackU, this.grappinU8, null, this);
                this.physics.add.collider(this.pylone8, this.zoneattackD, this.grappinD8, null, this);

                this.pylone9 = this.physics.add.sprite(700,1800, "pylone").setInteractive();
                this.physics.add.collider(this.pylone9, this.zoneattack, this.grappin9, null, this);
                this.physics.add.collider(this.pylone9, this.zoneattackL, this.grappinL9, null, this);
                this.physics.add.collider(this.pylone9, this.zoneattackU, this.grappinU9, null, this);
                this.physics.add.collider(this.pylone9, this.zoneattackD, this.grappinD9, null, this);

                this.pylone10 = this.physics.add.sprite(800,1900, "pylone").setInteractive();
                this.physics.add.collider(this.pylone10, this.zoneattack, this.grappin10, null, this);
                this.physics.add.collider(this.pylone10, this.zoneattackL, this.grappinL10, null, this);
                this.physics.add.collider(this.pylone10, this.zoneattackU, this.grappinU10, null, this);
                this.physics.add.collider(this.pylone10, this.zoneattackD, this.grappinD10, null, this);

                this.pylone11 = this.physics.add.sprite(735,1700, "pylone").setInteractive();
                this.physics.add.collider(this.pylone11, this.zoneattack, this.grappin11, null, this);
                this.physics.add.collider(this.pylone11, this.zoneattackL, this.grappinL11, null, this);
                this.physics.add.collider(this.pylone11, this.zoneattackU, this.grappinU11, null, this);
                this.physics.add.collider(this.pylone11, this.zoneattackD, this.grappinD11, null, this);

                this.pylone12 = this.physics.add.sprite(470,1540, "pylone").setInteractive();
                this.physics.add.collider(this.pylone12, this.zoneattack, this.grappin12, null, this);
                this.physics.add.collider(this.pylone12, this.zoneattackL, this.grappinL12, null, this);
                this.physics.add.collider(this.pylone12, this.zoneattackU, this.grappinU12, null, this);
                this.physics.add.collider(this.pylone12, this.zoneattackD, this.grappinD12, null, this);

                this.pylone13 = this.physics.add.sprite(1050,1840, "pylone").setInteractive();
                this.physics.add.collider(this.pylone13, this.zoneattack, this.grappin13, null, this);
                this.physics.add.collider(this.pylone13, this.zoneattackL, this.grappinL13, null, this);
                this.physics.add.collider(this.pylone13, this.zoneattackU, this.grappinU13, null, this);
                this.physics.add.collider(this.pylone13, this.zoneattackD, this.grappinD13, null, this);

                this.pylone14 = this.physics.add.sprite(1050,2250, "pylone").setInteractive();
                this.physics.add.collider(this.pylone14, this.zoneattack, this.grappin14, null, this);
                this.physics.add.collider(this.pylone14, this.zoneattackL, this.grappinL14, null, this);
                this.physics.add.collider(this.pylone14, this.zoneattackU, this.grappinU14, null, this);
                this.physics.add.collider(this.pylone14, this.zoneattackD, this.grappinD14, null, this);

                this.pylone15 = this.physics.add.sprite(980,2330, "pylone").setInteractive();
                this.physics.add.collider(this.pylone15, this.zoneattack, this.grappin15, null, this);
                this.physics.add.collider(this.pylone15, this.zoneattackL, this.grappinL15, null, this);
                this.physics.add.collider(this.pylone15, this.zoneattackU, this.grappinU15, null, this);
                this.physics.add.collider(this.pylone15, this.zoneattackD, this.grappinD15, null, this);

                this.pylone16 = this.physics.add.sprite(900,2200, "pylone").setInteractive();
                this.physics.add.collider(this.pylone16, this.zoneattack, this.grappin16, null, this);
                this.physics.add.collider(this.pylone16, this.zoneattackL, this.grappinL16, null, this);
                this.physics.add.collider(this.pylone16, this.zoneattackU, this.grappinU16, null, this);
                this.physics.add.collider(this.pylone16, this.zoneattackD, this.grappinD16, null, this);

                this.pylone17 = this.physics.add.sprite(800,2200, "pylone").setInteractive();
                this.physics.add.collider(this.pylone17, this.zoneattack, this.grappin17, null, this);
                this.physics.add.collider(this.pylone17, this.zoneattackL, this.grappinL17, null, this);
                this.physics.add.collider(this.pylone17, this.zoneattackU, this.grappinU17, null, this);
                this.physics.add.collider(this.pylone17, this.zoneattackD, this.grappinD17, null, this);

                this.pylone18 = this.physics.add.sprite(2550,1655, "pylone").setInteractive();
                this.physics.add.collider(this.pylone18, this.zoneattack, this.grappin18, null, this);
                this.physics.add.collider(this.pylone18, this.zoneattackL, this.grappinL18, null, this);
                this.physics.add.collider(this.pylone18, this.zoneattackU, this.grappinU18, null, this);
                this.physics.add.collider(this.pylone18, this.zoneattackD, this.grappinD18, null, this);

                

                

                this.pylone21 = this.physics.add.sprite(3170,1650, "pylone").setInteractive();
                this.physics.add.collider(this.pylone21, this.zoneattack, this.grappin21, null, this);
                this.physics.add.collider(this.pylone21, this.zoneattackL, this.grappinL21, null, this);
                this.physics.add.collider(this.pylone21, this.zoneattackU, this.grappinU21, null, this);
                this.physics.add.collider(this.pylone21, this.zoneattackD, this.grappinD21, null, this);

                this.pylone22 = this.physics.add.sprite(3000,1775, "pylone").setInteractive();
                this.physics.add.collider(this.pylone22, this.zoneattack, this.grappin22, null, this);
                this.physics.add.collider(this.pylone22, this.zoneattackL, this.grappinL22, null, this);
                this.physics.add.collider(this.pylone22, this.zoneattackU, this.grappinU22, null, this);
                this.physics.add.collider(this.pylone22, this.zoneattackD, this.grappinD22, null, this);

                this.pylone23 = this.physics.add.sprite(3030,1880, "pylone").setInteractive();
                this.physics.add.collider(this.pylone23, this.zoneattack, this.grappin23, null, this);
                this.physics.add.collider(this.pylone23, this.zoneattackL, this.grappinL23, null, this);
                this.physics.add.collider(this.pylone23, this.zoneattackU, this.grappinU23, null, this);
                this.physics.add.collider(this.pylone23, this.zoneattackD, this.grappinD23, null, this);

                this.pylone24 = this.physics.add.sprite(3100,1930, "pylone").setInteractive();
                this.physics.add.collider(this.pylone24, this.zoneattack, this.grappin24, null, this);
                this.physics.add.collider(this.pylone24, this.zoneattackL, this.grappinL24, null, this);
                this.physics.add.collider(this.pylone24, this.zoneattackU, this.grappinU24, null, this);
                this.physics.add.collider(this.pylone24, this.zoneattackD, this.grappinD24, null, this);

                this.pylone25 = this.physics.add.sprite(3200,1770, "pylone").setInteractive();
                this.physics.add.collider(this.pylone25, this.zoneattack, this.grappin25, null, this);
                this.physics.add.collider(this.pylone25, this.zoneattackL, this.grappinL25, null, this);
                this.physics.add.collider(this.pylone25, this.zoneattackU, this.grappinU25, null, this);
                this.physics.add.collider(this.pylone25, this.zoneattackD, this.grappinD25, null, this);

                this.pylone26 = this.physics.add.sprite(180,1760, "pylone").setInteractive();
                this.physics.add.collider(this.pylone26, this.zoneattack, this.grappin26, null, this);
                this.physics.add.collider(this.pylone26, this.zoneattackL, this.grappinL26, null, this);
                this.physics.add.collider(this.pylone26, this.zoneattackU, this.grappinU26, null, this);
                this.physics.add.collider(this.pylone26, this.zoneattackD, this.grappinD26, null, this);

                this.pylone27 = this.physics.add.sprite(259,1700, "pylone").setInteractive();
                this.physics.add.collider(this.pylone27, this.zoneattack, this.grappin27, null, this);
                this.physics.add.collider(this.pylone27, this.zoneattackL, this.grappinL27, null, this);
                this.physics.add.collider(this.pylone27, this.zoneattackU, this.grappinU27, null, this);
                this.physics.add.collider(this.pylone27, this.zoneattackD, this.grappinD27, null, this);

                this.pylone28 = this.physics.add.sprite(560,1540, "pylone").setInteractive();
                this.physics.add.collider(this.pylone28, this.zoneattack, this.grappin28, null, this);
                this.physics.add.collider(this.pylone28, this.zoneattackL, this.grappinL28, null, this);
                this.physics.add.collider(this.pylone28, this.zoneattackU, this.grappinU28, null, this);
                this.physics.add.collider(this.pylone28, this.zoneattackD, this.grappinD28, null, this);

                this.pylone20 = this.physics.add.sprite(2630,1600, "pylone").setInteractive();
                this.physics.add.collider(this.pylone20, this.zoneattack, this.grappin20, null, this);
                this.physics.add.collider(this.pylone20, this.zoneattackL, this.grappinL20, null, this);
                this.physics.add.collider(this.pylone20, this.zoneattackU, this.grappinU20, null, this);
                this.physics.add.collider(this.pylone20, this.zoneattackD, this.grappinD20, null, this);

                //placement d'ennemis

                var startPoint = new Phaser.Math.Vector2(800, 630);
                var controlPoint1 = new Phaser.Math.Vector2(1000, 630);
                var controlPoint2 = new Phaser.Math.Vector2(1210, 630);
                var endPoint = new Phaser.Math.Vector2(1210, 630);

                var curve = new Phaser.Curves.CubicBezier(startPoint, controlPoint1, controlPoint2, endPoint);

                var graphics = this.add.graphics();



                this.followvirus1= this.add.follower(curve, 500, 575, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus1);
                this.followvirus1.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus1.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus1.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus1,this.degats,null,this);

                this.followvirus1.startFollow({
                    duration: 5000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });


                var startPoint2 = new Phaser.Math.Vector2(800, 630);
                var controlPoint12 = new Phaser.Math.Vector2(850, 630);
                var controlPoint22 = new Phaser.Math.Vector2(900, 630);
                var endPoint2 = new Phaser.Math.Vector2(950, 630);

                var curve2 = new Phaser.Curves.CubicBezier(startPoint2, controlPoint12, controlPoint22, endPoint2);

                var graphics = this.add.graphics();



                this.followvirus2= this.add.follower(curve2, 1000, 300, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus2);
                this.followvirus2.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus2.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus2.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus2,this.degats,null,this);

                this.followvirus2.startFollow({
                    duration: 1000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });

                this.followvirus3= this.add.follower(curve2, 1790, 1400, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus3);
                this.followvirus3.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus3.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus3.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus3,this.degats,null,this);

                this.followvirus3.startFollow({
                    duration: 1000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });

                this.followvirus4= this.add.follower(curve2, 700, 1400, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus4);
                this.followvirus4.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus4.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus4.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus4,this.degats,null,this);

                this.followvirus4.startFollow({
                    duration: 1000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });

                this.followvirus5= this.add.follower(curve2, 600, 1470, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus5);
                this.followvirus5.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus5.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus5.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus5,this.degats,null,this);

                this.followvirus5.startFollow({
                    duration: 1000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });


                var startPoint3 = new Phaser.Math.Vector2(800, 600);
                var controlPoint13 = new Phaser.Math.Vector2(800, 650);
                var controlPoint23 = new Phaser.Math.Vector2(800, 710);
                var endPoint3 = new Phaser.Math.Vector2(800, 790);

                var curve3 = new Phaser.Curves.CubicBezier(startPoint3, controlPoint13, controlPoint23, endPoint3);

                var graphics = this.add.graphics();



                this.followvirus6= this.add.follower(curve3, 2000, 1220, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus6);
                this.followvirus6.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus6.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus6.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus6,this.degats,null,this);

                this.followvirus6.startFollow({
                    duration: 1000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });

                this.followvirus7= this.add.follower(curve3, 1500, 800, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus7);
                this.followvirus7.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus7.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus7.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus7,this.degats,null,this);

                this.followvirus7.startFollow({
                    duration: 1000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });

                this.followvirus8= this.add.follower(curve3, 1300, 900, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus8);
                this.followvirus8.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus8.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus8.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus8,this.degats,null,this);

                this.followvirus8.startFollow({
                    duration: 1000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });

                this.followvirus9= this.add.follower(curve3, 1100, 1100, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus9);
                this.followvirus9.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus9.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus9.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus9,this.degats,null,this);

                this.followvirus9.startFollow({
                    duration: 1000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });

                this.followvirus10= this.add.follower(curve3, 1000, 1200, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus10);
                this.followvirus10.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus10.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus10.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus10,this.degats,null,this);

                this.followvirus10.startFollow({
                    duration: 1000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });

                this.followvirus11= this.add.follower(curve3, 1000, 1500, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus11);
                this.followvirus11.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus11.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus11.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus11,this.degats,null,this);

                this.followvirus11.startFollow({
                    duration: 1000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });


                //placement des golems

                this.anims.create({
                    key: 'animgolem',
                    frames: this.anims.generateFrameNumbers('golem', { start: 0, end: 10 }),
                    frameRate: 10,
                    repeat: -1
                });
                this.anims.create({
                    key: 'eteintgolem',
                    frames: this.anims.generateFrameNumbers('golem', { start: 0, end: 0 }),
                    frameRate: 10,
                    repeat: -1
                });


                this.golem1 = this.physics.add.sprite(250, 200, "golem").setInteractive();
                this.golem1.setSize(54, 100);
                //decaler la hitbox
                this.golem1.setOffset(0, - 5);
                this.physics.add.collider(this.player, this.golem1);
                this.golem1.setImmovable();
                //this.golem.anims.play('animgolem', true);
                this.attackgolem1 = this.physics.add.sprite(800, 400, "attackgolem").setInteractive();
                this.attackgolem1.setImmovable();
                this.attackgolem1.x =this.golem1.x
                this.attackgolem1.y =this.golem1.y
                this.physics.add.collider(this.player, this.attackgolem1,this.degats,null,this);
                this.detectgolem1 = this.physics.add.sprite(800, 475, "attackgolem").setInteractive();
                this.detectgolem1.x =this.golem1.x
                this.detectgolem1.y =this.golem1.y + 75
                this.detectgolem1.setImmovable();
                this.physics.add.collider(this.player, this.detectgolem1,this.allumage1,null,this);

                this.golem2 = this.physics.add.sprite(1000, 800, "golem").setInteractive();
                this.golem2.setSize(54, 100);
                //decaler la hitbox
                this.golem2.setOffset(0, - 5);
                this.physics.add.collider(this.player, this.golem);
                this.golem2.setImmovable();
                //this.golem.anims.play('animgolem', true);
                this.attackgolem2 = this.physics.add.sprite(800, 400, "attackgolem").setInteractive();
                this.attackgolem2.setImmovable();
                this.attackgolem2.x =this.golem2.x
                this.attackgolem2.y =this.golem2.y
                this.physics.add.collider(this.player, this.attackgolem2,this.degats,null,this);
                this.detectgolem2 = this.physics.add.sprite(800, 475, "attackgolem").setInteractive();
                this.detectgolem2.x =this.golem2.x
                this.detectgolem2.y =this.golem2.y + 75
                this.detectgolem2.setImmovable();
                this.physics.add.collider(this.player, this.detectgolem2,this.allumage2,null,this);

                this.golem3 = this.physics.add.sprite(2000, 810, "golem").setInteractive();
                this.golem3.setSize(54, 100);
                //decaler la hitbox
                this.golem3.setOffset(0, - 5);
                this.physics.add.collider(this.player, this.golem);
                this.golem3.setImmovable();
                //this.golem.anims.play('animgolem', true);
                this.attackgolem3 = this.physics.add.sprite(800, 400, "attackgolem").setInteractive();
                this.attackgolem3.setImmovable();
                this.attackgolem3.x =this.golem3.x
                this.attackgolem3.y =this.golem3.y
                this.physics.add.collider(this.player, this.attackgolem3,this.degats,null,this);
                this.detectgolem3 = this.physics.add.sprite(800, 475, "attackgolem").setInteractive();
                this.detectgolem3.x =this.golem3.x
                this.detectgolem3.y =this.golem3.y + 75
                this.detectgolem3.setImmovable();
                this.physics.add.collider(this.player, this.detectgolem3,this.allumage3,null,this);

                this.golem4 = this.physics.add.sprite(2500, 700, "golem").setInteractive();
                this.golem4.setSize(54, 100);
                //decaler la hitbox
                this.golem4.setOffset(0, - 5);
                this.physics.add.collider(this.player, this.golem4);
                this.golem4.setImmovable();
                //this.golem.anims.play('animgolem', true);
                this.attackgolem4 = this.physics.add.sprite(800, 400, "attackgolem").setInteractive();
                this.attackgolem4.setImmovable();
                this.attackgolem4.x =this.golem4.x
                this.attackgolem4.y =this.golem4.y
                this.physics.add.collider(this.player, this.attackgolem4,this.degats,null,this);
                this.detectgolem4 = this.physics.add.sprite(800, 475, "attackgolem").setInteractive();
                this.detectgolem4.x =this.golem4.x
                this.detectgolem4.y =this.golem4.y + 75
                this.detectgolem4.setImmovable();
                this.physics.add.collider(this.player, this.detectgolem4,this.allumage4,null,this);

                this.golem5 = this.physics.add.sprite(2570, 500, "golem").setInteractive();
                this.golem5.setSize(54, 100);
                //decaler la hitbox
                this.golem5.setOffset(0, - 5);
                this.physics.add.collider(this.player, this.golem5);
                this.golem5.setImmovable();
                //this.golem.anims.play('animgolem', true);
                this.attackgolem5 = this.physics.add.sprite(800, 400, "attackgolem").setInteractive();
                this.attackgolem5.setImmovable();
                this.attackgolem5.x =this.golem5.x
                this.attackgolem5.y =this.golem5.y
                this.physics.add.collider(this.player, this.attackgolem5,this.degats,null,this);
                this.detectgolem5 = this.physics.add.sprite(800, 475, "attackgolem").setInteractive();
                this.detectgolem5.x =this.golem5.x
                this.detectgolem5.y =this.golem5.y + 75
                this.detectgolem5.setImmovable();
                this.physics.add.collider(this.player, this.detectgolem5,this.allumage5,null,this);

                this.golem6 = this.physics.add.sprite(2469, 1525, "golem").setInteractive();
                this.golem6.setSize(54, 100);
                //decaler la hitbox
                this.golem6.setOffset(0, - 5);
                this.physics.add.collider(this.player, this.golem6);
                this.golem6.setImmovable();
                //this.golem.anims.play('animgolem', true);
                this.attackgolem6 = this.physics.add.sprite(800, 400, "attackgolem").setInteractive();
                this.attackgolem6.setImmovable();
                this.attackgolem6.x =this.golem6.x
                this.attackgolem6.y =this.golem6.y
                this.physics.add.collider(this.player, this.attackgolem6,this.degats,null,this);
                this.detectgolem6 = this.physics.add.sprite(800, 475, "attackgolem").setInteractive();
                this.detectgolem6.x =this.golem6.x
                this.detectgolem6.y =this.golem6.y + 75
                this.detectgolem6.setImmovable();
                this.physics.add.collider(this.player, this.detectgolem6,this.allumage6,null,this);

                this.golem7 = this.physics.add.sprite(2200, 1690, "golem").setInteractive();
                this.golem7.setSize(54, 100);
                //decaler la hitbox
                this.golem7.setOffset(0, - 5);
                this.physics.add.collider(this.player, this.golem7);
                this.golem7.setImmovable();
                //this.golem.anims.play('animgolem', true);
                this.attackgolem7 = this.physics.add.sprite(800, 400, "attackgolem").setInteractive();
                this.attackgolem7.setImmovable();
                this.attackgolem7.x =this.golem7.x
                this.attackgolem7.y =this.golem7.y
                this.physics.add.collider(this.player, this.attackgolem,this.degats,null,this);
                this.detectgolem7 = this.physics.add.sprite(800, 475, "attackgolem").setInteractive();
                this.detectgolem7.x =this.golem7.x
                this.detectgolem7.y =this.golem7.y + 75
                this.detectgolem7.setImmovable();
                this.physics.add.collider(this.player, this.detectgolem7,this.allumage7,null,this);

                this.golem8 = this.physics.add.sprite(1650, 1750, "golem").setInteractive();
                this.golem8.setSize(54, 100);
                //decaler la hitbox
                this.golem8.setOffset(0, - 5);
                this.physics.add.collider(this.player, this.golem8);
                this.golem8.setImmovable();
                //this.golem.anims.play('animgolem', true);
                this.attackgolem8 = this.physics.add.sprite(800, 400, "attackgolem").setInteractive();
                this.attackgolem8.setImmovable();
                this.attackgolem8.x =this.golem8.x
                this.attackgolem8.y =this.golem8.y
                this.physics.add.collider(this.player, this.attackgolem8,this.degats,null,this);
                this.detectgolem8 = this.physics.add.sprite(800, 475, "attackgolem").setInteractive();
                this.detectgolem8.x =this.golem8.x
                this.detectgolem8.y =this.golem8.y + 75
                this.detectgolem8.setImmovable();
                this.physics.add.collider(this.player, this.detectgolem8,this.allumage8,null,this);

                this.golem9 = this.physics.add.sprite(200, 1880, "golem").setInteractive();
                this.golem9.setSize(54, 100);
                //decaler la hitbox
                this.golem9.setOffset(0, - 5);
                this.physics.add.collider(this.player, this.golem9);
                this.golem9.setImmovable();
                //this.golem.anims.play('animgolem', true);
                this.attackgolem9 = this.physics.add.sprite(800, 400, "attackgolem").setInteractive();
                this.attackgolem9.setImmovable();
                this.attackgolem9.x =this.golem9.x
                this.attackgolem9.y =this.golem9.y
                this.physics.add.collider(this.player, this.attackgolem9,this.degats,null,this);
                this.detectgolem9 = this.physics.add.sprite(800, 475, "attackgolem").setInteractive();
                this.detectgolem9.x =this.golem9.x
                this.detectgolem9.y =this.golem9.y + 75
                this.detectgolem9.setImmovable();
                this.physics.add.collider(this.player, this.detectgolem9,this.allumage9,null,this);

                this.golem10 = this.physics.add.sprite(2840, 1600, "golem").setInteractive();
                this.golem10.setSize(54, 100);
                //decaler la hitbox
                this.golem10.setOffset(0, - 5);
                this.physics.add.collider(this.player, this.golem10);
                this.golem10.setImmovable();
                //this.golem.anims.play('animgolem', true);
                this.attackgolem10 = this.physics.add.sprite(800, 400, "attackgolem").setInteractive();
                this.attackgolem10.setImmovable();
                this.attackgolem10.x =this.golem10.x
                this.attackgolem10.y =this.golem10.y
                this.physics.add.collider(this.player, this.attackgolem10,this.degats,null,this);
                this.detectgolem10 = this.physics.add.sprite(800, 475, "attackgolem").setInteractive();
                this.detectgolem10.x =this.golem10.x
                this.detectgolem10.y =this.golem10.y + 75
                this.detectgolem10.setImmovable();
                this.physics.add.collider(this.player, this.detectgolem10,this.allumage10,null,this);

                this.golem11 = this.physics.add.sprite(3400, 1660, "golem").setInteractive();
                this.golem11.setSize(54, 100);
                //decaler la hitbox
                this.golem11.setOffset(0, - 5);
                this.physics.add.collider(this.player, this.golem11);
                this.golem11.setImmovable();
                //this.golem.anims.play('animgolem', true);
                this.attackgolem11 = this.physics.add.sprite(800, 400, "attackgolem").setInteractive();
                this.attackgolem11.setImmovable();
                this.attackgolem11.x =this.golem11.x
                this.attackgolem11.y =this.golem11.y
                this.physics.add.collider(this.player, this.attackgolem11,this.degats,null,this);
                this.detectgolem11 = this.physics.add.sprite(800, 475, "attackgolem").setInteractive();
                this.detectgolem11.x =this.golem11.x
                this.detectgolem11.y =this.golem11.y + 75
                this.detectgolem11.setImmovable();
                this.physics.add.collider(this.player, this.detectgolem11,this.allumage11,null,this);

                this.golem12 = this.physics.add.sprite(3600, 1400, "golem").setInteractive();
                this.golem12.setSize(54, 100);
                //decaler la hitbox
                this.golem12.setOffset(0, - 5);
                this.physics.add.collider(this.player, this.golem12);
                this.golem12.setImmovable();
                //this.golem.anims.play('animgolem', true);
                this.attackgolem12 = this.physics.add.sprite(800, 400, "attackgolem").setInteractive();
                this.attackgolem12.setImmovable();
                this.attackgolem12.x =this.golem12.x
                this.attackgolem12.y =this.golem12.y
                this.physics.add.collider(this.player, this.attackgolem12,this.degats,null,this);
                this.detectgolem12 = this.physics.add.sprite(800, 475, "attackgolem").setInteractive();
                this.detectgolem12.x =this.golem12.x
                this.detectgolem12.y =this.golem12.y + 75
                this.detectgolem12.setImmovable();
                this.physics.add.collider(this.player, this.detectgolem12,this.allumage12,null,this);

                this.golem13 = this.physics.add.sprite(1500, 2270, "golem").setInteractive();
                this.golem13.setSize(54, 100);
                //decaler la hitbox
                this.golem13.setOffset(0, - 5);
                this.physics.add.collider(this.player, this.golem13);
                this.golem13.setImmovable();
                //this.golem.anims.play('animgolem', true);
                this.attackgolem13 = this.physics.add.sprite(800, 400, "attackgolem").setInteractive();
                this.attackgolem13.setImmovable();
                this.attackgolem13.x =this.golem13.x
                this.attackgolem13.y =this.golem13.y
                this.physics.add.collider(this.player, this.attackgolem13,this.degats,null,this);
                this.detectgolem13 = this.physics.add.sprite(800, 475, "attackgolem").setInteractive();
                this.detectgolem13.x =this.golem13.x
                this.detectgolem13.y =this.golem13.y + 75
                this.detectgolem13.setImmovable();
                this.physics.add.collider(this.player, this.detectgolem13,this.allumage13,null,this);

                this.golem14 = this.physics.add.sprite(1590, 2270, "golem").setInteractive();
                this.golem14.setSize(54, 100);
                //decaler la hitbox
                this.golem14.setOffset(0, - 5);
                this.physics.add.collider(this.player, this.golem14);
                this.golem14.setImmovable();
                //this.golem.anims.play('animgolem', true);
                this.attackgolem14 = this.physics.add.sprite(800, 400, "attackgolem").setInteractive();
                this.attackgolem14.setImmovable();
                this.attackgolem14.x =this.golem14.x
                this.attackgolem14.y =this.golem14.y
                this.physics.add.collider(this.player, this.attackgolem14,this.degats,null,this);
                this.detectgolem14 = this.physics.add.sprite(800, 475, "attackgolem").setInteractive();
                this.detectgolem14.x =this.golem14.x
                this.detectgolem14.y =this.golem14.y + 75
                this.detectgolem14.setImmovable();
                this.physics.add.collider(this.player, this.detectgolem14,this.allumage14,null,this);

                //placement des coffres
                this.anims.create({
                    key: 'coffreouvert',
                    frames: this.anims.generateFrameNumbers('coffre1', { start: 1, end: 1 }),
                    frameRate: 10,
                    repeat: -1
                });
                this.coffre1 = this.physics.add.sprite(1000, 175, 'coffre1');
                this.coffre1.setScale(0.75)
                this.physics.add.collider(this.player, this.coffre1,this.collectcoin);
                this.coffre1.setImmovable();

                this.coffre1 = this.physics.add.sprite(980, 1100, 'coffre1');
                this.coffre1.setScale(0.75)
                this.physics.add.collider(this.player, this.coffre1,this.collectcoin);
                this.coffre1.setImmovable();

                this.coffre1 = this.physics.add.sprite(170, 1370, 'coffre1');
                this.coffre1.setScale(0.75)
                this.physics.add.collider(this.player, this.coffre1,this.collectcoin);
                this.coffre1.setImmovable();

                this.coffre1 = this.physics.add.sprite(180, 1690, 'coffre1');
                this.coffre1.setScale(0.75)
                this.physics.add.collider(this.player, this.coffre1,this.collectcoin);
                this.coffre1.setImmovable();

                this.coffre1 = this.physics.add.sprite(450, 1480, 'coffre1');
                this.coffre1.setScale(0.75)
                this.physics.add.collider(this.player, this.coffre1,this.collectcoin);
                this.coffre1.setImmovable();

                this.coffre1 = this.physics.add.sprite(450, 1480, 'coffre1');
                this.coffre1.setScale(0.75)
                this.physics.add.collider(this.player, this.coffre1,this.collectcoin);
                this.coffre1.setImmovable();

                this.coffre1 = this.physics.add.sprite(2460, 100, 'coffre1');
                this.coffre1.setScale(0.75)
                this.physics.add.collider(this.player, this.coffre1,this.collectmarteau);
                this.coffre1.setImmovable();


                this.coffre1 = this.physics.add.sprite(3330,2160, 'coffre1');
                this.coffre1.setScale(0.75)
                this.physics.add.collider(this.player, this.coffre1,this.coffreclef);
                this.coffre1.setImmovable();
                
                
                
                //placement de la porte
                if(obtentionmasque == 0){
                    this.porte = this.physics.add.sprite(3889,1000, "porte").setInteractive();
                    this.physics.add.collider(this.player, this.porte, this.ouvreporte, null, this);
                    this.porte.setImmovable();

                    this.entreetemple = this.physics.add.sprite(3890, 558, "entreetemple").setInteractive();
                    this.entreetemple.setImmovable();
                    this.entreetemple.setSize(96, 96);
                    this.physics.add.collider(this.entreetemple, this.player, this.tpentreetemple, null, this);
                }

                


                this.physics.add.collider(this.zoneattack, this.followvirus1, this.attackplayer1, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus2, this.attackplayer2, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus3, this.attackplayer3, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus4, this.attackplayer4, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus5, this.attackplayer5, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus6, this.attackplayer6, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus7, this.attackplayer7, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus8, this.attackplayer8, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus9, this.attackplayer9, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus10, this.attackplayer10, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus11, this.attackplayer11, null, this);






                this.physics.add.collider(this.zoneattackL, this.followvirus1, this.attackLplayer1, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus2, this.attackLplayer2, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus3, this.attackLplayer3, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus4, this.attackLplayer4, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus5, this.attackLplayer5, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus6, this.attackLplayer6, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus8, this.attackLplayer7, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus9, this.attackLplayer9, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus10, this.attackLplayer10, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus11, this.attackLplayer11, null, this);



                this.physics.add.collider(this.zoneattackD, this.followvirus1, this.attackDplayer1, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus2, this.attackDplayer2, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus3, this.attackDplayer3, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus3, this.attackDplayer3, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus4, this.attackDplayer4, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus5, this.attackDplayer5, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus6, this.attackDplayer6, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus7, this.attackDplayer7, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus8, this.attackDplayer8, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus9, this.attackDplayer9, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus10, this.attackDplayer10, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus11, this.attackDplayer11, null, this);


                this.physics.add.collider(this.zoneattackU, this.followvirus1, this.attackUplayer1, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus2, this.attackUplayer2, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus3, this.attackUplayer3, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus4, this.attackUplayer4, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus5, this.attackUplayer5, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus6, this.attackUplayer6, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus7, this.attackUplayer7, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus8, this.attackUplayer8, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus9, this.attackUplayer9, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus10, this.attackUplayer10, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus11, this.attackUplayer11, null, this);



            }

            

            collectpiece(player,piece){ 
                piece.x = 5000
                piece.y = 5000

                score += 2; //augmente le score de 20

            }


            allumage1(){ 
                //donne un délai a l'attaque pur que le joueur esquive
                setTimeout(() => {
                    this.attackgolem1.x=this.golem1.x
                    this.attackgolem1.y=this.golem1.y+70
                    }, 1000);
                this.golem1.anims.play('animgolem', true)
                //le détecteur disparait le temps de l'attaque
                this.detectgolem1.x=5000
                this.detectgolem1.y=5000

                setTimeout(() => {
                    //Tout les blocs reviennent a leur position, le golem s'éteint
                    this.detectgolem1.x=this.golem1.x
                    this.detectgolem1.y=this.golem1.y+75
                    this.attackgolem1.x=this.golem1.x
                    this.attackgolem1.y=this.golem1.y
                    this.golem1.anims.play('eteintgolem', true)
                    }, 1200);

            }


            allumage2(){ 
                //donne un délai a l'attaque pur que le joueur esquive
                setTimeout(() => {
                    this.attackgolem2.x=this.golem2.x
                    this.attackgolem2.y=this.golem2.y+70
                    }, 1000);
                this.golem2.anims.play('animgolem', true)
                //le détecteur disparait le temps de l'attaque
                this.detectgolem2.x=5000
                this.detectgolem2.y=5000

                setTimeout(() => {
                    //Tout les blocs reviennent a leur position, le golem s'éteint
                    this.detectgolem2.x=this.golem2.x
                    this.detectgolem2.y=this.golem2.y+75
                    this.attackgolem2.x=this.golem2.x
                    this.attackgolem2.y=this.golem2.y
                    this.golem2.anims.play('eteintgolem', true)
                    }, 1200);

            }

            allumage3(){ 
                //donne un délai a l'attaque pur que le joueur esquive
                setTimeout(() => {
                    this.attackgolem3.x=this.golem3.x
                    this.attackgolem3.y=this.golem3.y+70
                    }, 1000);
                this.golem3.anims.play('animgolem', true)
                //le détecteur disparait le temps de l'attaque
                this.detectgolem3.x=5000
                this.detectgolem3.y=5000

                setTimeout(() => {
                    //Tout les blocs reviennent a leur position, le golem s'éteint
                    this.detectgolem3.x=this.golem3.x
                    this.detectgolem3.y=this.golem3.y+75
                    this.attackgolem3.x=this.golem3.x
                    this.attackgolem3.y=this.golem3.y
                    this.golem3.anims.play('eteintgolem', true)
                    }, 1200);

            }

            allumage4(){ 
                //donne un délai a l'attaque pur que le joueur esquive
                setTimeout(() => {
                    this.attackgolem4.x=this.golem4.x
                    this.attackgolem4.y=this.golem4.y+70
                    }, 1000);
                this.golem4.anims.play('animgolem', true)
                //le détecteur disparait le temps de l'attaque
                this.detectgolem4.x=5000
                this.detectgolem4.y=5000

                setTimeout(() => {
                    //Tout les blocs reviennent a leur position, le golem s'éteint
                    this.detectgolem4.x=this.golem4.x
                    this.detectgolem4.y=this.golem4.y+75
                    this.attackgolem4.x=this.golem4.x
                    this.attackgolem4.y=this.golem4.y
                    this.golem4.anims.play('eteintgolem', true)
                    }, 1200);

            }

            allumage5(){ 
                //donne un délai a l'attaque pur que le joueur esquive
                setTimeout(() => {
                    this.attackgolem5.x=this.golem5.x
                    this.attackgolem5.y=this.golem5.y+70
                    }, 1000);
                this.golem5.anims.play('animgolem', true)
                //le détecteur disparait le temps de l'attaque
                this.detectgolem5.x=5000
                this.detectgolem5.y=5000

                setTimeout(() => {
                    //Tout les blocs reviennent a leur position, le golem s'éteint
                    this.detectgolem5.x=this.golem5.x
                    this.detectgolem5.y=this.golem5.y+75
                    this.attackgolem.x=this.golem5.x
                    this.attackgolem5.y=this.golem5.y
                    this.golem5.anims.play('eteintgolem', true)
                    }, 1200);

            }

            allumage6(){ 
                //donne un délai a l'attaque pur que le joueur esquive
                setTimeout(() => {
                    this.attackgolem6.x=this.golem6.x
                    this.attackgolem6.y=this.golem6.y+70
                    }, 1000);
                this.golem6.anims.play('animgolem', true)
                //le détecteur disparait le temps de l'attaque
                this.detectgolem6.x=5000
                this.detectgolem6.y=5000

                setTimeout(() => {
                    //Tout les blocs reviennent a leur position, le golem s'éteint
                    this.detectgolem6.x=this.golem6.x
                    this.detectgolem6.y=this.golem6.y+75
                    this.attackgolem6.x=this.golem6.x
                    this.attackgolem6.y=this.golem6.y
                    this.golem6.anims.play('eteintgolem', true)
                    }, 1200);

            }

            allumage7(){ 
                //donne un délai a l'attaque pur que le joueur esquive
                setTimeout(() => {
                    this.attackgolem7.x=this.golem7.x
                    this.attackgolem7.y=this.golem7.y+70
                    }, 1000);
                this.golem6.anims.play('animgolem', true)
                //le détecteur disparait le temps de l'attaque
                this.detectgolem7.x=5000
                this.detectgolem7.y=5000

                setTimeout(() => {
                    //Tout les blocs reviennent a leur position, le golem s'éteint
                    this.detectgolem7.x=this.golem7.x
                    this.detectgolem7.y=this.golem7.y+75
                    this.attackgolem7.x=this.golem7.x
                    this.attackgolem7.y=this.golem7.y
                    this.golem6.anims.play('eteintgolem', true)
                    }, 1200);

            }

            allumage8(){ 
                //donne un délai a l'attaque pur que le joueur esquive
                setTimeout(() => {
                    this.attackgolem8.x=this.golem8.x
                    this.attackgolem8.y=this.golem8.y+70
                    }, 1000);
                this.golem8.anims.play('animgolem', true)
                //le détecteur disparait le temps de l'attaque
                this.detectgolem8.x=5000
                this.detectgolem8.y=5000

                setTimeout(() => {
                    //Tout les blocs reviennent a leur position, le golem s'éteint
                    this.detectgolem8.x=this.golem8.x
                    this.detectgolem8.y=this.golem8.y+75
                    this.attackgolem8.x=this.golem8.x
                    this.attackgolem8.y=this.golem8.y
                    this.golem8.anims.play('eteintgolem', true)
                    }, 1200);

            }

            allumage9(){ 
                //donne un délai a l'attaque pur que le joueur esquive
                setTimeout(() => {
                    this.attackgolem9.x=this.golem9.x
                    this.attackgolem9.y=this.golem9.y+70
                    }, 1000);
                this.golem9.anims.play('animgolem', true)
                //le détecteur disparait le temps de l'attaque
                this.detectgolem9.x=5000
                this.detectgolem9.y=5000

                setTimeout(() => {
                    //Tout les blocs reviennent a leur position, le golem s'éteint
                    this.detectgolem9.x=this.golem9.x
                    this.detectgolem9.y=this.golem9.y+75
                    this.attackgolem9.x=this.golem9.x
                    this.attackgolem9.y=this.golem9.y
                    this.golem9.anims.play('eteintgolem', true)
                    }, 1200);

            }

            allumage10(){ 
                //donne un délai a l'attaque pur que le joueur esquive
                setTimeout(() => {
                    this.attackgolem10.x=this.golem10.x
                    this.attackgolem10.y=this.golem10.y+70
                    }, 1000);
                this.golem10.anims.play('animgolem', true)
                //le détecteur disparait le temps de l'attaque
                this.detectgolem10.x=5000
                this.detectgolem10.y=5000

                setTimeout(() => {
                    //Tout les blocs reviennent a leur position, le golem s'éteint
                    this.detectgolem10.x=this.golem10.x
                    this.detectgolem10.y=this.golem10.y+75
                    this.attackgolem10.x=this.golem10.x
                    this.attackgolem10.y=this.golem10.y
                    this.golem10.anims.play('eteintgolem', true)
                    }, 1200);

            }

            allumage11(){ 
                //donne un délai a l'attaque pur que le joueur esquive
                setTimeout(() => {
                    this.attackgolem11.x=this.golem11.x
                    this.attackgolem11.y=this.golem11.y+70
                    }, 1000);
                this.golem11.anims.play('animgolem', true)
                //le détecteur disparait le temps de l'attaque
                this.detectgolem11.x=5000
                this.detectgolem11.y=5000

                setTimeout(() => {
                    //Tout les blocs reviennent a leur position, le golem s'éteint
                    this.detectgolem11.x=this.golem11.x
                    this.detectgolem11.y=this.golem11.y+75
                    this.attackgolem11.x=this.golem11.x
                    this.attackgolem11.y=this.golem11.y
                    this.golem10.anims.play('eteintgolem', true)
                    }, 1200);

            }

            allumage12(){ 
                //donne un délai a l'attaque pur que le joueur esquive
                setTimeout(() => {
                    this.attackgolem12.x=this.golem12.x
                    this.attackgolem12.y=this.golem12.y+70
                    }, 1000);
                this.golem12.anims.play('animgolem', true)
                //le détecteur disparait le temps de l'attaque
                this.detectgolem12.x=5000
                this.detectgolem12.y=5000

                setTimeout(() => {
                    //Tout les blocs reviennent a leur position, le golem s'éteint
                    this.detectgolem12.x=this.golem12.x
                    this.detectgolem12.y=this.golem12.y+75
                    this.attackgolem12.x=this.golem12.x
                    this.attackgolem12.y=this.golem12.y
                    this.golem12.anims.play('eteintgolem', true)
                    }, 1200);

            }

            allumage13(){ 
                //donne un délai a l'attaque pur que le joueur esquive
                setTimeout(() => {
                    this.attackgolem13.x=this.golem13.x
                    this.attackgolem13.y=this.golem13.y+70
                    }, 1000);
                this.golem13.anims.play('animgolem', true)
                //le détecteur disparait le temps de l'attaque
                this.detectgolem13.x=5000
                this.detectgolem13.y=5000

                setTimeout(() => {
                    //Tout les blocs reviennent a leur position, le golem s'éteint
                    this.detectgolem13.x=this.golem13.x
                    this.detectgolem13.y=this.golem13.y+75
                    this.attackgolem13.x=this.golem13.x
                    this.attackgolem13.y=this.golem13.y
                    this.golem13.anims.play('eteintgolem', true)
                    }, 1200);

            }

            allumage14(){ 
                //donne un délai a l'attaque pur que le joueur esquive
                setTimeout(() => {
                    this.attackgolem14.x=this.golem14.x
                    this.attackgolem14.y=this.golem14.y+70
                    }, 1000);
                this.golem14.anims.play('animgolem', true)
                //le détecteur disparait le temps de l'attaque
                this.detectgolem14.x=5000
                this.detectgolem14.y=5000

                setTimeout(() => {
                    //Tout les blocs reviennent a leur position, le golem s'éteint
                    this.detectgolem14.x=this.golem14.x
                    this.detectgolem14.y=this.golem1.y+75
                    this.attackgolem14.x=this.golem14.x
                    this.attackgolem14.y=this.golem14.y
                    this.golem14.anims.play('eteintgolem', true)
                    }, 1200);

            }









            ouvreporte(player,porte){ 
                if(obtentionclef == 1){
                    this.porte.disableBody(true,true)
                    obtentionclef -= 1
                }
                

               


            }

            collectcoin(player,coffre1){ 

                setTimeout(() => {
                    coffreouvert = false;
                }, 1000);
                coffreouvert = true
                score += 20; //augmente le score de 20
                coffre1.anims.play('coffreouvert', true)
                coffre1.setOffset(5000,5000);


            }

            coffreclef(player,coffre1){ 

                setTimeout(() => {
                    coffreclefouvert = false;
                }, 7000);
                coffreclefouvert = true
                obtentionclef += 1
                coffre1.anims.play('coffreouvert', true)
                coffre1.setOffset(5000,5000);


            }

            collectmarteau(player,coffre1){ 

                setTimeout(() => {
                    coffremarteauouvert = false;
                }, 7000);
                coffremarteauouvert = true
                obtentionmarteau = true
                coffre1.anims.play('coffreouvert', true)
                coffre1.setOffset(5000,5000);


            }


            secousse() {
                player.scene.cameras.main.shake(1000,0.03)
                console.log("secousse ! !")

            }

            degats(player, virus) {
                

                if (PV == 3){
                    setTimeout(() => {
                        this.player.setOffset(0, 15);
                    }, 1000);
                    this.player.setOffset(5000,5000);
                    player.alpha = 0.5
                    this.serolReset = this.time.addEvent({
                        delay: 1000,
                        callback: ()=>{
                            player.alpha = 1;
                        },
                        loop: false
                    })
                    PV -= 1//si le virus nous touche, on perd un PV
                    console.log("aie")
                    this.deuxcoeurs.visible = true;
                    this.fullcoeur.visible = false;
                    
                } else if (PV == 2){
                    setTimeout(() => {
                        this.player.setOffset(0, 15);
                    }, 1000);
                    this.player.setOffset(5000,5000);
                    player.alpha = 0.5
                    this.serolReset = this.time.addEvent({
                        delay: 1000,
                        callback: ()=>{
                            player.alpha = 1;
                        },
                        loop: false
                    })
                    PV -= 1//si le virus nous touche, on perd un PV
                    console.log("aie2")
                    this.uncoeur.visible = true;
                    this.deuxcoeurs.visible = false;
                    
                } else if (PV == 1){
                    this.scene.start("gameover")
                
                }
            }

            chrono() {
                console.log("Fin !")
                

            }

            attackLplayer1() {
                this.piece.x = this.followvirus1.x
                this.piece.y = this.followvirus1.y
                PVennemy -= 1;
                this.followvirus1.destroy()


            }

            attackDplayer1() {
                this.piece.x = this.followvirus1.x
                this.piece.y = this.followvirus1.y
                PVennemy -= 1;
                this.followvirus1.destroy()

            }

            attackUplayer1() {
                this.piece.x = this.followvirus1.x
                this.piece.y = this.followvirus1.y
                PVennemy -= 1;
                this.followvirus1.destroy()

            }



            attackplayer2() {
                this.followvirus2.destroy()
                this.piece.x = this.followvirus2.x
                this.piece.y = this.followvirus2.y
                PVennemy -= 1;
                
                


            }

            attackLplayer2() {
                this.piece.x = this.followvirus2.x
                this.piece.y = this.followvirus2.y
                PVennemy -= 1;
                this.followvirus1.destroy()


            }

            attackDplayer2() {
                this.piece.x = this.followvirus2.x
                this.piece.y = this.followvirus2.y
                PVennemy -= 1;
                this.followvirus2.destroy()

            }

            attackUplayer2() {
                this.piece.x = this.followvirus2.x
                this.piece.y = this.followvirus2.y
                PVennemy -= 1;
                this.followvirus2.destroy()

            }

            attackplayer1() {
                this.followvirus1.destroy()
                this.piece.x = this.followvirus1.x
                this.piece.y = this.followvirus1.y
                PVennemy -= 1;
                
                


            }

            attackLplayer3() {
                this.piece.x = this.followvirus3.x
                this.piece.y = this.followvirus3.y
                PVennemy -= 1;
                this.followvirus3.destroy()


            }

            attackDplayer3() {
                this.piece.x = this.followvirus3.x
                this.piece.y = this.followvirus3.y
                PVennemy -= 1;
                this.followvirus3.destroy()

            }

            attackUplayer3() {
                this.piece.x = this.followvirus3.x
                this.piece.y = this.followvirus3.y
                PVennemy -= 1;
                this.followvirus3.destroy()

            }

            attackplayer4() {
                this.followvirus4.destroy()
                this.piece.x = this.followvirus4.x
                this.piece.y = this.followvirus4.y
                PVennemy -= 1;
                
                


            }

            attackLplayer4() {
                this.piece.x = this.followvirus4.x
                this.piece.y = this.followvirus4.y
                PVennemy -= 1;
                this.followvirus4.destroy()


            }

            attackDplayer4() {
                this.piece.x = this.followvirus4.x
                this.piece.y = this.followvirus4.y
                PVennemy -= 1;
                this.followvirus1.destroy()

            }

            attackUplayer4() {
                this.piece.x = this.followvirus4.x
                this.piece.y = this.followvirus4.y
                PVennemy -= 1;
                this.followvirus4.destroy()

            }

            attackplayer5() {
                this.followvirus5.destroy()
                this.piece.x = this.followvirus5.x
                this.piece.y = this.followvirus5.y
                PVennemy -= 1;
                
                


            }

            attackLplayer5() {
                this.piece.x = this.followvirus5.x
                this.piece.y = this.followvirus5.y
                PVennemy -= 1;
                this.followvirus5.destroy()


            }

            attackDplayer5() {
                this.piece.x = this.followvirus5.x
                this.piece.y = this.followvirus5.y
                PVennemy -= 1;
                this.followvirus1.destroy()

            }

            attackUplayer5() {
                this.piece.x = this.followvirus5.x
                this.piece.y = this.followvirus5.y
                PVennemy -= 1;
                this.followvirus5.destroy()

            }

            attackplayer6() {
                this.followvirus6.destroy()
                this.piece.x = this.followvirus6.x
                this.piece.y = this.followvirus6.y
                PVennemy -= 1;
                
                


            }

            attackLplayer6() {
                this.piece.x = this.followvirus6.x
                this.piece.y = this.followvirus6.y
                PVennemy -= 1;
                this.followvirus6.destroy()


            }

            attackDplayer6() {
                this.piece.x = this.followvirus6.x
                this.piece.y = this.followvirus6.y
                PVennemy -= 1;
                this.followvirus6.destroy()

            }

            attackUplayer6() {
                this.piece.x = this.followvirus6.x
                this.piece.y = this.followvirus6.y
                PVennemy -= 1;
                this.followvirus6.destroy()

            }

            attackplayer7() {
                this.followvirus7.destroy()
                this.piece.x = this.followvirus7.x
                this.piece.y = this.followvirus7.y
                PVennemy -= 1;
                
                


            }

            attackLplayer7() {
                this.piece.x = this.followvirus7.x
                this.piece.y = this.followvirus7.y
                PVennemy -= 1;
                this.followvirus7.destroy()


            }

            attackDplayer7() {
                this.piece.x = this.followvirus7.x
                this.piece.y = this.followvirus7.y
                PVennemy -= 1;
                this.followvirus7.destroy()

            }

            attackUplayer7() {
                this.piece.x = this.followvirus7.x
                this.piece.y = this.followvirus7.y
                PVennemy -= 1;
                this.followvirus7.destroy()

            }

            attackplayer8() {
                this.followvirus8.destroy()
                this.piece.x = this.followvirus8.x
                this.piece.y = this.followvirus8.y
                PVennemy -= 1;
                
                


            }

            attackLplayer8() {
                this.piece.x = this.followvirus8.x
                this.piece.y = this.followvirus8.y
                PVennemy -= 1;
                this.followvirus8.destroy()


            }

            attackDplayer8() {
                this.piece.x = this.followvirus8.x
                this.piece.y = this.followvirus8.y
                PVennemy -= 1;
                this.followvirus8.destroy()

            }

            attackUplayer8() {
                this.piece.x = this.followvirus8.x
                this.piece.y = this.followvirus8.y
                PVennemy -= 1;
                this.followvirus8.destroy()

            }

            attackplayer9() {
                this.followvirus9.destroy()
                this.piece.x = this.followvirus9.x
                this.piece.y = this.followvirus9.y
                PVennemy -= 1;
                
                


            }

            attackLplayer9() {
                this.piece.x = this.followvirus9.x
                this.piece.y = this.followvirus9.y
                PVennemy -= 1;
                this.followvirus1.destroy()


            }

            attackDplayer9() {
                this.piece.x = this.followvirus9.x
                this.piece.y = this.followvirus9.y
                PVennemy -= 1;
                this.followvirus9.destroy()

            }

            attackUplayer9() {
                this.piece.x = this.followvirus9.x
                this.piece.y = this.followvirus9.y
                PVennemy -= 1;
                this.followvirus9.destroy()

            }

            attackplayer10() {
                this.followvirus10.destroy()
                this.piece.x = this.followvirus10.x
                this.piece.y = this.followvirus10.y
                PVennemy -= 1;
                
                


            }

            attackLplayer10() {
                this.piece.x = this.followvirus10.x
                this.piece.y = this.followvirus10.y
                PVennemy -= 1;
                this.followvirus10.destroy()


            }

            attackDplayer10() {
                this.piece.x = this.followvirus10.x
                this.piece.y = this.followvirus10.y
                PVennemy -= 1;
                this.followvirus1.destroy()

            }

            attackUplayer10() {
                this.piece.x = this.followvirus10.x
                this.piece.y = this.followvirus10.y
                PVennemy -= 1;
                this.followvirus10.destroy()

            }

            attackplayer11() {
                this.followvirus1.destroy()
                this.piece.x = this.followvirus11.x
                this.piece.y = this.followvirus11.y
                PVennemy -= 1;
                
                


            }

            attackLplayer11() {
                this.piece.x = this.followvirus11.x
                this.piece.y = this.followvirus11.y
                PVennemy -= 1;
                this.followvirus11.destroy()


            }

            attackDplayer11() {
                this.piece.x = this.followvirus11.x
                this.piece.y = this.followvirus11.y
                PVennemy -= 1;
                this.followvirus11.destroy()

            }

            attackUplayer11() {
                this.piece.x = this.followvirus11.x
                this.piece.y = this.followvirus11.y
                PVennemy -= 1;
                this.followvirus11.destroy()

            }

                

            grappin1(zoneattack, pylone1) {
                this.player.x = this.pylone1.x
                this.player.y = this.pylone1.y;

            }

            grappinL1(zoneattackL, pylone1) {
                this.player.x = this.pylone1.x
                this.player.y = this.pylone1.y;

            }
            grappinD1(zoneattackD,pylone1) {
                this.player.x = this.pylone1.x
                this.player.y = this.pylone1.y;

            }
            grappinU1(zoneattackU,pylone1) {
                this.player.x = this.pylone1.x
                this.player.y = this.pylone1.y;

            }



            grappin2(zoneattack, pylone2) {
                this.player.x = this.pylone2.x
                this.player.y = this.pylone2.y;

            }

            grappinL2(zoneattackL, pylone2) {
                this.player.x = this.pylone2.x
                this.player.y = this.pylone2.y;

            }
            grappinD2(zoneattackD,pylone2) {
                this.player.x = this.pylone2.x
                this.player.y = this.pylone2.y;

            }
            grappinU2(zoneattackU,pylone2) {
                this.player.x = this.pylone2.x
                this.player.y = this.pylone2.y;

            }


            grappin3(zoneattack, pylone3) {
                this.player.x = this.pylone3.x
                this.player.y = this.pylone3.y;

            }

            grappinL3(zoneattackL, pylone3) {
                this.player.x = this.pylone3.x
                this.player.y = this.pylone3.y;

            }
            grappinD3(zoneattackD,pylone3) {
                this.player.x = this.pylone3.x
                this.player.y = this.pylone3.y;

            }
            grappinU3(zoneattackU,pylone3) {
                this.player.x = this.pylone3.x
                this.player.y = this.pylone3.y;

            }




            grappin4(zoneattack, pylone4) {
                this.player.x = this.pylone4.x
                this.player.y = this.pylone4.y;

            }

            grappinL4(zoneattackL, pylone4) {
                this.player.x = this.pylone4.x
                this.player.y = this.pylone4.y;

            }
            grappinD4(zoneattackD,pylone4) {
                this.player.x = this.pylone4.x
                this.player.y = this.pylone4.y;

            }
            grappinU4(zoneattackU,pylone4) {
                this.player.x = this.pylone4.x
                this.player.y = this.pylone4.y;

            }

            grappin5(zoneattack, pylone5) {
                this.player.x = this.pylone5.x
                this.player.y = this.pylone5.y;

            }

            grappinL5(zoneattackL, pylone5) {
                this.player.x = this.pylone5.x
                this.player.y = this.pylone5.y;

            }
            grappinD5(zoneattackD,pylone5) {
                this.player.x = this.pylone5.x
                this.player.y = this.pylone5.y;

            }
            grappinU5(zoneattackU,pylone5) {
                this.player.x = this.pylone5.x
                this.player.y = this.pylone5.y;

            }


            grappin6(zoneattack, pylone6) {
                this.player.x = this.pylone6.x
                this.player.y = this.pylone6.y;

            }

            grappinL6(zoneattackL, pylone6) {
                this.player.x = this.pylone6.x
                this.player.y = this.pylone6.y;

            }
            grappinD6(zoneattackD,pylone6) {
                this.player.x = this.pylone6.x
                this.player.y = this.pylone6.y;

            }
            grappinU6(zoneattackU,pylone6) {
                this.player.x = this.pylone6.x
                this.player.y = this.pylone6.y;

            }

            grappin7(zoneattack, pylone7) {
                this.player.x = this.pylone7.x
                this.player.y = this.pylone7.y;

            }

            grappinL7(zoneattackL, pylone7) {
                this.player.x = this.pylone7.x
                this.player.y = this.pylone7.y;

            }
            grappinD7(zoneattackD,pylone7) {
                this.player.x = this.pylone7.x
                this.player.y = this.pylone7.y;

            }
            grappinU7(zoneattackU,pylone7) {
                this.player.x = this.pylone7.x
                this.player.y = this.pylone7.y;

            }


            grappin8(zoneattack, pylone8) {
                this.player.x = this.pylone8.x
                this.player.y = this.pylone8.y;

            }

            grappinL8(zoneattackL, pylone8) {
                this.player.x = this.pylone8.x
                this.player.y = this.pylone8.y;

            }
            grappinD8(zoneattackD,pylone8) {
                this.player.x = this.pylone8.x
                this.player.y = this.pylone8.y;

            }
            grappinU8(zoneattackU,pylone8) {
                this.player.x = this.pylone8.x
                this.player.y = this.pylone8.y;

            }

            grappin9(zoneattack, pylone9) {
                this.player.x = this.pylone9.x
                this.player.y = this.pylone9.y;

            }

            grappinL9(zoneattackL, pylone9) {
                this.player.x = this.pylone9.x
                this.player.y = this.pylone9.y;

            }
            grappinD9(zoneattackD,pylone9) {
                this.player.x = this.pylone9.x
                this.player.y = this.pylone9.y;

            }
            grappinU9(zoneattackU,pylone9) {
                this.player.x = this.pylone9.x
                this.player.y = this.pylone9.y;

            }

            grappin10(zoneattack, pylone10) {
                this.player.x = this.pylone10.x
                this.player.y = this.pylone10.y;

            }

            grappinL10(zoneattackL, pylone10) {
                this.player.x = this.pylone10.x
                this.player.y = this.pylone10.y;

            }
            grappinD10(zoneattackD,pylone10) {
                this.player.x = this.pylone10.x
                this.player.y = this.pylone10.y;

            }
            grappinU10(zoneattackU,pylone10) {
                this.player.x = this.pylone10.x
                this.player.y = this.pylone10.y;

            }

            grappin11(zoneattack, pylone11) {
                this.player.x = this.pylone11.x
                this.player.y = this.pylone11.y;

            }

            grappinL11(zoneattackL, pylone11) {
                this.player.x = this.pylone11.x
                this.player.y = this.pylone11.y;

            }
            grappinD11(zoneattackD,pylone11) {
                this.player.x = this.pylone11.x
                this.player.y = this.pylone11.y;

            }
            grappinU11(zoneattackU,pylone11) {
                this.player.x = this.pylone11.x
                this.player.y = this.pylone11.y;

            }

            grappin12(zoneattack, pylone12) {
                this.player.x = this.pylone12.x
                this.player.y = this.pylone12.y;

            }

            grappinL12(zoneattackL, pylone12) {
                this.player.x = this.pylone12.x
                this.player.y = this.pylone12.y;

            }
            grappinD12(zoneattackD,pylone12) {
                this.player.x = this.pylone12.x
                this.player.y = this.pylone12.y;

            }
            grappinU12(zoneattackU,pylone12) {
                this.player.x = this.pylone12.x
                this.player.y = this.pylone12.y;

            }

            grappin13(zoneattack, pylone13) {
                this.player.x = this.pylone13.x
                this.player.y = this.pylone13.y;

            }

            grappinL13(zoneattackL, pylone13) {
                this.player.x = this.pylone13.x
                this.player.y = this.pylone13.y;

            }
            grappinD13(zoneattackD,pylone13) {
                this.player.x = this.pylone13.x
                this.player.y = this.pylone13.y;

            }
            grappinU13(zoneattackU,pylone13) {
                this.player.x = this.pylone13.x
                this.player.y = this.pylone13.y;

            }

            grappin14(zoneattack, pylone14) {
                this.player.x = this.pylone14.x
                this.player.y = this.pylone14.y;

            }

            grappinL14(zoneattackL, pylone14) {
                this.player.x = this.pylone14.x
                this.player.y = this.pylone14.y;

            }
            grappinD14(zoneattackD,pylone14) {
                this.player.x = this.pylone14.x
                this.player.y = this.pylone14.y;

            }
            grappinU14(zoneattackU,pylone14) {
                this.player.x = this.pylone14.x
                this.player.y = this.pylone14.y;

            }


            grappin15(zoneattack, pylone15) {
                this.player.x = this.pylone15.x
                this.player.y = this.pylone15.y;

            }

            grappinL15(zoneattackL, pylone15) {
                this.player.x = this.pylone15.x
                this.player.y = this.pylone15.y;

            }
            grappinD15(zoneattackD,pylone15) {
                this.player.x = this.pylone15.x
                this.player.y = this.pylone15.y;

            }
            grappinU15(zoneattackU,pylone15) {
                this.player.x = this.pylone15.x
                this.player.y = this.pylone15.y;

            }

            grappin16(zoneattack, pylone16) {
                this.player.x = this.pylone16.x
                this.player.y = this.pylone16.y;

            }

            grappinL16(zoneattackL, pylone16) {
                this.player.x = this.pylone16.x
                this.player.y = this.pylone16.y;

            }
            grappinD16(zoneattackD,pylone16) {
                this.player.x = this.pylone16.x
                this.player.y = this.pylone16.y;

            }
            grappinU16(zoneattackU,pylone16) {
                this.player.x = this.pylone16.x
                this.player.y = this.pylone16.y;

            }

            grappin17(zoneattack, pylone17) {
                this.player.x = this.pylone17.x
                this.player.y = this.pylone17.y;

            }

            grappinL17(zoneattackL, pylone17) {
                this.player.x = this.pylone17.x
                this.player.y = this.pylone17.y;

            }
            grappinD17(zoneattackD,pylone17) {
                this.player.x = this.pylone17.x
                this.player.y = this.pylone17.y;

            }
            grappinU17(zoneattackU,pylone17) {
                this.player.x = this.pylone17.x
                this.player.y = this.pylone17.y;

            }

            grappin18(zoneattack, pylone18) {
                this.player.x = this.pylone18.x
                this.player.y = this.pylone18.y;

            }

            grappinL18(zoneattackL, pylone18) {
                this.player.x = this.pylone18.x
                this.player.y = this.pylone18.y;

            }
            grappinD18(zoneattackD,pylone18) {
                this.player.x = this.pylone18.x
                this.player.y = this.pylone18.y;

            }
            grappinU18(zoneattackU,pylone18) {
                this.player.x = this.pylone18.x
                this.player.y = this.pylone18.y;

            }


            grappin20(zoneattack, pylone20) {
                this.player.x = this.pylone20.x
                this.player.y = this.pylone20.y;

            }

            grappinL20(zoneattackL, pylone20) {
                this.player.x = this.pylone20.x
                this.player.y = this.pylone20.y;

            }
            grappinD20(zoneattackD,pylone20) {
                this.player.x = this.pylone20.x
                this.player.y = this.pylone20.y;

            }
            grappinU20(zoneattackU,pylone20) {
                this.player.x = this.pylone20.x
                this.player.y = this.pylone20.y;

            }

            grappin21(zoneattack, pylone21) {
                this.player.x = this.pylone21.x
                this.player.y = this.pylone21.y;

            }

            grappinL21(zoneattackL, pylone21) {
                this.player.x = this.pylone21.x
                this.player.y = this.pylone21.y;

            }
            grappinD21(zoneattackD,pylone21) {
                this.player.x = this.pylone21.x
                this.player.y = this.pylone21.y;

            }
            grappinU21(zoneattackU,pylone21) {
                this.player.x = this.pylone21.x
                this.player.y = this.pylone21.y;

            }

            grappin22(zoneattack, pylone22) {
                this.player.x = this.pylone22.x
                this.player.y = this.pylone22.y;

            }

            grappinL22(zoneattackL, pylone22) {
                this.player.x = this.pylone22.x
                this.player.y = this.pylone22.y;

            }
            grappinD22(zoneattackD,pylone20) {
                this.player.x = this.pylone22.x
                this.player.y = this.pylone22.y;

            }
            grappinU22(zoneattackU,pylone22) {
                this.player.x = this.pylone22.x
                this.player.y = this.pylone22.y;

            }

            grappin23(zoneattack, pylone23) {
                this.player.x = this.pylone20.x
                this.player.y = this.pylone20.y;

            }

            grappinL23(zoneattackL, pylone23) {
                this.player.x = this.pylone23.x
                this.player.y = this.pylone23.y;

            }
            grappinD23(zoneattackD,pylone23) {
                this.player.x = this.pylone23.x
                this.player.y = this.pylone23.y;

            }
            grappinU23(zoneattackU,pylone23) {
                this.player.x = this.pylone23.x
                this.player.y = this.pylone23.y;

            }

            grappin24(zoneattack, pylone24) {
                this.player.x = this.pylone24.x
                this.player.y = this.pylone24.y;

            }

            grappinL24(zoneattackL, pylone24) {
                this.player.x = this.pylone24.x
                this.player.y = this.pylone24.y;

            }
            grappinD24(zoneattackD,pylone24) {
                this.player.x = this.pylone24.x
                this.player.y = this.pylone24.y;

            }
            grappinU24(zoneattackU,pylone24) {
                this.player.x = this.pylone24.x
                this.player.y = this.pylone24.y;

            }

            grappin25(zoneattack, pylone25) {
                this.player.x = this.pylone25.x
                this.player.y = this.pylone25.y;

            }

            grappinL25(zoneattackL, pylone25) {
                this.player.x = this.pylone25.x
                this.player.y = this.pylone25.y;

            }
            grappinD25(zoneattackD,pylone25) {
                this.player.x = this.pylone25.x
                this.player.y = this.pylone25.y;

            }
            grappinU25(zoneattackU,pylone25) {
                this.player.x = this.pylone25.x
                this.player.y = this.pylone25.y;

            }

            grappin26(zoneattack, pylone26) {
                this.player.x = this.pylone26.x
                this.player.y = this.pylone26.y;

            }

            grappinL26(zoneattackL, pylone26) {
                this.player.x = this.pylone26.x
                this.player.y = this.pylone26.y;

            }
            grappinD26(zoneattackD,pylone26) {
                this.player.x = this.pylone26.x
                this.player.y = this.pylone20.y;

            }
            grappinU26(zoneattackU,pylone26) {
                this.player.x = this.pylone26.x
                this.player.y = this.pylone26.y;

            }

            grappin27(zoneattack, pylone27) {
                this.player.x = this.pylone27.x
                this.player.y = this.pylone27.y;

            }

            grappinL27(zoneattackL, pylone27) {
                this.player.x = this.pylone27.x
                this.player.y = this.pylone27.y;

            }
            grappinD27(zoneattackD,pylone27) {
                this.player.x = this.pylone27.x
                this.player.y = this.pylone27.y;

            }
            grappinU27(zoneattackU,pylone27) {
                this.player.x = this.pylone27.x
                this.player.y = this.pylone27.y;

            }

            grappin28(zoneattack, pylone28) {
                this.player.x = this.pylone28.x
                this.player.y = this.pylone28.y;

            }

            grappinL28(zoneattackL, pylone28) {
                this.player.x = this.pylone28.x
                this.player.y = this.pylone28.y;

            }
            grappinD28(zoneattackD,pylone28) {
                this.player.x = this.pylone28.x
                this.player.y = this.pylone28.y;

            }
            grappinU28(zoneattackU,pylone28) {
                this.player.x = this.pylone28.x
                this.player.y = this.pylone28.y;

            }





















                smash1() {
                    this.boite1.disableBody(true,true);
                    

                }

                smash2() {
                    this.boite2.disableBody(true,true);
                    

                }

                smash3() {
                    this.boite3.disableBody(true,true);
                    

                }

                smash4() {
                    this.boite4.disableBody(true,true);
                    

                }

                smash5() {
                    this.boite5.disableBody(true,true);
                    

                }

                smash6() {
                    this.boite6.disableBody(true,true);
                    

                }

                smash7() {
                    this.boite7.disableBody(true,true);
                    

                }

                smash8() {
                    this.boite8.disableBody(true,true);
                    

                }

                smash9() {
                    this.boite9.disableBody(true,true);
                    

                }


                smash10() {
                    this.boite10.disableBody(true,true);
                    

                }

                smash11() {
                    this.boite11.disableBody(true,true);
                    

                }

                smash12() {
                    this.boite12.disableBody(true,true);
                    

                }

                smash13() {
                    this.boite13.disableBody(true,true);
                    

                }












                

                tpcampM(marteauV, boite) {
                    this.boite.disableBody(true,true);
                    console.log("ouch")

                }

                tpjunglefuite(player, sortiefuitemontagne) {
                        sortiefuite = true
                        entreefuite = false
                        
                        this.scene.start("niveau1",{
                    PV : this.PV,
                    score : this.score,
                    obtentionmasque : this.obtentionmasque,
                    obtentionyoyo : this.obtentionyoyo,
                    sortiefuite : this.sortiefuite,
                    entreefuite : this.entreefuite,
                });}
                    

                



            update() {

                this.scoreText.setText(score)
                
                if(coffreouvert == true){
                this.container.visible = true;
                this.textObject.visible = true;
               }
               else if (coffreouvert == false){
                this.container.visible = false;
                this.textObject.visible = false;
               }

               if(coffremarteauouvert == true){
                this.containermarteau.visible = true;
               }
               else if (coffremarteauouvert == false){
                this.containermarteau.visible = false;
               }

               if(obtentionclef == 1){
                this.clefui.visible = true;
               }
               else if (obtentionclef == 0){
                this.clefui.visible = false;
               }

               if(coffreclefouvert == true){
                this.containerclef.visible = true;
               }
               else if (coffreclefouvert == false){
                this.containerclef.visible = false;
               }
                


                






                if (arret == true) {

                    this.player.setVelocityX(0);
                    this.player.setVelocityY(0);

                }

                //fonction attaque
                if (keyZ.isDown && petit == false && this.cursors.right.isDown && this.obtentionyoyo >= 1) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    this.cursors.right.enabled = false;
                    arret = true
                    this.zoneattack.y = this.player.y
                    this.zoneattack.x = this.player.x + 70
                    setTimeout(() => {
                        this.zoneattack.y = 100
                        this.zoneattack.x = 100
                        arret = false
                        this.cursors.right.enabled = true;
                    }, 400);
                }
                else if (keyZ.isDown && petit == true && this.cursors.right.isDown && this.obtentionyoyo >= 1) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattack.y = this.player.y
                    this.zoneattack.x = this.player.x + 40
                    setTimeout(() => {
                        this.zoneattack.y = 100
                        this.zoneattack.x = 100
                        arret = false
                    }, 400);
                }

                if (keyZ.isDown && petit == false && this.cursors.left.isDown && this.obtentionyoyo >= 1) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattackL.y = this.player.y
                    this.zoneattackL.x = this.player.x - 65
                    setTimeout(() => {
                        this.zoneattackL.y = 100
                        this.zoneattackL.x = 100
                        arret = false
                    }, 400);
                }
                else if (keyZ.isDown && petit == true && this.cursors.left.isDown && this.obtentionyoyo >= 1) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattackL.y = this.player.y
                    this.zoneattackL.x = this.player.x - 30
                    setTimeout(() => {
                        this.zoneattackL.y = 100
                        this.zoneattackL.x = 100
                        arret = false
                    }, 400);
                }

                if (keyZ.isDown && petit == false && this.cursors.down.isDown && this.obtentionyoyo >= 1) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattackD.y = this.player.y + 65
                    this.zoneattackD.x = this.player.x 
                    setTimeout(() => {
                        this.zoneattackD.y = 100
                        this.zoneattackD.x = 100
                        arret = false
                    }, 400);
                }
                else if (keyZ.isDown && petit == true && this.cursors.down.isDown && this.obtentionyoyo >= 1) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattackD.y = this.player.y + 30
                    this.zoneattackD.x = this.player.x 
                    setTimeout(() => {
                        this.zoneattackD.y = 100
                        this.zoneattackD.x = 100
                        arret = false
                    }, 400);
                }

                    if (keyZ.isDown && petit == false && this.cursors.up.isDown && this.obtentionyoyo >= 1) {
                        this.cursors.right.reset();
                        this.cursors.left.reset();
                        this.cursors.up.reset();
                        this.cursors.down.reset();
                        arret = true
                        this.zoneattackU.y = this.player.y - 65
                        this.zoneattackU.x = this.player.x 
                        setTimeout(() => {
                            this.zoneattackU.y = 100
                            this.zoneattackU.x = 100
                            arret = false
                        }, 400);
                        }
                        else if (keyZ.isDown && petit == true && this.cursors.up.isDown) {
                        this.cursors.right.reset();
                        this.cursors.left.reset();
                        this.cursors.up.reset();
                        this.cursors.down.reset();
                        arret = true
                        this.zoneattackU.y = this.player.y - 30
                        this.zoneattackU.x = this.player.x 
                        setTimeout(() => {
                            this.zoneattackU.y = 100
                            this.zoneattackU.x = 100
                            arret = false
                        }, 400);
                    }


                       //fonction marteau
                if (keyE.isDown && petit == false && this.cursors.right.isDown && obtentionmarteau == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    this.cursors.right.enabled = false;
                    arret = true
                    this.marteauR.y = this.player.y + 10
                    this.marteauR.x = this.player.x + 35
                    setTimeout(() => {
                        this.marteauR.y = 100
                        this.marteauR.x = 100
                        arret = false
                        this.cursors.right.enabled = true;
                    }, 400);
                }
                else if (keyE.isDown && petit == true && this.cursors.right.isDown && obtentionmarteau == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauR.y = this.player.y + 5
                    this.marteauR.x = this.player.x + 20
                    setTimeout(() => {
                        this.marteauR.y = 100
                        this.marteauR.x = 100
                        arret = false
                    }, 400);
                }

                if (keyE.isDown && petit == false && this.cursors.left.isDown && obtentionmarteau == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauL.y = this.player.y + 10
                    this.marteauL.x = this.player.x -35
                    setTimeout(() => {
                        this.marteauL.y = 100
                        this.marteauL.x = 100
                        arret = false
                    }, 400);
                }
                else if (keyE.isDown && petit == true && this.cursors.left.isDown && obtentionmarteau == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauL.y = this.player.y + 5
                    this.marteauL.x = this.player.x - 20
                    setTimeout(() => {
                        this.marteauL.y = 100
                        this.marteauL.x = 100
                        arret = false
                    }, 400);
                }

                if (keyE.isDown && petit == false && this.cursors.down.isDown && obtentionmarteau == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauD.y = this.player.y + 40
                    this.marteauD.x = this.player.x 
                    setTimeout(() => {
                        this.marteauD.y = 100
                        this.marteauD.x = 100
                        arret = false
                    }, 400);
                }
                else if (keyE.isDown && petit == true && this.cursors.down.isDown && obtentionmarteau == true) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauD.y = this.player.y + 20
                    this.marteauD.x = this.player.x 
                    setTimeout(() => {
                        this.marteauD.y = 100
                        this.marteauD.x = 100
                        arret = false
                    }, 400);
                }

                if (keyE.isDown && petit == false && this.cursors.up.isDown && obtentionmarteau == true) {
                        this.cursors.right.reset();
                        this.cursors.left.reset();
                        this.cursors.up.reset();
                        this.cursors.down.reset();
                        arret = true
                        this.marteauU.y = this.player.y - 25
                        this.marteauU.x = this.player.x 
                        setTimeout(() => {
                            this.marteauU.y = 100
                            this.marteauU.x = 100
                            arret = false
                        }, 400);
                        }
                        else if (keyE.isDown && petit == true && this.cursors.up.isDown && obtentionmarteau == true) {
                        this.cursors.right.reset();
                        this.cursors.left.reset();
                        this.cursors.up.reset();
                        this.cursors.down.reset();
                        arret = true
                        this.marteauU.y = this.player.y - 15
                        this.marteauU.x = this.player.x 
                        setTimeout(() => {
                            this.marteauU.y = 100
                            this.marteauU.x = 100
                            arret = false
                        }, 400);
                }

                //fonction minimize
                if (keyA.isDown && petit == false && obtentionmini == true) {
                    this.player.setScale(0.5)
                    this.zoneattack.setScale(0.5)
                    this.zoneattackL.setScale(0.5)
                    this.zoneattackU.setScale(0.5)
                    this.zoneattackD.setScale(0.5)
                    this.marteauR.setScale(0.5)
                    this.marteauL.setScale(0.5)
                    this.marteauD.setScale(0.5)
                    this.marteauU.setScale(0.5)
                    setTimeout(() => {
                        petit = true;

                    }, 200);
                }
                else if (keyA.isDown && petit == true && obtentionmini == true) {
                    this.player.setScale(1)
                    this.zoneattack.setScale(1)
                    this.zoneattackL.setScale(1)
                    this.zoneattackD.setScale(1)
                    this.zoneattackU.setScale(1)
                    this.marteauR.setScale(1)
                    this.marteauU.setScale(1)
                    this.marteauL.setScale(1)
                    this.marteauD.setScale(1)
                    setTimeout(() => {
                        petit = false;

                    }, 200);





                }
                if (this.cursors.left.isDown) { //si la touche gauche est appuyée
                    this.player.setVelocityX(-160); //alors vitesse négative en X
                    this.player.anims.play('left', true); //et animation => gauche
                }
                else if (this.cursors.right.isDown) { //sinon si la touche droite est appuyée
                    this.player.setVelocityX(160); //alors vitesse positive en X
                    this.player.anims.play('right', true); //et animation => droite
                }
                else { // sinon
                    this.player.setVelocityX(0); //vitesse nulle
                    //this.player.anims.play('turn', true); //animation fait face caméra
                    turn = true;
                }

                if (this.cursors.up.isDown) {
                    //si touche haut appuyée ET que le perso touche le sol
                    this.player.setVelocityY(-160); //alors vitesse verticale négative
                    this.player.anims.play('up', true);

                }
                else if (this.cursors.down.isDown) {
                    //si touche haut appuyée ET que le perso touche le sol
                    this.player.setVelocityY(160); //alors vitesse verticale négative
                    this.player.anims.play('down', true);

                }
                else {
                    //si touche haut appuyée ET que le perso touche le sol
                    this.player.setVelocityY(0); //alors vitesse verticale négative
                    if (turn == true) {
                        this.player.anims.play('turn', true); //animation fait face caméra
                        //(on saute)
                    }
                }

                turn = false;

                if (this.gameOver) { return; }

            }

            tpentreetemple(player, entreetemple) {
                    this.scene.start("temple",{
                        PV : this.PV,
                        obtentionmasque : this.obtentionmasque,
                        obtentionyoyo : this.obtentionyoyo,
                    });
                    }

            tpcampM(player, sortiemontagne) {
                this.sortieM = true
                console.log("trueM")
                this.scene.start("camp",{
                sortieM : this.sortieM,
                PV : this.PV,
                obtentionmasque : this.obtentionmasque,
                obtentionyoyo : this.obtentionyoyo,
            });}

        }

        














        class niveautemple extends Phaser.Scene {


            constructor() {

                super("temple")
            }

            init(data) { 
                this.sortieT = sortieT 
                this. PV = data.PV;
                this.obtentionmasque = data.obtentionmasque;
                this.obtentionyoyo = data.obtentionyoyo
            }


            preload() {
                // chargement tuiles de jeu
                this.load.image("Phaser_Tileset", "assets/placeholdernew.png");

                // chargement de la carte
                this.load.tilemapTiledJSON("cartetemple", "assets/temple.json");

                

                this.load.spritesheet('perso', 'assets/protopetit.png',
                    { frameWidth: 32, frameHeight: 48 });

                    this.load.spritesheet("zoneattack", "assets/zoneattack.png", {
                    frameWidth: 96,
                    frameHeight: 48,
                });

                this.load.spritesheet("zoneattackL", "assets/zoneattackL.png", {
                    frameWidth: 96,
                    frameHeight: 48,
                });

                this.load.spritesheet("entreerelique", "assets/entreerelique.png", {
                    frameWidth: 32,
                    frameHeight: 32,
                });

                this.load.spritesheet("sortietemple", "assets/sortietemple.png", {
                    frameWidth: 32,
                    frameHeight: 32,
                });

                this.load.spritesheet("zoneattackD", "assets/zoneattackD.png", {
                    frameWidth: 48,
                    frameHeight: 96,
                });

                this.load.spritesheet("zoneattackU", "assets/zoneattackU.png", {
                    frameWidth: 48,
                    frameHeight: 96,
                });

                this.load.spritesheet("marteau", "assets/marteau.png", {
                    frameWidth: 38,
                    frameHeight: 38,
                });

                this.load.spritesheet("pylone", "assets/pylone.png", {
                    frameWidth: 38,
                    frameHeight: 38,
                });

                this.load.spritesheet("boite", "assets/boite.png", {
                    frameWidth: 39,
                    frameHeight: 46,
                });

                this.load.spritesheet("boiteP", "assets/boiteP.png", {
                    frameWidth: 27,
                    frameHeight: 46,
                });

                this.load.spritesheet("marteauV", "assets/marteauV.png", {
                    frameWidth: 38,
                    frameHeight: 38,
                });

                this.load.spritesheet("marteauD", "assets/marteauD.png", {
                    frameWidth: 25,
                    frameHeight: 34,
                });

                this.load.spritesheet("marteauU", "assets/marteauU.png", {
                    frameWidth: 25,
                    frameHeight: 35,
                });

                this.load.spritesheet("marteauL", "assets/marteauL.png", {
                    frameWidth: 40,
                    frameHeight: 25,
                });

                this.load.spritesheet("marteauR", "assets/marteauR.png", {
                    frameWidth: 40,
                    frameHeight: 25,
                });



                this.load.image('FondUI', 'assets/fondUI.png');
                this.load.image('fullcoeur', 'assets/fullcoeur.png');
                this.load.image('deuxcoeurs', 'assets/deuxcoeurs.png');
                this.load.image('uncoeur', 'assets/uncoeur.png');
                this.load.image('clefui', 'assets/UIclef.png');

                this.load.spritesheet("virus", "assets/mobile.png", {
                    frameWidth: 32,
                    frameHeight: 32,
                });

                this.load.image('container', 'assets/boitedialogue.png');
                this.load.image('containermarteau', 'assets/containermarteau.png');
                this.load.image('containerclef', 'assets/containerclef.png');
                this.load.image('containermini', 'assets/containermini.png');

                this.load.spritesheet('coffre1', 'assets/coffreface.png',
                    { frameWidth: 64, frameHeight: 64 });

                this.load.spritesheet('golem', 'assets/spritegolem.png',
                { frameWidth: 54, frameHeight: 137 });

                this.load.spritesheet('piece', 'assets/piece.png',
                    { frameWidth: 32, frameHeight: 32 });

                    this.load.spritesheet("attackgolem", "assets/attackgolem.png", {
                    frameWidth: 32,
                    frameHeight: 32,
                });

                this.load.spritesheet('coffre1', 'assets/coffreface.png',
                    { frameWidth: 64, frameHeight: 64 });

                this.load.spritesheet('porte', 'assets/porte.png',
                { frameWidth: 32, frameHeight: 48 });

                this.load.image('container', 'assets/boitedialogue.png');

            }


            create() {
                
               // chargement de la carte du niveau
               const carteDuNiveau = this.add.tilemap("cartetemple");
                // chargement du jeu de tuiles
                const tileset = carteDuNiveau.addTilesetImage(
                    "placeholdernew",
                    "Phaser_Tileset"
                );



                // chargement du calque "calque_backgroung"
                const backgroundLayer = carteDuNiveau.createLayer(
                    "sol",
                    tileset
                );

                // chargement du calque "calque_backgroung"
                const motifs = carteDuNiveau.createLayer(
                    "motif sol",
                    tileset
                );

                // chargement du second calque "calque_backgroung"
                const blocstemple = carteDuNiveau.createLayer(
                    "blocs",
                    tileset
                );

                petit = false
                sortieT = true
                this.player = this.physics.add.sprite(1440,2030, 'perso');
                //this.player = this.physics.add.sprite(1440,2010, 'perso');
                //taille de la hitbox 1440,2010
                this.player.setSize(32, 32);
                //decaler la hitbox
                this.player.setOffset(0, 15);
                this.anims.create({
                    key: 'left',
                    frames: this.anims.generateFrameNumbers('perso', { start: 0, end: 1 }),
                    frameRate: 10,
                    repeat: -1
                });
                this.anims.create({
                    key: 'turn',
                    frames: [{ key: 'perso', frame: 2 }],
                    frameRate: 20
                });
                this.anims.create({
                    key: 'right',
                    frames: this.anims.generateFrameNumbers('perso', { start: 3, end: 4 }),
                    frameRate: 10,
                    repeat: -1
                });

                this.anims.create({
                    key: 'up',
                    frames: this.anims.generateFrameNumbers('perso', { start: 8, end: 9 }),
                    frameRate: 10,
                    repeat: 1
                });

                this.anims.create({
                    key: 'down',
                    frames: this.anims.generateFrameNumbers('perso', { start: 5, end: 6 }),
                    frameRate: 10,
                    repeat: -1
                });

                blocstemple.setCollisionByProperty({ solide: true });

                this.physics.add.collider(this.player, blocstemple);

                this.cursors = this.input.keyboard.createCursorKeys();

                this.zoneattack = this.physics.add.sprite(100, 100, "zoneattack").setInteractive();
                this.physics.add.collider(this.zoneattack, this.followvirus1, this.attackplayer1, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus2, this.attackplayer2, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus3, this.attackplayer3, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus4, this.attackplayer4, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus5, this.attackplayer5, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus6, this.attackplayer6, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus7, this.attackplayer7, null, this);



                this.zoneattackL = this.physics.add.sprite(100, 100, "zoneattackL").setInteractive();
                

                this.physics.add.collider(this.zoneattackL, this.followvirus1, this.attackLplayer1, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus2, this.attackLplayer2, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus3, this.attackLplayer3, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus4, this.attackLplayer4, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus5, this.attackLplayer5, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus6, this.attackLplayer6, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus8, this.attackLplayer7, null, this);

                this.zoneattackD = this.physics.add.sprite(100, 100, "zoneattackD").setInteractive();

                this.physics.add.collider(this.zoneattackD, this.followvirus1, this.attackDplayer1, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus2, this.attackDplayer2, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus3, this.attackDplayer3, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus3, this.attackDplayer3, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus4, this.attackDplayer4, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus5, this.attackDplayer5, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus6, this.attackDplayer6, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus7, this.attackDplayer7, null, this);

                this.zoneattackU = this.physics.add.sprite(100, 100, "zoneattackU").setInteractive();

                this.physics.add.collider(this.zoneattackU, this.followvirus1, this.attackUplayer1, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus2, this.attackUplayer2, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus3, this.attackUplayer3, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus4, this.attackUplayer4, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus5, this.attackUplayer5, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus6, this.attackUplayer6, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus7, this.attackUplayer7, null, this);

                //hitbox du marteau
                this.marteauR = this.physics.add.sprite(100, 100, "marteauR").setInteractive();

                this.physics.add.collider(this.marteauR, this.boite, this.smash, null, this);

                this.marteauU = this.physics.add.sprite(100, 100, "marteauU").setInteractive();

                this.physics.add.collider(this.marteauU, this.boite, this.smashV, null, this);

                this.marteauL = this.physics.add.sprite(100, 100, "marteauL").setInteractive();

                this.physics.add.collider(this.marteauL, this.boite, this.smashV, null, this);

                this.marteauD = this.physics.add.sprite(100, 100, "marteauD").setInteractive();

                this.physics.add.collider(this.marteauD, this.boite, this.smashV, null, this);

                this.cameras.main.setBounds(0, 0, 2720, 2400);
                this.cameras.main.startFollow(this.player);

                this.entreerelique = this.physics.add.sprite(625, 85, "entreerelique").setInteractive();
                this.entreerelique.setImmovable();
                this.entreerelique.setSize(48, 48);
                this.physics.add.collider(this.entreerelique, this.player, this.tpentreerelique, null, this);

                this.sortietemple = this.physics.add.sprite(1440,2100, "sortietemple").setInteractive();
                this.sortietemple.setImmovable();
                this.sortietemple.setSize(48, 32);
                this.physics.add.collider(this.sortietemple, this.player, this.tpsortietemple, null, this);



                keyA = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.A);
                keyZ = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.Z);
                keyE = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.E);


                this.add.image(550,290, 'FondUI').setScrollFactor(0);
                this.containerclef = this.add.sprite(550, 475, 'containerclef').setScrollFactor(0);
                this.containerclef.alpha = 0.8;
                this.containerclef.visible = false;

                this.anims.create({
                    key: 'virusactif',
                    frames: this.anims.generateFrameNumbers('virus', { start: 0, end: 1 }),
                    frameRate: 10,
                    repeat: -1
                });

                
                this.fullcoeur = this.add.image(550,290, 'fullcoeur').setScrollFactor(0);
                this.fullcoeur.visible = false;
                this.deuxcoeurs = this.add.image(550,290, 'deuxcoeurs').setScrollFactor(0);
                this.deuxcoeurs.visible = false;
                this.uncoeur = this.add.image(550,290, 'uncoeur').setScrollFactor(0);
                this.uncoeur.visible = false;
                this.clefui = this.add.image(550,290, 'clefui').setScrollFactor(0);
                this.clefui.visible = false;
                this.scoreText=this.add.text(115,100,score,{fontSize:'64px',fill:'#FFFFFF',strokeThickness: 6, stroke:'#000000'}).setScrollFactor(0);
                this.scoreText.setText(score); //met à jour l’affichage du score

                if(PV == 3){
                    this.fullcoeur.visible = true;
                }
                else if (PV == 2){
                    this.deuxcoeurs.visible = true;
                }
                else if (PV == 1){
                    this.uncoeur.visible = true;
                }

                //placement des coffres
                this.anims.create({
                    key: 'coffreouvert',
                    frames: this.anims.generateFrameNumbers('coffre1', { start: 1, end: 1 }),
                    frameRate: 10,
                    repeat: -1
                });

                this.coffre1 = this.physics.add.sprite(2299,1720, 'coffre1');
                this.coffre1.setScale(0.75)
                this.physics.add.collider(this.player, this.coffre1,this.coffreclef);
                this.coffre1.setImmovable();

                this.coffre1 = this.physics.add.sprite(2200,860, 'coffre1');
                this.coffre1.setScale(0.75)
                this.physics.add.collider(this.player, this.coffre1,this.coffreclef);
                this.coffre1.setImmovable();

                this.coffre1 = this.physics.add.sprite(640,1090, 'coffre1');
                this.coffre1.setScale(0.75)
                this.physics.add.collider(this.player, this.coffre1,this.coffreclef);
                this.coffre1.setImmovable();


                //placement de la porte
                this.porte1 = this.physics.add.sprite(1443,1690, "porte").setInteractive();
                this.physics.add.collider(this.player, this.porte1, this.ouvreporte1, null, this);
                this.porte1.setImmovable();

                this.porte2 = this.physics.add.sprite(625,117, "porte").setInteractive();
                this.physics.add.collider(this.player, this.porte2, this.ouvreporte2, null, this);
                this.porte2.setImmovable();

                this.porte3 = this.physics.add.sprite(2110,1210, "porte").setInteractive();
                this.physics.add.collider(this.player, this.porte3, this.ouvreporte3, null, this);
                this.porte3.setImmovable();

                //placement des pylones
                this.pylone1 = this.physics.add.sprite(2100,1990, "pylone").setInteractive();
                this.physics.add.collider(this.pylone1, this.zoneattack, this.grappin1, null, this);
                this.physics.add.collider(this.pylone1, this.zoneattackL, this.grappinL1, null, this);
                this.physics.add.collider(this.pylone1, this.zoneattackU, this.grappinU1, null, this);
                this.physics.add.collider(this.pylone1, this.zoneattackD, this.grappinD1, null, this);

                this.pylone2 = this.physics.add.sprite(2179,1950, "pylone").setInteractive();
                this.physics.add.collider(this.pylone2, this.zoneattack, this.grappin2, null, this);
                this.physics.add.collider(this.pylone2, this.zoneattackL, this.grappinL2, null, this);
                this.physics.add.collider(this.pylone2, this.zoneattackU, this.grappinU2, null, this);
                this.physics.add.collider(this.pylone2, this.zoneattackD, this.grappinD2, null, this);

                this.pylone = this.physics.add.sprite(2290,1980, "pylone").setInteractive();
                this.physics.add.collider(this.pylone, this.zoneattack, this.grappin, null, this);
                this.physics.add.collider(this.pylone, this.zoneattackL, this.grappinL, null, this);
                this.physics.add.collider(this.pylone, this.zoneattackU, this.grappinU, null, this);
                this.physics.add.collider(this.pylone, this.zoneattackD, this.grappinD, null, this);

                this.pylone3 = this.physics.add.sprite(2320,1840, "pylone").setInteractive();
                this.physics.add.collider(this.pylone3, this.zoneattack, this.grappin3, null, this);
                this.physics.add.collider(this.pylone3, this.zoneattackL, this.grappinL3, null, this);
                this.physics.add.collider(this.pylone3, this.zoneattackU, this.grappinU3, null, this);
                this.physics.add.collider(this.pylone3, this.zoneattackD, this.grappinD3, null, this);

                this.pylone4 = this.physics.add.sprite(1340,740, "pylone").setInteractive();
                this.physics.add.collider(this.pylone4, this.zoneattack, this.grappin4, null, this);
                this.physics.add.collider(this.pylone4, this.zoneattackL, this.grappinL4, null, this);
                this.physics.add.collider(this.pylone4, this.zoneattackU, this.grappinU4, null, this);
                this.physics.add.collider(this.pylone4, this.zoneattackD, this.grappinD4, null, this);

                this.pylone5 = this.physics.add.sprite(1500,850, "pylone").setInteractive();
                this.physics.add.collider(this.pylone5, this.zoneattack, this.grappin5, null, this);
                this.physics.add.collider(this.pylone5, this.zoneattackL, this.grappinL5, null, this);
                this.physics.add.collider(this.pylone5, this.zoneattackU, this.grappinU5, null, this);
                this.physics.add.collider(this.pylone5, this.zoneattackD, this.grappinD5, null, this);

                this.pylone6 = this.physics.add.sprite(2300,720, "pylone").setInteractive();
                this.physics.add.collider(this.pylone6, this.zoneattack, this.grappin6, null, this);
                this.physics.add.collider(this.pylone6, this.zoneattackL, this.grappinL6, null, this);
                this.physics.add.collider(this.pylone6, this.zoneattackU, this.grappinU6, null, this);
                this.physics.add.collider(this.pylone6, this.zoneattackD, this.grappinD6, null, this);

                this.pylone7 = this.physics.add.sprite(2070,870, "pylone").setInteractive();
                this.physics.add.collider(this.pylone7, this.zoneattack, this.grappin7, null, this);
                this.physics.add.collider(this.pylone7, this.zoneattackL, this.grappinL7, null, this);
                this.physics.add.collider(this.pylone7, this.zoneattackU, this.grappinU7, null, this);
                this.physics.add.collider(this.pylone7, this.zoneattackD, this.grappinD7, null, this);

                this.pylone8 = this.physics.add.sprite(480,650, "pylone").setInteractive();
                this.physics.add.collider(this.pylone8, this.zoneattack, this.grappin8, null, this);
                this.physics.add.collider(this.pylone8, this.zoneattackL, this.grappinL8, null, this);
                this.physics.add.collider(this.pylone8, this.zoneattackU, this.grappinU8, null, this);
                this.physics.add.collider(this.pylone8, this.zoneattackD, this.grappinD8, null, this);


                this.pylone9 = this.physics.add.sprite(780,500, "pylone").setInteractive();
                this.physics.add.collider(this.pylone9, this.zoneattack, this.grappin9, null, this);
                this.physics.add.collider(this.pylone9, this.zoneattackL, this.grappinL9, null, this);
                this.physics.add.collider(this.pylone9, this.zoneattackU, this.grappinU9, null, this);
                this.physics.add.collider(this.pylone9, this.zoneattackD, this.grappinD9, null, this);

                this.pylone10 = this.physics.add.sprite(865,490, "pylone").setInteractive();
                this.physics.add.collider(this.pylone10, this.zoneattack, this.grappin10, null, this);
                this.physics.add.collider(this.pylone10, this.zoneattackL, this.grappinL10, null, this);
                this.physics.add.collider(this.pylone10, this.zoneattackU, this.grappinU10, null, this);
                this.physics.add.collider(this.pylone10, this.zoneattackD, this.grappinD10, null, this);

                this.pylone11 = this.physics.add.sprite(400,520, "pylone").setInteractive();
                this.physics.add.collider(this.pylone11, this.zoneattack, this.grappin11, null, this);
                this.physics.add.collider(this.pylone11, this.zoneattackL, this.grappinL11, null, this);
                this.physics.add.collider(this.pylone11, this.zoneattackU, this.grappinU11, null, this);
                this.physics.add.collider(this.pylone11, this.zoneattackD, this.grappinD11, null, this);

                this.pylone12 = this.physics.add.sprite(340,450, "pylone").setInteractive();
                this.physics.add.collider(this.pylone12, this.zoneattack, this.grappin12, null, this);
                this.physics.add.collider(this.pylone12, this.zoneattackL, this.grappinL12, null, this);
                this.physics.add.collider(this.pylone12, this.zoneattackU, this.grappinU12, null, this);
                this.physics.add.collider(this.pylone12, this.zoneattackD, this.grappinD12, null, this);


                this.anims.create({
                    key: 'animgolem',
                    frames: this.anims.generateFrameNumbers('golem', { start: 0, end: 10 }),
                    frameRate: 10,
                    repeat: -1
                });
                this.anims.create({
                    key: 'eteintgolem',
                    frames: this.anims.generateFrameNumbers('golem', { start: 0, end: 0 }),
                    frameRate: 10,
                    repeat: -1
                });
                //placement des golem
                this.golem1 = this.physics.add.sprite(1200,1250, "golem").setInteractive();
                this.golem1.setSize(54, 100);
                //decaler la hitbox
                this.golem1.setOffset(0, - 5);
                this.physics.add.collider(this.player, this.golem1);
                this.golem1.setImmovable();
                //this.golem.anims.play('animgolem', true);
                this.attackgolem1 = this.physics.add.sprite(800, 400, "attackgolem").setInteractive();
                this.attackgolem1.setImmovable();
                this.attackgolem1.x =this.golem1.x
                this.attackgolem1.y =this.golem1.y
                this.physics.add.collider(this.player, this.attackgolem1,this.degats,null,this);
                this.detectgolem1 = this.physics.add.sprite(800, 475, "attackgolem").setInteractive();
                this.detectgolem1.x =this.golem1.x
                this.detectgolem1.y =this.golem1.y + 75
                this.detectgolem1.setImmovable();
                this.physics.add.collider(this.player, this.detectgolem1,this.allumage1,null,this);

                this.golem2 = this.physics.add.sprite(1340,1900, "golem").setInteractive();
                this.golem2.setSize(54, 100);
                //decaler la hitbox
                this.golem2.setOffset(0, - 5);
                this.physics.add.collider(this.player, this.golem2);
                this.golem2.setImmovable();
                //this.golem.anims.play('animgolem', true);
                this.attackgolem2 = this.physics.add.sprite(800, 400, "attackgolem").setInteractive();
                this.attackgolem2.setImmovable();
                this.attackgolem2.x =this.golem2.x
                this.attackgolem2.y =this.golem2.y
                this.physics.add.collider(this.player, this.attackgolem2,this.degats,null,this);
                this.detectgolem2 = this.physics.add.sprite(800, 475, "attackgolem").setInteractive();
                this.detectgolem2.x =this.golem2.x
                this.detectgolem2.y =this.golem2.y + 75
                this.detectgolem2.setImmovable();
                this.physics.add.collider(this.player, this.detectgolem2,this.allumage2,null,this);

                this.golem3 = this.physics.add.sprite(1540,1900, "golem").setInteractive();
                this.golem3.setSize(54, 100);
                //decaler la hitbox
                this.golem3.setOffset(0, - 5);
                this.physics.add.collider(this.player, this.golem3);
                this.golem3.setImmovable();
                //this.golem.anims.play('animgolem', true);
                this.attackgolem3 = this.physics.add.sprite(800, 400, "attackgolem").setInteractive();
                this.attackgolem3.setImmovable();
                this.attackgolem3.x =this.golem3.x
                this.attackgolem3.y =this.golem3.y
                this.physics.add.collider(this.player, this.attackgolem3,this.degats,null,this);
                this.detectgolem3 = this.physics.add.sprite(800, 475, "attackgolem").setInteractive();
                this.detectgolem3.x =this.golem3.x
                this.detectgolem3.y =this.golem3.y + 75
                this.detectgolem3.setImmovable();
                this.physics.add.collider(this.player, this.detectgolem3,this.allumage3,null,this);

                this.golem4 = this.physics.add.sprite(1100,600, "golem").setInteractive();
                this.golem4.setSize(54, 100);
                //decaler la hitbox
                this.golem4.setOffset(0, - 5);
                this.physics.add.collider(this.player, this.golem4);
                this.golem4.setImmovable();
                //this.golem.anims.play('animgolem', true);
                this.attackgolem4 = this.physics.add.sprite(800, 400, "attackgolem").setInteractive();
                this.attackgolem4.setImmovable();
                this.attackgolem4.x =this.golem4.x
                this.attackgolem4.y =this.golem4.y
                this.physics.add.collider(this.player, this.attackgolem4,this.degats,null,this);
                this.detectgolem4 = this.physics.add.sprite(800, 475, "attackgolem").setInteractive();
                this.detectgolem4.x =this.golem4.x
                this.detectgolem4.y =this.golem4.y + 75
                this.detectgolem4.setImmovable();
                this.physics.add.collider(this.player, this.detectgolem4,this.allumage4,null,this);

                this.golem5 = this.physics.add.sprite(738,603, "golem").setInteractive();
                this.golem5.setSize(54, 100);
                //decaler la hitbox
                this.golem5.setOffset(0, - 5);
                this.physics.add.collider(this.player, this.golem5);
                this.golem5.setImmovable();
                //this.golem.anims.play('animgolem', true);
                this.attackgolem5 = this.physics.add.sprite(800, 400, "attackgolem").setInteractive();
                this.attackgolem5.setImmovable();
                this.attackgolem5.x =this.golem5.x
                this.attackgolem5.y =this.golem5.y
                this.physics.add.collider(this.player, this.attackgolem5,this.degats,null,this);
                this.detectgolem5 = this.physics.add.sprite(800, 475, "attackgolem").setInteractive();
                this.detectgolem5.x =this.golem5.x
                this.detectgolem5.y =this.golem5.y + 75
                this.detectgolem5.setImmovable();
                this.physics.add.collider(this.player, this.detectgolem5,this.allumage5,null,this);

                this.golem6 = this.physics.add.sprite(500,330, "golem").setInteractive();
                this.golem6.setSize(54, 100);
                //decaler la hitbox
                this.golem6.setOffset(0, - 5);
                this.physics.add.collider(this.player, this.golem6);
                this.golem6.setImmovable();
                //this.golem.anims.play('animgolem', true);
                this.attackgolem6 = this.physics.add.sprite(800, 400, "attackgolem").setInteractive();
                this.attackgolem6.setImmovable();
                this.attackgolem6.x =this.golem6.x
                this.attackgolem6.y =this.golem6.y
                this.physics.add.collider(this.player, this.attackgolem6,this.degats,null,this);
                this.detectgolem6 = this.physics.add.sprite(800, 475, "attackgolem").setInteractive();
                this.detectgolem6.x =this.golem6.x
                this.detectgolem6.y =this.golem6.y + 75
                this.detectgolem6.setImmovable();
                this.physics.add.collider(this.player, this.detectgolem6,this.allumage6,null,this);

                //placement des ennemis

                var startPoint2 = new Phaser.Math.Vector2(800, 630);
                var controlPoint12 = new Phaser.Math.Vector2(850, 630);
                var controlPoint22 = new Phaser.Math.Vector2(900, 630);
                var endPoint2 = new Phaser.Math.Vector2(950, 630);

                var curve2 = new Phaser.Curves.CubicBezier(startPoint2, controlPoint12, controlPoint22, endPoint2);

                var graphics = this.add.graphics();



                this.followvirus1= this.add.follower(curve2, 1860, 1970, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus1);
                this.followvirus1.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus1.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus1.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus1,this.degats,null,this);
                this.physics.add.collider(this.zoneattack, this.followvirus1,this.attackplayer1,null,this);

                this.followvirus1.startFollow({
                    duration: 1000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });

                this.followvirus2= this.add.follower(curve2, 1930, 1500, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus2);
                this.followvirus2.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus2.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus2.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus2,this.degats,null,this);

                this.followvirus2.startFollow({
                    duration: 1000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });

                this.followvirus3= this.add.follower(curve2, 1340, 1400, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus3);
                this.followvirus3.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus3.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus3.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus3,this.degats,null,this);

                this.followvirus3.startFollow({
                    duration: 1000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });

                this.followvirus4= this.add.follower(curve2, 1500, 1060, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus4);
                this.followvirus4.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus4.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus4.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus4,this.degats,null,this);
                this.physics.add.collider(this.zoneattack, this.followvirus4,this.attackplayer4,null,this);

                this.followvirus4.startFollow({
                    duration: 1000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });




                var startPoint3 = new Phaser.Math.Vector2(800, 600);
                var controlPoint13 = new Phaser.Math.Vector2(800, 650);
                var controlPoint23 = new Phaser.Math.Vector2(800, 710);
                var endPoint3 = new Phaser.Math.Vector2(800, 790);

                var curve3 = new Phaser.Curves.CubicBezier(startPoint3, controlPoint13, controlPoint23, endPoint3);

                var graphics = this.add.graphics();



                this.followvirus5= this.add.follower(curve3, 2000, 1720, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus5);
                this.followvirus5.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus5.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus5.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus5,this.degats,null,this);

                this.followvirus5.startFollow({
                    duration: 1000,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });


                this.followvirus6= this.add.follower(curve3, 1940, 1300, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus6);
                this.followvirus6.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus6.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus6.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus6,this.degats,null,this);

                this.followvirus6.startFollow({
                    duration: 800,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });

                this.followvirus7= this.add.follower(curve3, 2300, 1300, 'virus').setInteractive();
                this.physics.add.existing(this.followvirus7);
                this.followvirus7.anims.play('virusactif', true)
                var shape = new Phaser.Geom.Circle(96,96,96);
                this.followvirus7.setInteractive(shape, Phaser.Geom.Circle.Contains);
                this.followvirus7.setSize(32, 32);
                this.physics.add.collider(this.player, this.followvirus7,this.degats,null,this);

                this.followvirus7.startFollow({
                    duration: 800,
                    yoyo: true,
                    ease: 'Sine.easeInOut',
                    repeat : -1
                });

                this.piece = this.physics.add.sprite(5000,5000, "piece").setInteractive();
                this.physics.add.collider(this.player,this.piece, this.collectpiece, null, this)
                this.piece.setImmovable();

                this.physics.add.collider(this.zoneattack, this.followvirus1, this.attackplayer1, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus2, this.attackplayer2, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus3, this.attackplayer3, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus4, this.attackplayer4, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus5, this.attackplayer5, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus6, this.attackplayer6, null, this);
                this.physics.add.collider(this.zoneattack, this.followvirus7, this.attackplayer7, null, this);




                

                this.physics.add.collider(this.zoneattackL, this.followvirus1, this.attackLplayer1, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus2, this.attackLplayer2, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus3, this.attackLplayer3, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus4, this.attackLplayer4, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus5, this.attackLplayer5, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus6, this.attackLplayer6, null, this);
                this.physics.add.collider(this.zoneattackL, this.followvirus8, this.attackLplayer7, null, this);



                this.physics.add.collider(this.zoneattackD, this.followvirus1, this.attackDplayer1, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus2, this.attackDplayer2, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus3, this.attackDplayer3, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus3, this.attackDplayer3, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus4, this.attackDplayer4, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus5, this.attackDplayer5, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus6, this.attackDplayer6, null, this);
                this.physics.add.collider(this.zoneattackD, this.followvirus7, this.attackDplayer7, null, this);


                this.physics.add.collider(this.zoneattackU, this.followvirus1, this.attackUplayer1, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus2, this.attackUplayer2, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus3, this.attackUplayer3, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus4, this.attackUplayer4, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus5, this.attackUplayer5, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus6, this.attackUplayer6, null, this);
                this.physics.add.collider(this.zoneattackU, this.followvirus7, this.attackUplayer7, null, this);

            }


            allumage1(){ 
                //donne un délai a l'attaque pur que le joueur esquive
                setTimeout(() => {
                    this.attackgolem1.x=this.golem1.x
                    this.attackgolem1.y=this.golem1.y+70
                    }, 1000);
                this.golem1.anims.play('animgolem', true)
                //le détecteur disparait le temps de l'attaque
                this.detectgolem1.x=5000
                this.detectgolem1.y=5000

                setTimeout(() => {
                    //Tout les blocs reviennent a leur position, le golem s'éteint
                    this.detectgolem1.x=this.golem1.x
                    this.detectgolem1.y=this.golem1.y+75
                    this.attackgolem1.x=this.golem1.x
                    this.attackgolem1.y=this.golem1.y
                    this.golem1.anims.play('eteintgolem', true)
                    }, 1200);

            }


            allumage2(){ 
                //donne un délai a l'attaque pur que le joueur esquive
                setTimeout(() => {
                    this.attackgolem2.x=this.golem2.x
                    this.attackgolem2.y=this.golem2.y+70
                    }, 1000);
                this.golem2.anims.play('animgolem', true)
                //le détecteur disparait le temps de l'attaque
                this.detectgolem2.x=5000
                this.detectgolem2.y=5000

                setTimeout(() => {
                    //Tout les blocs reviennent a leur position, le golem s'éteint
                    this.detectgolem2.x=this.golem2.x
                    this.detectgolem2.y=this.golem2.y+75
                    this.attackgolem2.x=this.golem2.x
                    this.attackgolem2.y=this.golem2.y
                    this.golem2.anims.play('eteintgolem', true)
                    }, 1200);

            }

            allumage3(){ 
                //donne un délai a l'attaque pur que le joueur esquive
                setTimeout(() => {
                    this.attackgolem3.x=this.golem3.x
                    this.attackgolem3.y=this.golem3.y+70
                    }, 1000);
                this.golem3.anims.play('animgolem', true)
                //le détecteur disparait le temps de l'attaque
                this.detectgolem3.x=5000
                this.detectgolem3.y=5000

                setTimeout(() => {
                    //Tout les blocs reviennent a leur position, le golem s'éteint
                    this.detectgolem3.x=this.golem3.x
                    this.detectgolem3.y=this.golem3.y+75
                    this.attackgolem3.x=this.golem3.x
                    this.attackgolem3.y=this.golem3.y
                    this.golem3.anims.play('eteintgolem', true)
                    }, 1200);

            }

            allumage4(){ 
                //donne un délai a l'attaque pur que le joueur esquive
                setTimeout(() => {
                    this.attackgolem4.x=this.golem4.x
                    this.attackgolem4.y=this.golem4.y+70
                    }, 1000);
                this.golem4.anims.play('animgolem', true)
                //le détecteur disparait le temps de l'attaque
                this.detectgolem4.x=5000
                this.detectgolem4.y=5000

                setTimeout(() => {
                    //Tout les blocs reviennent a leur position, le golem s'éteint
                    this.detectgolem4.x=this.golem4.x
                    this.detectgolem4.y=this.golem4.y+75
                    this.attackgolem4.x=this.golem4.x
                    this.attackgolem4.y=this.golem4.y
                    this.golem4.anims.play('eteintgolem', true)
                    }, 1200);

            }

            allumage5(){ 
                //donne un délai a l'attaque pur que le joueur esquive
                setTimeout(() => {
                    this.attackgolem5.x=this.golem5.x
                    this.attackgolem5.y=this.golem5.y+70
                    }, 1000);
                this.golem5.anims.play('animgolem', true)
                //le détecteur disparait le temps de l'attaque
                this.detectgolem5.x=5000
                this.detectgolem5.y=5000

                setTimeout(() => {
                    //Tout les blocs reviennent a leur position, le golem s'éteint
                    this.detectgolem5.x=this.golem5.x
                    this.detectgolem5.y=this.golem5.y+75
                    this.attackgolem.x=this.golem5.x
                    this.attackgolem5.y=this.golem5.y
                    this.golem5.anims.play('eteintgolem', true)
                    }, 1200);

            }

            allumage6(){ 
                //donne un délai a l'attaque pur que le joueur esquive
                setTimeout(() => {
                    this.attackgolem6.x=this.golem6.x
                    this.attackgolem6.y=this.golem6.y+70
                    }, 1000);
                this.golem6.anims.play('animgolem', true)
                //le détecteur disparait le temps de l'attaque
                this.detectgolem6.x=5000
                this.detectgolem6.y=5000

                setTimeout(() => {
                    //Tout les blocs reviennent a leur position, le golem s'éteint
                    this.detectgolem6.x=this.golem6.x
                    this.detectgolem6.y=this.golem6.y+75
                    this.attackgolem6.x=this.golem3.x
                    this.attackgolem6.y=this.golem6.y
                    this.golem6.anims.play('eteintgolem', true)
                    }, 1200);

            }




            collectpiece(player,piece){ 
                piece.x = 5000
                piece.y = 5000

                score += 2; //augmente le score de 20

            }





            ouvreporte1(player,porte1){ 
                if(obtentionclef == 1){
                    this.porte1.disableBody(true,true)
                    obtentionclef -= 1
                }
            }

            ouvreporte2(player,porte2){ 
                if(obtentionclef == 1){
                    this.porte2.disableBody(true,true)
                    obtentionclef -= 1
                }
            }

            ouvreporte3(player,porte3){ 
                if(obtentionclef == 1){
                    this.porte3.disableBody(true,true)
                    obtentionclef -= 1
                }
            }


            coffreclef(player,coffre1){ 

                setTimeout(() => {
                    coffreclefouvert = false;
                }, 7000);
                coffreclefouvert = true
                obtentionclef += 1
                coffre1.anims.play('coffreouvert', true)
                coffre1.setOffset(5000,5000);


            }



            degats(player, virus) {
                

                if (PV == 3){
                    setTimeout(() => {
                        this.player.setOffset(0, 15);
                    }, 1000);
                    this.player.setOffset(5000,5000);
                    player.alpha = 0.5
                    this.serolReset = this.time.addEvent({
                        delay: 1000,
                        callback: ()=>{
                            player.alpha = 1;
                        },
                        loop: false
                    })
                    PV -= 1//si le virus nous touche, on perd un PV
                    console.log("aie")
                    this.deuxcoeurs.visible = true;
                    this.fullcoeur.visible = false;
                    
                } else if (PV == 2){
                    setTimeout(() => {
                        this.player.setOffset(0, 15);
                    }, 1000);
                    this.player.setOffset(5000,5000);
                    player.alpha = 0.5
                    this.serolReset = this.time.addEvent({
                        delay: 1000,
                        callback: ()=>{
                            player.alpha = 1;
                        },
                        loop: false
                    })
                    PV -= 1//si le virus nous touche, on perd un PV
                    console.log("aie2")
                    this.uncoeur.visible = true;
                    this.deuxcoeurs.visible = false;
                    
                } else if (PV == 1){
                    this.scene.start("gameover")
                
                }
            }





            attackplayer1() {
                this.followvirus1.destroy()
                this.piece.x = this.followvirus1.x
                this.piece.y = this.followvirus1.y
                PVennemy -= 1;
                
                


            }

            attackLplayer1() {
                this.piece.x = this.followvirus1.x
                this.piece.y = this.followvirus1.y
                PVennemy -= 1;
                this.followvirus1.destroy()


            }

            attackDplayer1() {
                this.piece.x = this.followvirus1.x
                this.piece.y = this.followvirus1.y
                PVennemy -= 1;
                this.followvirus1.destroy()

            }

            attackUplayer1() {
                this.piece.x = this.followvirus1.x
                this.piece.y = this.followvirus1.y
                PVennemy -= 1;
                this.followvirus1.destroy()

            }



            attackplayer2() {
                this.followvirus2.destroy()
                this.piece.x = this.followvirus2.x
                this.piece.y = this.followvirus2.y
                PVennemy -= 1;
                
                


            }

            attackLplayer2() {
                this.piece.x = this.followvirus2.x
                this.piece.y = this.followvirus2.y
                PVennemy -= 1;
                this.followvirus2.destroy()


            }

            attackDplayer2() {
                this.piece.x = this.followvirus2.x
                this.piece.y = this.followvirus2.y
                PVennemy -= 1;
                this.followvirus2.destroy()

            }

            attackUplayer2() {
                this.piece.x = this.followvirus2.x
                this.piece.y = this.followvirus2.y
                PVennemy -= 1;
                this.followvirus2.destroy()

            }




            attackplayer3() {
                this.piece.x = this.followvirus3.x
                this.piece.y = this.followvirus3.y
                PVennemy -= 1;
                this.followvirus3.destroy()


            }

            attackLplayer3() {
                this.piece.x = this.followvirus3.x
                this.piece.y = this.followvirus3.y
                PVennemy -= 1;
                this.followvirus3.destroy()


            }

            attackDplayer3() {
                this.piece.x = this.followvirus3.x
                this.piece.y = this.followvirus3.y
                PVennemy -= 1;
                this.followvirus3.destroy()

            }

            attackUplayer3() {
                this.piece.x = this.followvirus3.x
                this.piece.y = this.followvirus3.y
                PVennemy -= 1;
                this.followvirus3.destroy()

            }

            attackplayer4() {
                this.followvirus4.destroy()
                this.piece.x = this.followvirus4.x
                this.piece.y = this.followvirus4.y
                PVennemy -= 1;
                
                


            }

            attackLplayer4() {
                this.piece.x = this.followvirus4.x
                this.piece.y = this.followvirus4.y
                PVennemy -= 1;
                this.followvirus4.destroy()


            }

            attackDplayer4() {
                this.piece.x = this.followvirus4.x
                this.piece.y = this.followvirus4.y
                PVennemy -= 1;
                this.followvirus4.destroy()

            }

            attackUplayer4() {
                this.piece.x = this.followvirus4.x
                this.piece.y = this.followvirus4.y
                PVennemy -= 1;
                this.followvirus4.destroy()

            }

            attackplayer5() {
                this.followvirus5.destroy()
                this.piece.x = this.followvirus5.x
                this.piece.y = this.followvirus5.y
                PVennemy -= 1;
                
                


            }

            attackLplayer5() {
                this.piece.x = this.followvirus5.x
                this.piece.y = this.followvirus5.y
                PVennemy -= 1;
                this.followvirus5.destroy()


            }

            attackDplayer5() {
                this.piece.x = this.followvirus5.x
                this.piece.y = this.followvirus5.y
                PVennemy -= 1;
                this.followvirus5.destroy()

            }

            attackUplayer5() {
                this.piece.x = this.followvirus5.x
                this.piece.y = this.followvirus5.y
                PVennemy -= 1;
                this.followvirus5.destroy()

            }

            attackplayer6() {
                this.followvirus6.destroy()
                this.piece.x = this.followvirus6.x
                this.piece.y = this.followvirus6.y
                PVennemy -= 1;
                
                


            }

            attackLplayer6() {
                this.piece.x = this.followvirus6.x
                this.piece.y = this.followvirus6.y
                PVennemy -= 1;
                this.followvirus6.destroy()


            }

            attackDplayer6() {
                this.piece.x = this.followvirus6.x
                this.piece.y = this.followvirus6.y
                PVennemy -= 1;
                this.followvirus6.destroy()

            }

            attackUplayer6() {
                this.piece.x = this.followvirus6.x
                this.piece.y = this.followvirus6.y
                PVennemy -= 1;
                this.followvirus6.destroy()

            }

            attackplayer7() {
                this.followvirus7.destroy()
                this.piece.x = this.followvirus7.x
                this.piece.y = this.followvirus7.y
                PVennemy -= 1;
                
                


            }

            attackLplayer7() {
                this.piece.x = this.followvirus7.x
                this.piece.y = this.followvirus7.y
                PVennemy -= 1;
                this.followvirus7.destroy()


            }

            attackDplayer7() {
                this.piece.x = this.followvirus7.x
                this.piece.y = this.followvirus7.y
                PVennemy -= 1;
                this.followvirus7.destroy()

            }

            attackUplayer7() {
                this.piece.x = this.followvirus7.x
                this.piece.y = this.followvirus7.y
                PVennemy -= 1;
                this.followvirus7.destroy()

            }













                grappin() {
                    this.player.x = this.pylone.x
                    this.player.y = this.pylone.y;

                }

                grappinL() {
                    this.player.x = this.pylone.x
                    this.player.y = this.pylone.y;

                }
                grappinD() {
                    this.player.x = this.pylone.x
                    this.player.y = this.pylone.y;

                }
                grappinU() {
                    this.player.x = this.pylone.x
                    this.player.y = this.pylone.y;

                }



                grappin1() {
                    this.player.x = this.pylone1.x
                    this.player.y = this.pylone1.y;

                }

                grappinL1() {
                    this.player.x = this.pylone1.x
                    this.player.y = this.pylone1.y;

                }
                grappinD1() {
                    this.player.x = this.pylone1.x
                    this.player.y = this.pylone1.y;

                }
                grappinU1() {
                    this.player.x = this.pylone1.x
                    this.player.y = this.pylone1.y;

                }

                grappin2() {
                    this.player.x = this.pylone2.x
                    this.player.y = this.pylone2.y;

                }

                grappinL2() {
                    this.player.x = this.pylone2.x
                    this.player.y = this.pylone2.y;

                }
                grappinD2() {
                    this.player.x = this.pylone2.x
                    this.player.y = this.pylone2.y;

                }
                grappinU2() {
                    this.player.x = this.pylone2.x
                    this.player.y = this.pylone2.y;

                }


                grappin3() {
                    this.player.x = this.pylone3.x
                    this.player.y = this.pylone3.y;

                }

                grappinL3() {
                    this.player.x = this.pylone3.x
                    this.player.y = this.pylone3.y;

                }
                grappinD3() {
                    this.player.x = this.pylone3.x
                    this.player.y = this.pylone3.y;

                }
                grappinU3() {
                    this.player.x = this.pylone3.x
                    this.player.y = this.pylone3.y;

                }

                grappin4() {
                    this.player.x = this.pylone4.x
                    this.player.y = this.pylone4.y;

                }

                grappinL4() {
                    this.player.x = this.pylone4.x
                    this.player.y = this.pylone4.y;

                }
                grappinD4() {
                    this.player.x = this.pylone4.x
                    this.player.y = this.pylone4.y;

                }
                grappinU4() {
                    this.player.x = this.pylone4.x
                    this.player.y = this.pylone4.y;

                }

                grappin5() {
                    this.player.x = this.pylone5.x
                    this.player.y = this.pylone5.y;

                }

                grappinL5() {
                    this.player.x = this.pylone5.x
                    this.player.y = this.pylone5.y;

                }
                grappinD5() {
                    this.player.x = this.pylone5.x
                    this.player.y = this.pylone5.y;

                }
                grappinU5() {
                    this.player.x = this.pylone5.x
                    this.player.y = this.pylone5.y;

                }

                grappin6() {
                    this.player.x = this.pylone6.x
                    this.player.y = this.pylone6.y;

                }

                grappinL6() {
                    this.player.x = this.pylone6.x
                    this.player.y = this.pylone6.y;

                }
                grappinD6() {
                    this.player.x = this.pylone6.x
                    this.player.y = this.pylone6.y;

                }
                grappinU6() {
                    this.player.x = this.pylone6.x
                    this.player.y = this.pylone6.y;

                }

                grappin7() {
                    this.player.x = this.pylone7.x
                    this.player.y = this.pylone7.y;

                }

                grappinL7() {
                    this.player.x = this.pylone7.x
                    this.player.y = this.pylone7.y;

                }
                grappinD7() {
                    this.player.x = this.pylone7.x
                    this.player.y = this.pylone7.y;

                }
                grappinU7() {
                    this.player.x = this.pylone7.x
                    this.player.y = this.pylone7.y;

                }

                grappin8() {
                    this.player.x = this.pylone8.x
                    this.player.y = this.pylone8.y;

                }

                grappinL8() {
                    this.player.x = this.pylone8.x
                    this.player.y = this.pylone8.y;

                }
                grappinD8() {
                    this.player.x = this.pylone8.x
                    this.player.y = this.pylone8.y;

                }
                grappinU8() {
                    this.player.x = this.pylone8.x
                    this.player.y = this.pylone8.y;

                }

                grappin9() {
                    this.player.x = this.pylone9.x
                    this.player.y = this.pylone9.y;

                }

                grappinL9() {
                    this.player.x = this.pylone9.x
                    this.player.y = this.pylone9.y;

                }
                grappinD9() {
                    this.player.x = this.pylon9.x
                    this.player.y = this.pylone9.y;

                }
                grappinU9() {
                    this.player.x = this.pylone9.x
                    this.player.y = this.pylone9.y;

                }

                grappin10() {
                    this.player.x = this.pylone10.x
                    this.player.y = this.pylone10.y;

                }

                grappinL10() {
                    this.player.x = this.pylone10.x
                    this.player.y = this.pylone10.y;

                }
                grappinD10() {
                    this.player.x = this.pylone10.x
                    this.player.y = this.pylone10.y;

                }
                grappinU10() {
                    this.player.x = this.pylone10.x
                    this.player.y = this.pylone10.y;

                }

                grappin11() {
                    this.player.x = this.pylone11.x
                    this.player.y = this.pylone11.y;

                }

                grappinL11() {
                    this.player.x = this.pylone11.x
                    this.player.y = this.pylone11.y;

                }
                grappinD11() {
                    this.player.x = this.pylone11.x
                    this.player.y = this.pylone11.y;

                }
                grappinU11() {
                    this.player.x = this.pylone11.x
                    this.player.y = this.pylone11.y;

                }

                grappin12() {
                    this.player.x = this.pylone12.x
                    this.player.y = this.pylone7.y;

                }

                grappinL7() {
                    this.player.x = this.pylone12.x
                    this.player.y = this.pylone7.y;

                }
                grappinD12() {
                    this.player.x = this.pylone12.x
                    this.player.y = this.pylone7.y;

                }
                grappinU12() {
                    this.player.x = this.pylone12.x
                    this.player.y = this.pylone12.y;

                }












                smash(marteau, boite) {
                    this.boite.disableBody(true,true);
                    console.log("ouch")

                }

                smashV(marteauV, boite) {
                    this.boite.disableBody(true,true);
                    console.log("ouch")

                }

            update() {



                this.scoreText.setText(score)

               if(obtentionclef == 1){
                this.clefui.visible = true;
               }
               else if (obtentionclef == 0){
                this.clefui.visible = false;
               }

               if(coffreclefouvert == true){
                this.containerclef.visible = true;
               }
               else if (coffreclefouvert == false){
                this.containerclef.visible = false;
               }








                if (arret == true) {

                    this.player.setVelocityX(0);
                    this.player.setVelocityY(0);

                }

                //fonction attaque
                if (keyZ.isDown && petit == false && this.cursors.right.isDown) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    this.cursors.right.enabled = false;
                    arret = true
                    this.zoneattack.y = this.player.y
                    this.zoneattack.x = this.player.x + 70
                    setTimeout(() => {
                        this.zoneattack.y = 100
                        this.zoneattack.x = 100
                        arret = false
                        this.cursors.right.enabled = true;
                    }, 400);
                }
                else if (keyZ.isDown && petit == true && this.cursors.right.isDown) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattack.y = this.player.y
                    this.zoneattack.x = this.player.x + 40
                    setTimeout(() => {
                        this.zoneattack.y = 100
                        this.zoneattack.x = 100
                        arret = false
                    }, 400);
                }

                if (keyZ.isDown && petit == false && this.cursors.left.isDown) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattackL.y = this.player.y
                    this.zoneattackL.x = this.player.x - 65
                    setTimeout(() => {
                        this.zoneattackL.y = 100
                        this.zoneattackL.x = 100
                        arret = false
                    }, 400);
                }
                else if (keyZ.isDown && petit == true && this.cursors.left.isDown) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattackL.y = this.player.y
                    this.zoneattackL.x = this.player.x - 30
                    setTimeout(() => {
                        this.zoneattackL.y = 100
                        this.zoneattackL.x = 100
                        arret = false
                    }, 400);
                }

                if (keyZ.isDown && petit == false && this.cursors.down.isDown) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattackD.y = this.player.y + 65
                    this.zoneattackD.x = this.player.x 
                    setTimeout(() => {
                        this.zoneattackD.y = 100
                        this.zoneattackD.x = 100
                        arret = false
                    }, 400);
                }
                else if (keyZ.isDown && petit == true && this.cursors.down.isDown) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattackD.y = this.player.y + 30
                    this.zoneattackD.x = this.player.x 
                    setTimeout(() => {
                        this.zoneattackD.y = 100
                        this.zoneattackD.x = 100
                        arret = false
                    }, 400);
                }

                    if (keyZ.isDown && petit == false && this.cursors.up.isDown) {
                        this.cursors.right.reset();
                        this.cursors.left.reset();
                        this.cursors.up.reset();
                        this.cursors.down.reset();
                        arret = true
                        this.zoneattackU.y = this.player.y - 65
                        this.zoneattackU.x = this.player.x 
                        setTimeout(() => {
                            this.zoneattackU.y = 100
                            this.zoneattackU.x = 100
                            
                        }, 400);
                        }
                        else if (keyZ.isDown && petit == true && this.cursors.up.isDown) {
                        this.cursors.right.reset();
                        this.cursors.left.reset();
                        this.cursors.up.reset();
                        this.cursors.down.reset();
                        arret = true
                        this.zoneattackU.y = this.player.y - 30
                        this.zoneattackU.x = this.player.x 
                        setTimeout(() => {
                            this.zoneattackU.y = 100
                            this.zoneattackU.x = 100
                            arret = false
                        }, 400);
                    }


                    //fonction marteau
                if (keyE.isDown && petit == false && this.cursors.right.isDown) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    this.cursors.right.enabled = false;
                    arret = true
                    this.marteauR.y = this.player.y + 10
                    this.marteauR.x = this.player.x + 35
                    setTimeout(() => {
                        this.marteauR.y = 100
                        this.marteauR.x = 100
                        arret = false
                        this.cursors.right.enabled = true;
                    }, 400);
                }
                else if (keyE.isDown && petit == true && this.cursors.right.isDown) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauR.y = this.player.y + 5
                    this.marteauR.x = this.player.x + 20
                    setTimeout(() => {
                        this.marteauR.y = 100
                        this.marteauR.x = 100
                        arret = false
                    }, 400);
                }

                if (keyE.isDown && petit == false && this.cursors.left.isDown) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauL.y = this.player.y + 10
                    this.marteauL.x = this.player.x -35
                    setTimeout(() => {
                        this.marteauL.y = 100
                        this.marteauL.x = 100
                        arret = false
                    }, 400);
                }
                else if (keyE.isDown && petit == true && this.cursors.left.isDown ) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauL.y = this.player.y + 5
                    this.marteauL.x = this.player.x - 20
                    setTimeout(() => {
                        this.marteauL.y = 100
                        this.marteauL.x = 100
                        arret = false
                    }, 400);
                }

                if (keyE.isDown && petit == false && this.cursors.down.isDown) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauD.y = this.player.y + 40
                    this.marteauD.x = this.player.x 
                    setTimeout(() => {
                        this.marteauD.y = 100
                        this.marteauD.x = 100
                        arret = false
                    }, 400);
                }
                else if (keyE.isDown && petit == true && this.cursors.down.isDown) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauD.y = this.player.y + 20
                    this.marteauD.x = this.player.x 
                    setTimeout(() => {
                        this.marteauD.y = 100
                        this.marteauD.x = 100
                        arret = false
                    }, 400);
                }

                if (keyE.isDown && petit == false && this.cursors.up.isDown) {
                        this.cursors.right.reset();
                        this.cursors.left.reset();
                        this.cursors.up.reset();
                        this.cursors.down.reset();
                        arret = true
                        this.marteauU.y = this.player.y - 25
                        this.marteauU.x = this.player.x 
                        setTimeout(() => {
                            this.marteauU.y = 100
                            this.marteauU.x = 100
                            arret = false
                        }, 400);
                        }
                        else if (keyE.isDown && petit == true && this.cursors.up.isDown) {
                        this.cursors.right.reset();
                        this.cursors.left.reset();
                        this.cursors.up.reset();
                        this.cursors.down.reset();
                        arret = true
                        this.marteauU.y = this.player.y - 15
                        this.marteauU.x = this.player.x 
                        setTimeout(() => {
                            this.marteauU.y = 100
                            this.marteauU.x = 100
                            arret = false
                        }, 400);
                }

                //fonction minimize
                if (keyA.isDown && petit == false ) {
                    this.player.setScale(0.5)
                    this.zoneattack.setScale(0.5)
                    this.zoneattackL.setScale(0.5)
                    this.zoneattackU.setScale(0.5)
                    this.zoneattackD.setScale(0.5)
                    this.marteauR.setScale(0.5)
                    this.marteauL.setScale(0.5)
                    this.marteauD.setScale(0.5)
                    this.marteauU.setScale(0.5)
                    setTimeout(() => {
                        petit = true;

                    }, 200);
                }
                else if (keyA.isDown && petit == true ) {
                    this.player.setScale(1)
                    this.zoneattack.setScale(1)
                    this.zoneattackL.setScale(1)
                    this.zoneattackD.setScale(1)
                    this.zoneattackU.setScale(1)
                    this.marteauR.setScale(1)
                    this.marteauU.setScale(1)
                    this.marteauL.setScale(1)
                    this.marteauD.setScale(1)
                    setTimeout(() => {
                        petit = false;

                    }, 200);





                }
                if (this.cursors.left.isDown) { //si la touche gauche est appuyée
                    this.player.setVelocityX(-160); //alors vitesse négative en X
                    this.player.anims.play('left', true); //et animation => gauche
                }
                else if (this.cursors.right.isDown) { //sinon si la touche droite est appuyée
                    this.player.setVelocityX(160); //alors vitesse positive en X
                    this.player.anims.play('right', true); //et animation => droite
                }
                else { // sinon
                    this.player.setVelocityX(0); //vitesse nulle
                    //this.player.anims.play('turn', true); //animation fait face caméra
                    turn = true;
                }

                if (this.cursors.up.isDown) {
                    //si touche haut appuyée ET que le perso touche le sol
                    this.player.setVelocityY(-160); //alors vitesse verticale négative
                    this.player.anims.play('up', true);

                }
                else if (this.cursors.down.isDown) {
                    //si touche haut appuyée ET que le perso touche le sol
                    this.player.setVelocityY(160); //alors vitesse verticale négative
                    this.player.anims.play('down', true);

                }
                else {
                    //si touche haut appuyée ET que le perso touche le sol
                    this.player.setVelocityY(0); //alors vitesse verticale négative
                    if (turn == true) {
                        this.player.anims.play('turn', true); //animation fait face caméra
                        //(on saute)
                    }
                }

                turn = false;

                if (this.gameOver) { return; }

            }

            tpsortietemple(player, sortietemple) {
                this.sortieT = true
                console.log("trueT")
                this.scene.start("niveaumontagne",{
                sortieT : this.sortieT,
                PV : this.PV,
                obtentionmasque : this.obtentionmasque,
                obtentionyoyo : this.obtentionyoyo,
            });}

            tpentreerelique(player, entreerelique) {
                this.sortieT = true
                console.log("trueT")
                this.scene.start("sallerelique",{
                sortieT : this.sortieT,
                PV : this.PV,
                obtentionmasque : this.obtentionmasque,
                obtentionyoyo : this.obtentionyoyo,
            });}


        }







        class sallerelique extends Phaser.Scene {


            constructor() {

                super("sallerelique")
            }

            init(data) { 
                this.sortieT = sortieT; 
                this. PV = data.PV;
                this.score = data.score
                this.obtentionmasque = data.obtentionmasque;
                this.obtentionyoyo = data.obtentionyoyo;

            }




            preload() {
                // chargement tuiles de jeu
                this.load.image("Phaser_Tileset", "assets/placeholdernew.png");

                // chargement de la carte
                this.load.tilemapTiledJSON("carterelique", "assets/sallerelique.json");

                

                this.load.spritesheet('perso', 'assets/protopetit.png',
                    { frameWidth: 32, frameHeight: 48 });

                    this.load.spritesheet("zoneattack", "assets/zoneattack.png", {
                    frameWidth: 96,
                    frameHeight: 48,
                });

                this.load.spritesheet("masque", "assets/masque.png", {
                    frameWidth: 28,
                    frameHeight: 28,
                });

                this.load.spritesheet("zoneattackL", "assets/zoneattackL.png", {
                    frameWidth: 96,
                    frameHeight: 48,
                });

                this.load.spritesheet("entreeplage", "assets/entreeplage.png", {
                    frameWidth: 32,
                    frameHeight: 32,
                });

                this.load.spritesheet("zoneattackD", "assets/zoneattackD.png", {
                    frameWidth: 48,
                    frameHeight: 96,
                });

                this.load.spritesheet("zoneattackU", "assets/zoneattackU.png", {
                    frameWidth: 48,
                    frameHeight: 96,
                });

                this.load.spritesheet("marteau", "assets/marteau.png", {
                    frameWidth: 38,
                    frameHeight: 38,
                });

                this.load.spritesheet("pylone", "assets/pylone.png", {
                    frameWidth: 38,
                    frameHeight: 38,
                });

                this.load.spritesheet("boite", "assets/boite.png", {
                    frameWidth: 39,
                    frameHeight: 46,
                });

                this.load.spritesheet("boiteP", "assets/boiteP.png", {
                    frameWidth: 27,
                    frameHeight: 46,
                });

                this.load.spritesheet("marteauV", "assets/marteauV.png", {
                    frameWidth: 38,
                    frameHeight: 38,
                });

                this.load.spritesheet("marteauD", "assets/marteauD.png", {
                    frameWidth: 25,
                    frameHeight: 34,
                });

                this.load.spritesheet("marteauU", "assets/marteauU.png", {
                    frameWidth: 25,
                    frameHeight: 35,
                });

                this.load.spritesheet("marteauL", "assets/marteauL.png", {
                    frameWidth: 40,
                    frameHeight: 25,
                });

                this.load.spritesheet("marteauR", "assets/marteauR.png", {
                    frameWidth: 40,
                    frameHeight: 25,
                });

                
                this.load.image('FondUI', 'assets/fondUI.png');
                this.load.image('fullcoeur', 'assets/fullcoeur.png');
                this.load.image('deuxcoeurs', 'assets/deuxcoeurs.png');
                this.load.image('uncoeur', 'assets/uncoeur.png');
                this.load.image('boiteeboule1', 'assets/boiteeboule1.png');
                this.load.image('boiteeboule2', 'assets/boiteeboule2.png');
                this.load.image('boiteeboule3', 'assets/boiteeboule3.png');

            }


            create() {

                // chargement de la carte du niveau
               const carteDuNiveau = this.add.tilemap("carterelique");
                // chargement du jeu de tuiles
                const tileset = carteDuNiveau.addTilesetImage(
                    "placeholdernew",
                    "Phaser_Tileset"
                );



                // chargement du calque "calque_backgroung"
                const backgroundLayer = carteDuNiveau.createLayer(
                    "sol",
                    tileset
                );

                // chargement du calque "calque_backgroung"
                const motifs = carteDuNiveau.createLayer(
                    "motif sol",
                    tileset
                );

                // chargement du second calque "calque_backgroung"
                const blocsrelique = carteDuNiveau.createLayer(
                    "blocs",
                    tileset
                );
                petit = false
                sortieT = true
                this.player = this.physics.add.sprite(400,1000, 'perso');
                //this.player = this.physics.add.sprite(1440,2010, 'perso');
                //taille de la hitbox 1440,2010
                this.player.setSize(32, 32);
                //decaler la hitbox
                this.player.setOffset(0, 15);
                this.anims.create({
                    key: 'left',
                    frames: this.anims.generateFrameNumbers('perso', { start: 0, end: 1 }),
                    frameRate: 10,
                    repeat: -1
                });
                this.anims.create({
                    key: 'turn',
                    frames: [{ key: 'perso', frame: 2 }],
                    frameRate: 20
                });
                this.anims.create({
                    key: 'right',
                    frames: this.anims.generateFrameNumbers('perso', { start: 3, end: 4 }),
                    frameRate: 10,
                    repeat: -1
                });

                this.anims.create({
                    key: 'up',
                    frames: this.anims.generateFrameNumbers('perso', { start: 8, end: 9 }),
                    frameRate: 10,
                    repeat: 1
                });

                this.anims.create({
                    key: 'down',
                    frames: this.anims.generateFrameNumbers('perso', { start: 5, end: 6 }),
                    frameRate: 10,
                    repeat: -1
                });

                blocsrelique.setCollisionByProperty({ solide: true });

                this.physics.add.collider(this.player, blocsrelique);

                this.cursors = this.input.keyboard.createCursorKeys();

                this.zoneattack = this.physics.add.sprite(100, 100, "zoneattack").setInteractive();
                this.physics.add.collider(this.zoneattack, this.virus, this.attackplayer, null, this);

                this.zoneattackL = this.physics.add.sprite(100, 100, "zoneattackL").setInteractive();
                this.physics.add.collider(this.zoneattackL, this.virus, this.attackLplayer, null, this);

                this.zoneattackD = this.physics.add.sprite(100, 100, "zoneattackD").setInteractive();
                this.physics.add.collider(this.zoneattackD, this.virus, this.attackDplayer, null, this);

                this.zoneattackU = this.physics.add.sprite(100, 100, "zoneattackU").setInteractive();
                this.physics.add.collider(this.zoneattackU, this.virus, this.attackUplayer, null, this);

                //hitbox du marteau
                this.marteauR = this.physics.add.sprite(100, 100, "marteauR").setInteractive();

                this.physics.add.collider(this.marteauR, this.boite, this.smash, null, this);

                this.marteauU = this.physics.add.sprite(100, 100, "marteauU").setInteractive();

                this.physics.add.collider(this.marteauU, this.boite, this.smashV, null, this);

                this.marteauL = this.physics.add.sprite(100, 100, "marteauL").setInteractive();

                this.physics.add.collider(this.marteauL, this.boite, this.smashV, null, this);

                this.marteauD = this.physics.add.sprite(100, 100, "marteauD").setInteractive();
                this.physics.add.collider(this.marteauD, this.boite, this.smashV, null, this);

                this.cameras.main.setBounds(0, 0, 800,1152);
                this.cameras.main.startFollow(this.player);

                this.sortietemple = this.physics.add.sprite(1440,2100, "sortietemple").setInteractive();
                this.sortietemple.setImmovable();
                this.sortietemple.setSize(48, 32);
                this.physics.add.collider(this.sortietemple, this.player, this.tpsortietemple, null, this);

                this.masque = this.physics.add.sprite(400,240, "masque").setInteractive();
                this.masque.setImmovable();
                this.masque.setSize(40, 40);
                this.physics.add.collider(this.masque, this.player, this.eboulement, null, this);



                keyA = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.A);
                keyZ = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.Z);
                keyE = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.E);

                this.add.image(550,290, 'FondUI').setScrollFactor(0);

                
                this.fullcoeur = this.add.image(550,290, 'fullcoeur').setScrollFactor(0);
                this.fullcoeur.visible = false;
                this.deuxcoeurs = this.add.image(550,290, 'deuxcoeurs').setScrollFactor(0);
                this.deuxcoeurs.visible = false;
                this.uncoeur = this.add.image(550,290, 'uncoeur').setScrollFactor(0);
                this.uncoeur.visible = false;
                this.scoreText=this.add.text(115,100,score,{fontSize:'64px',fill:'#FFFFFF',strokeThickness: 6, stroke:'#000000'}).setScrollFactor(0);
                this.scoreText.setText(score); //met à jour l’affichage du score

                if(PV == 3){
                    this.fullcoeur.visible = true;
                }
                else if (PV == 2){
                    this.deuxcoeurs.visible = true;
                }
                else if (PV == 1){
                    this.uncoeur.visible = true;
                }


                this.boiteeboule1 = this.add.sprite(550, 475, 'boiteeboule1').setScrollFactor(0);
                this.boiteeboule1.alpha = 0.8;
                this.boiteeboule1.visible = false;

                this.boiteeboule2 = this.add.sprite(550, 475, 'boiteeboule2').setScrollFactor(0);
                this.boiteeboule2.alpha = 0.8;
                this.boiteeboule2.visible = false;

                this.boiteeboule3 = this.add.sprite(550, 475, 'boiteeboule3').setScrollFactor(0);
                this.boiteeboule3.alpha = 0.8;
                this.boiteeboule3.visible = false;



            }

            eboulement(player, masque) {
                    obtentionmasque += 1
                    player.scene.cameras.main.shake(2500,0.05)
                    
                    this.masque.disableBody (true,true);
                    this.sortieT = true
                    this.incident = true
                    setTimeout(() => {
                        setTimeout(() => {
                            setTimeout(() => {
                                setTimeout(() => {
                                console.log("trueT")
                                    this.scene.start("niveaumontagne",{
                                    sortieT : this.sortieT,
                                    chronometre : this.chronometre,
                                    incident : this.incident,
                                    obtentionmasque : this.obtentionmasque,
                                    PV : this.PV,
                                    score : this.score,
                                    obtentionyoyo : this.obtentionyoyo,

                                });

                    }, 1000);
                    
                        eboule3 = false;
                    }, 4000);
                    eboule3 = true;
                        eboule2 = false;
                    }, 4000);
                    eboule2 = true;
                        eboule1 = false;
                    }, 4000);
                    eboule1 = true;



                   
                    
                    



            }




            attackplayer(zoneattack, virus) {
                    PVennemy -= 1;

                }

                attackLplayer(zoneattack, virus) {
                    PVennemy -= 1;

                }

                attackDplayer(zoneattackD, virus) {
                    PVennemy -= 1;

                }

                attackUplayer(zoneattackU, virus) {
                    PVennemy -= 1;

                }

                grappin(zoneattack, pylone) {
                    this.player.x = this.pylone.x
                    this.player.y = this.pylone.y;

                }

                grappinL(zoneattackL, pylone) {
                    this.player.x = this.pylone.x
                    this.player.y = this.pylone.y;

                }
                grappinD(zoneattackD, pylone) {
                    this.player.x = this.pylone.x
                    this.player.y = this.pylone.y;

                }
                grappinU(zoneattackU, pylone) {
                    this.player.x = this.pylone.x
                    this.player.y = this.pylone.y;

                }

                smash(marteau, boite) {
                    this.boite.disableBody(true,true);
                    console.log("ouch")

                }

                smashV(marteauV, boite) {
                    this.boite.disableBody(true,true);
                    console.log("ouch")
                }



            update() {


                if(eboule1 == true){
                this.boiteeboule1.visible = true;
               }
               else if (eboule1 == false){
                this.boiteeboule1.visible = false;
               }

               if(eboule2 == true){
                this.boiteeboule2.visible = true;
               }
               else if (eboule2 == false){
                this.boiteeboule2.visible = false;
               }

               if(eboule3 == true){
                this.boiteeboule3.visible = true;
               }
               else if (eboule3 == false){
                this.boiteeboule3.visible = false;
               }

                if (PVennemy == 0) {
                    this.virus.disableBody(true, true)
                }

                if (arret == true) {

                    this.player.setVelocityX(0);
                    this.player.setVelocityY(0);

                }

                //fonction attaque
                if (keyZ.isDown && petit == false && this.cursors.right.isDown) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    this.cursors.right.enabled = false;
                    arret = true
                    this.zoneattack.y = this.player.y
                    this.zoneattack.x = this.player.x + 70
                    setTimeout(() => {
                        this.zoneattack.y = 100
                        this.zoneattack.x = 100
                        arret = false
                        this.cursors.right.enabled = true;
                    }, 400);
                }
                else if (keyZ.isDown && petit == true && this.cursors.right.isDown) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattack.y = this.player.y
                    this.zoneattack.x = this.player.x + 40
                    setTimeout(() => {
                        this.zoneattack.y = 100
                        this.zoneattack.x = 100
                        arret = false
                    }, 400);
                }

                if (keyZ.isDown && petit == false && this.cursors.left.isDown) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattackL.y = this.player.y
                    this.zoneattackL.x = this.player.x - 65
                    setTimeout(() => {
                        this.zoneattackL.y = 100
                        this.zoneattackL.x = 100
                        arret = false
                    }, 400);
                }
                else if (keyZ.isDown && petit == true && this.cursors.left.isDown) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattackL.y = this.player.y
                    this.zoneattackL.x = this.player.x - 30
                    setTimeout(() => {
                        this.zoneattackL.y = 100
                        this.zoneattackL.x = 100
                        arret = false
                    }, 400);
                }

                if (keyZ.isDown && petit == false && this.cursors.down.isDown) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattackD.y = this.player.y + 65
                    this.zoneattackD.x = this.player.x 
                    setTimeout(() => {
                        this.zoneattackD.y = 100
                        this.zoneattackD.x = 100
                        arret = false
                    }, 400);
                }
                else if (keyZ.isDown && petit == true && this.cursors.down.isDown) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.zoneattackD.y = this.player.y + 30
                    this.zoneattackD.x = this.player.x 
                    setTimeout(() => {
                        this.zoneattackD.y = 100
                        this.zoneattackD.x = 100
                        arret = false
                    }, 400);
                }

                    if (keyZ.isDown && petit == false && this.cursors.up.isDown) {
                        this.cursors.right.reset();
                        this.cursors.left.reset();
                        this.cursors.up.reset();
                        this.cursors.down.reset();
                        arret = true
                        this.zoneattackU.y = this.player.y - 65
                        this.zoneattackU.x = this.player.x 
                        setTimeout(() => {
                            this.zoneattackU.y = 100
                            this.zoneattackU.x = 100
                            arret = false
                        }, 400);
                        }
                        else if (keyZ.isDown && petit == true && this.cursors.up.isDown) {
                        this.cursors.right.reset();
                        this.cursors.left.reset();
                        this.cursors.up.reset();
                        this.cursors.down.reset();
                        arret = true
                        this.zoneattackU.y = this.player.y - 30
                        this.zoneattackU.x = this.player.x 
                        setTimeout(() => {
                            this.zoneattackU.y = 100
                            this.zoneattackU.x = 100
                            arret = false
                        }, 400);
                    }


                        //fonction marteau
                if (keyE.isDown && petit == false && this.cursors.right.isDown) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    this.cursors.right.enabled = false;
                    arret = true
                    this.marteauR.y = this.player.y + 10
                    this.marteauR.x = this.player.x + 35
                    setTimeout(() => {
                        this.marteauR.y = 100
                        this.marteauR.x = 100
                        arret = false
                        this.cursors.right.enabled = true;
                    }, 400);
                }
                else if (keyE.isDown && petit == true && this.cursors.right.isDown) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauR.y = this.player.y + 5
                    this.marteauR.x = this.player.x + 20
                    setTimeout(() => {
                        this.marteauR.y = 100
                        this.marteauR.x = 100
                        arret = false
                    }, 400);
                }

                if (keyE.isDown && petit == false && this.cursors.left.isDown) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauL.y = this.player.y + 10
                    this.marteauL.x = this.player.x -35
                    setTimeout(() => {
                        this.marteauL.y = 100
                        this.marteauL.x = 100
                        arret = false
                    }, 400);
                }
                else if (keyE.isDown && petit == true && this.cursors.left.isDown) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauL.y = this.player.y + 5
                    this.marteauL.x = this.player.x - 20
                    setTimeout(() => {
                        this.marteauL.y = 100
                        this.marteauL.x = 100
                        arret = false
                    }, 400);
                }

                if (keyE.isDown && petit == false && this.cursors.down.isDown) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauD.y = this.player.y + 40
                    this.marteauD.x = this.player.x 
                    setTimeout(() => {
                        this.marteauD.y = 100
                        this.marteauD.x = 100
                        arret = false
                    }, 400);
                }
                else if (keyE.isDown && petit == true && this.cursors.down.isDown) {
                    this.cursors.right.reset();
                    this.cursors.left.reset();
                    this.cursors.up.reset();
                    this.cursors.down.reset();
                    arret = true
                    this.marteauD.y = this.player.y + 20
                    this.marteauD.x = this.player.x 
                    setTimeout(() => {
                        this.marteauD.y = 100
                        this.marteauD.x = 100
                        arret = false
                    }, 400);
                }

                if (keyE.isDown && petit == false && this.cursors.up.isDown) {
                        this.cursors.right.reset();
                        this.cursors.left.reset();
                        this.cursors.up.reset();
                        this.cursors.down.reset();
                        arret = true
                        this.marteauU.y = this.player.y - 25
                        this.marteauU.x = this.player.x 
                        setTimeout(() => {
                            this.marteauU.y = 100
                            this.marteauU.x = 100
                            arret = false
                        }, 400);
                        }
                        else if (keyE.isDown && petit == true && this.cursors.up.isDown) {
                        this.cursors.right.reset();
                        this.cursors.left.reset();
                        this.cursors.up.reset();
                        this.cursors.down.reset();
                        arret = true
                        this.marteauU.y = this.player.y - 15
                        this.marteauU.x = this.player.x 
                        setTimeout(() => {
                            this.marteauU.y = 100
                            this.marteauU.x = 100
                            arret = false
                        }, 400);
                }

                //fonction minimize
                if (keyA.isDown && petit == false && obtentionmini == true) {
                    this.player.setScale(0.5)
                    this.zoneattack.setScale(0.5)
                    this.zoneattackL.setScale(0.5)
                    this.zoneattackU.setScale(0.5)
                    this.zoneattackD.setScale(0.5)
                    this.marteauR.setScale(0.5)
                    this.marteauL.setScale(0.5)
                    this.marteauD.setScale(0.5)
                    this.marteauU.setScale(0.5)
                    setTimeout(() => {
                        petit = true;

                    }, 200);
                }
                else if (keyA.isDown && petit == true && obtentionmini == true) {
                    this.player.setScale(1)
                    this.zoneattack.setScale(1)
                    this.zoneattackL.setScale(1)
                    this.zoneattackD.setScale(1)
                    this.zoneattackU.setScale(1)
                    this.marteauR.setScale(1)
                    this.marteauU.setScale(1)
                    this.marteauL.setScale(1)
                    this.marteauD.setScale(1)
                    setTimeout(() => {
                        petit = false;

                    }, 200);





                }
                if (this.cursors.left.isDown) { //si la touche gauche est appuyée
                    this.player.setVelocityX(-160); //alors vitesse négative en X
                    this.player.anims.play('left', true); //et animation => gauche
                }
                else if (this.cursors.right.isDown) { //sinon si la touche droite est appuyée
                    this.player.setVelocityX(160); //alors vitesse positive en X
                    this.player.anims.play('right', true); //et animation => droite
                }
                else { // sinon
                    this.player.setVelocityX(0); //vitesse nulle
                    //this.player.anims.play('turn', true); //animation fait face caméra
                    turn = true;
                }

                if (this.cursors.up.isDown) {
                    //si touche haut appuyée ET que le perso touche le sol
                    this.player.setVelocityY(-160); //alors vitesse verticale négative
                    this.player.anims.play('up', true);

                }
                else if (this.cursors.down.isDown) {
                    //si touche haut appuyée ET que le perso touche le sol
                    this.player.setVelocityY(160); //alors vitesse verticale négative
                    this.player.anims.play('down', true);

                }
                else {
                    //si touche haut appuyée ET que le perso touche le sol
                    this.player.setVelocityY(0); //alors vitesse verticale négative
                    if (turn == true) {
                        this.player.anims.play('turn', true); //animation fait face caméra
                        //(on saute)
                    }
                }

                turn = false;

                if (this.gameOver) { return; }


            }



        }





























        var config = {
            type: Phaser.AUTO,
            width: 1098, height: 618,
            physics: {
                default: 'arcade',
                arcade: {
                    gravity: { y: 0 },
                    debug: false
                }
            },

            scene: [niveau2,niveau1,niveautemple,niveaumontagne,niveauplage,sallerelique,ecrandefin,camp,gameover]
        };

        const Game = new Phaser.Game(config);




        gameOver = false;
        score = 0;




























    </script>
</body>

</html>